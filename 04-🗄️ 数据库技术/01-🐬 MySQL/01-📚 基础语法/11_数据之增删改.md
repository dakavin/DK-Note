---
æ–‡ç« æ ‡é¢˜: "[[11_æ•°æ®ä¹‹å¢åˆ æ”¹]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  MySQLæ•°æ®å¢åˆ æ”¹æŸ¥æ“ä½œè¯¦è§£ï¼Œæ¶µç›–INSERTã€UPDATEã€DELETEè¯­å¥ç”¨æ³•ï¼ŒMySQL8è®¡ç®—åˆ—ç‰¹æ€§ï¼Œä»¥åŠå›¾ä¹¦ç®¡ç†ç³»ç»Ÿç»¼åˆæ¡ˆä¾‹ç»ƒä¹ 
tags:
- "MySQL"
- "æ•°æ®æ“ä½œ"
- "INSERT"
- "UPDATE"
- "DELETE"
- "è®¡ç®—åˆ—"
- "æ•°æ®åº“"
- "SQL"
ç›¸å…³æ–‡ç« :
- "[[1_ç†è§£NULL]]"
- "[[1_æ•°æ®åº“æ¦‚è¿°]]"
- "[[0_æ‰‹æ’•SQL]]"
- "[[14_è§†å›¾(View)]]"
- "[[15_å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°]]"
æ–‡ç« åˆ†ç±»: "ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯"
æ–‡ç« è·¯å¾„: "04-ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯/01-ğŸ¬ MySQL/01-ğŸ“š åŸºç¡€è¯­æ³•/11_æ•°æ®ä¹‹å¢åˆ æ”¹.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2025-05-27 23:09:58
---

## 1 æ’å…¥æ•°æ®

- ä½¿ç”¨INSERTè¯­å¥å‘è¡¨ä¸­æ’å…¥æ•°æ®

### 1.1 æ–¹å¼1ï¼šVALUESçš„æ–¹å¼æ·»åŠ 

- æƒ…å†µ1ï¼šä¸ºè¡¨ä¸­æ‰€æœ‰å­—æ®µæŒ‰`é»˜è®¤é¡ºåº`æ’å…¥æ•°æ®
- å€¼åˆ—è¡¨ä¸­éœ€è¦ä¸ºè¡¨çš„æ¯ä¸€ä¸ªå­—æ®µæŒ‡å®šå€¼ï¼Œå¹¶ä¸”å€¼çš„é¡ºåºå¿…é¡»å’Œæ•°æ®è¡¨ä¸­å­—æ®µå®šä¹‰æ—¶çš„é¡ºåºä¸€è‡´
`
```mysql
insert into è¡¨å
values (value1 , value2 , ......) 

INSERT INTO emp2
VALUES (01,'Tom',2000.00)
```

- æƒ…å†µ2ï¼šä¸ºè¡¨ä¸­æŒ‡å®šå­—æ®µæ’å…¥æ•°æ®
- åœ¨ INSERT å­å¥ä¸­éšæ„åˆ—å‡ºåˆ—åï¼Œä½†æ˜¯ä¸€æ—¦åˆ—å‡ºï¼ŒVALUESä¸­è¦æ’å…¥çš„value1,....valuenéœ€è¦ä¸column1,...columnnåˆ—ä¸€ä¸€å¯¹åº”ã€‚å¦‚æœç±»å‹ä¸åŒï¼Œå°†æ— æ³•æ’å…¥ï¼Œå¹¶ä¸”MySQLä¼šäº§ç”Ÿé”™è¯¯ã€‚
```mysql
insert into è¡¨åï¼ˆå­—æ®µ1ï¼Œå­—æ®µ2ï¼Œå­—æ®µ3ï¼Œ......ï¼‰
values ï¼ˆvalue1 , value2 , value3 ......ï¼‰

insert into emp2(salary, emp_id)
values (3000.12 , 02)
```

- æƒ…å†µ3ï¼šåŒæ—¶æ’å…¥å¤šæ¡è®°å½•ï¼ˆæ¨èï¼Œæ•ˆç‡æ›´é«˜ï¼‰
```mysql
Insert INto è¡¨åï¼ˆå­—æ®µå1ï¼Œå­—æ®µå2ï¼Œå­—æ®µå3ï¼Œ......ï¼‰
values 
(value01 , value02 , value03 , ......)
(value11 , value12 , value13 , ......)
......

insert into emp2 #æ­¤å¤„å¯ä»¥ä¸æŒ‡å®š
values	# æŒ‰é»˜è®¤é¡ºåºå¡«å†™å³å¯
(3, 'Mike' , 3000.00) ,
(4, 'King' , 6000.00) ,
(5, 'Jack' , 4000.00)
```

- ä½¿ç”¨INSERTåŒæ—¶æ’å…¥å¤šæ¡è®°å½•æ—¶ï¼ŒMySQLä¼šè¿”å›ä¸€äº›åœ¨æ‰§è¡Œå•è¡Œæ’å…¥æ—¶æ²¡æœ‰çš„é¢å¤–ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯çš„å«ä¹‰å¦‚ä¸‹ï¼š 
	-ã€€Recordsï¼šè¡¨æ˜æ’å…¥çš„è®°å½•æ¡æ•°ã€‚ 
	-ã€€Duplicatesï¼šè¡¨æ˜æ’å…¥æ—¶è¢«å¿½ç•¥çš„è®°å½•ï¼ŒåŸå› å¯èƒ½æ˜¯è¿™äº›è®°å½•åŒ…å«äº†é‡å¤çš„ä¸»é”®å€¼ã€‚ 
	-ã€€Warningsï¼šè¡¨æ˜æœ‰é—®é¢˜çš„æ•°æ®å€¼ï¼Œä¾‹å¦‚å‘ç”Ÿæ•°æ®ç±»å‹è½¬æ¢ã€‚

### 1.2 æ–¹å¼2ï¼šå°†æŸ¥è¯¢ç»“æœæ’å…¥åˆ°è¡¨ä¸­

```mysql
insert into è¡¨å1 ï¼ˆå­—æ®µ1 ï¼Œ å­—æ®µ2 ï¼Œ å­—æ®µ3 ï¼Œ......ï¼‰
SELECT å­—æ®µ11 ï¼Œå­—æ®µ22 ï¼Œ å­—æ®µ33
FROM è¡¨å2
WHERE ....

insert into emp2 (emp_name , salary , emp_id)
select last_name , salary , employee_id
FROM atguigudb.`employees`
WHERE department_id = 60
```

- æ­¤æ—¶ä¸å¿…ä¹¦å†™VALUESå­—å¥ï¼Œå­æŸ¥è¯¢ä¸­çš„å€¼åˆ—è¡¨ä¸INSERTå­—å¥ä¸­çš„åˆ—åå¯¹åº”
- å€¼çš„æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸€å¯¹åº”çš„åˆ—ï¼Œå®ƒä»¬çš„æœ‰æ•ˆèŒƒå›´è¦åˆç†ï¼Œå³å­æŸ¥è¯¢ä¸­çš„å­—æ®µèŒƒå›´å°äºINSERTçš„å­—æ®µèŒƒå›´

## 2 æ›´æ–°æ•°æ®

- ä½¿ç”¨UPDATEè¯­å¥æ›´æ–°æ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š
```mysql
UPDATE è¡¨å SET å­—æ®µå = æŸä¸ªå€¼ WHERE 

UPDATE emp2 
set emp_id = 6 
WHere emp_name = 'Hunold'
```

- å¦‚æœçœç•¥äº†WHEREå­—å¥ï¼Œåˆ™è¡¨ä¸­æ‰€æœ‰æ•°æ®éƒ½å°†è¢«æ›´æ–°
- SETçš„æ—¶å€™ï¼ŒæŸä¸ªå­—æ®µç”±äºå—åˆ°çº¦æŸï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿæ›´æ–°ä¸­çš„æ•°æ®å®Œæ•´æ€§é”™è¯¯

## 3 åˆ é™¤æ•°æ®

- ä½¿ç”¨DELETEè¯­å¥åˆ é™¤æ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š
```mysql
DELETE FROM è¡¨å WHERE ...

DElete from emp2 
where emp_id = 107
```

- å¦‚æœçœç•¥WHEREå­—å¥ï¼Œåˆ™è¡¨ä¸­æ‰€æœ‰æ•°æ®éƒ½å°†è¢«åˆ é™¤
- WHEREçš„æ—¶å€™ï¼ŒæŸä¸ªå­—æ®µç”±äºå—åˆ°çº¦æŸï¼Œæ‰€ä»¥å‘ç”Ÿåˆ é™¤ä¸­çš„æ•°æ®å®Œæ•´æ€§é”™è¯¯


## 4 MySQL8æ–°ç‰¹æ€§ï¼šè®¡ç®—åˆ—

- ç±»ä¼¼äºExcelè¡¨æ ¼ä¸­ï¼Œä¸€åˆ—æ•°æ®å—å…¶ä»–åˆ—çš„å½±å“
- è®¡ç®—åˆ—æŒ‡çš„æ˜¯æŸä¸€åˆ—çš„å€¼æ˜¯é€šè¿‡åˆ«çš„åˆ—è®¡ç®—å¾—åˆ°çš„
- ä¸€èˆ¬åœ¨CREATE TABLE æˆ–è€… ALTER TABLE ä¸­æ˜ç¡®è®¡ç®—åˆ—çš„

- ä¸¾ä¾‹ï¼šå®šä¹‰æ•°æ®è¡¨tb1ï¼Œç„¶åå®šä¹‰å­—æ®µidã€å­—æ®µaã€å­—æ®µbå’Œå­—æ®µcï¼Œå…¶ä¸­å­—æ®µcä¸ºè®¡ç®—åˆ—ï¼Œç”¨äºè®¡ç®—a+bçš„
å€¼ã€‚ é¦–å…ˆåˆ›å»ºæµ‹è¯•è¡¨tb1ï¼Œè¯­å¥å¦‚ä¸‹
```mysql
create table if not exists tb1 (
id int,
a int ,
b int ,
c int GENERATED ALWAYS AS (a + b) VIRTUAL
)
```

## 5 ç»¼åˆæ¡ˆä¾‹

- 1ã€åˆ›å»ºæ•°æ®åº“test01_library
```mysql
create database if not exists test01_library character set 'utf8'
```

- 2ã€åˆ›å»ºè¡¨ booksï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼šæ’å…¥å›¾ç‰‡
```mysql
create table if not exists books(
id int,
`name` varchar(50),
`authors` varchar(100),
price float,
pubdate year,
note varchar(100),
num int
)
```


- 3ã€å‘booksè¡¨ä¸­æ’å…¥è®°å½•
- 1ï¼‰ä¸æŒ‡å®šå­—æ®µåç§°ï¼Œæ’å…¥ç¬¬ä¸€æ¡è®°å½•
```mysql
insert into books
values (1 , 'Tal of AAA' , 'Dickes' , 23 , '1995' , 'novel' , 11)
```

- 2ï¼‰æŒ‡å®šæ‰€æœ‰å­—æ®µåç§°ï¼Œæ’å…¥ç¬¬äºŒè®°å½•
```mysql
insert into books(id, `name` , `authors` , price , pubdate , note , num)
Values(2 , 'EmmaT' , 'Jane lura' , 35 , '1993' , 'joke' , 22)
```

- 3ï¼‰åŒæ—¶æ’å…¥å¤šæ¡è®°å½•ï¼ˆå‰©ä¸‹çš„æ‰€æœ‰è®°å½•ï¼‰
```mysql
insert into books
values 
(3 , 'Story of Jane' , 'Jane Tim' , 40 , '2001' , 'novel' , 0),
(4 , 'Lovey Day' , 'George Byron' , 20 , '2005' , 'novel' ,30),
(5 , 'Old Land' , 'Honore Blade' , 30 , '2010' , 'law' , 0),
(6 , 'The Battle' , 'Upton Sara' , 30 , '1999' , 'medicine' , 40),
(7 , 'Rose Hood' , 'Richard haggard' , 28 , '2008' , 'cartoon' , 28 )
```

- 4ã€å°†å°è¯´ç±»å‹(novel)çš„ä¹¦çš„ä»·æ ¼éƒ½å¢åŠ 5ã€‚
```mysql
update books 
set price = price + 5 
Where note = 'novel'
```

- 5ã€å°†åç§°ä¸ºEmmaTçš„ä¹¦çš„ä»·æ ¼æ”¹ä¸º40ï¼Œå¹¶å°†è¯´æ˜æ”¹ä¸ºdramaã€‚
```mysql
update books 
set price = 40 , note = 'drama'
Where `name` = 'EmmaT'
```

- 6ã€åˆ é™¤åº“å­˜ä¸º0çš„è®°å½•ã€‚
```mysql
DElete from books 
WHERE num = 0
```

- 7ã€ç»Ÿè®¡ä¹¦åä¸­åŒ…å«aå­—æ¯çš„ä¹¦
```mysql
SELECT `name` , num
FRom books
WHERE `name` LIke '%a%'
```

- 8ã€ç»Ÿè®¡ä¹¦åä¸­åŒ…å«aå­—æ¯çš„ä¹¦çš„æ•°é‡å’Œåº“å­˜æ€»é‡
```mysql
SELECT count(1) , sum(num)
FRom books
WHERE `name` LIke '%a%'
```

- 9ã€æ‰¾å‡ºâ€œnovelâ€ç±»å‹çš„ä¹¦ï¼ŒæŒ‰ç…§ä»·æ ¼é™åºæ’åˆ—
```mysql
SELECT *
FROM books
WHERE note = 'novel'
ORDER by price DESC
```

- 10ã€æŸ¥è¯¢å›¾ä¹¦ä¿¡æ¯ï¼ŒæŒ‰ç…§åº“å­˜é‡é™åºæ’åˆ—ï¼Œå¦‚æœåº“å­˜é‡ç›¸åŒçš„æŒ‰ç…§noteå‡åºæ’åˆ—
```mysql
SELECT *
FROM books
ORDER BY num DESC , note
```

- 11ã€æŒ‰ç…§noteåˆ†ç±»ç»Ÿè®¡ä¹¦çš„æ•°é‡
```mysql
SELECT note , count(1)
FROM books
GROUP BY note
```

- 12ã€æŒ‰ç…§noteåˆ†ç±»ç»Ÿè®¡ä¹¦çš„åº“å­˜é‡ï¼Œæ˜¾ç¤ºåº“å­˜é‡è¶…è¿‡30æœ¬çš„
```mysql
SELECT note
FROM books
GROUP BY note
HAVING sum(num) > 30
```

- 13ã€æŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦ï¼Œæ¯é¡µæ˜¾ç¤º5æœ¬ï¼Œæ˜¾ç¤ºç¬¬äºŒé¡µ
```mysql
select *
FROm books
limit 5,5
```

- 14ã€æŒ‰ç…§noteåˆ†ç±»ç»Ÿè®¡ä¹¦çš„åº“å­˜é‡ï¼Œæ˜¾ç¤ºåº“å­˜é‡æœ€å¤šçš„
```mysql
SELECT note
FROm books
GROUP BY note
HAVING sum(num) >= ALL (
					SELECT SUM(num)
					FROM books
					GROUP bY note
					)
					
select note ,sum(num) sum_num
FROM books
GROUP by note
ORDER BY sum_num DESC
limit 1
```

- 15ã€æŸ¥è¯¢ä¹¦åè¾¾åˆ°10ä¸ªå­—ç¬¦çš„ä¹¦ï¼Œä¸åŒ…æ‹¬é‡Œé¢çš„ç©ºæ ¼
```mysql
SELECT replace(name,' ','') rp_name
FROM books
ORDER BY length(rp_name) DESC 
LIMIT 1
```

- 16ã€æŸ¥è¯¢ä¹¦åå’Œç±»å‹ï¼Œå…¶ä¸­noteå€¼ä¸ºnovelæ˜¾ç¤ºå°è¯´ï¼Œlawæ˜¾ç¤ºæ³•å¾‹ï¼Œmedicineæ˜¾ç¤ºåŒ»è¯ï¼Œcartoonæ˜¾ç¤ºå¡é€šï¼Œjokeæ˜¾ç¤ºç¬‘è¯
```mysql
SELECT `name` , note , CASE note WHEN 'novel' Then 'å°è¯´'
					    WHEN 'law'  Then 'æ³•å¾‹'
					    when 'medicine' then 'åŒ»è¯'
					    when 'cartoon' then 'å¡é€š'
					    when 'joke' then 'ç¬‘è¯' END AS "ç±»åˆ«"
FROM books
```

- 17ã€æŸ¥è¯¢ä¹¦åã€åº“å­˜ï¼Œå…¶ä¸­numå€¼è¶…è¿‡30æœ¬çš„ï¼Œæ˜¾ç¤ºæ»é”€ï¼Œå¤§äº0å¹¶ä½äº10çš„ï¼Œæ˜¾ç¤ºç•…é”€ï¼Œä¸º0çš„æ˜¾ç¤ºéœ€è¦æ— è´§
```mysql
select `name` , num , case when num> 30 then 'æ»é”€'
					      when num >0 and num <10 then 'ç•…é”€'
					      when num = 0 then 'æ— è´§' 
					      END AS 'é”€å”®æƒ…å†µ'
FROM books
```

- 18ã€ç»Ÿè®¡æ¯ä¸€ç§noteçš„åº“å­˜é‡ï¼Œå¹¶åˆè®¡æ€»é‡
```mysql
SELECT sum(sum_num)
FROm (
		SELECT note , sum(num) sum_num
		FROM books 
		group by note
		) t
		
SELECT ifNULL(note, 'åˆè®¡åº“å­˜æ€»é‡')  as  note, sum(num) sum_num
FROM books 
group by note with rollup
```

- 19ã€ç»Ÿè®¡æ¯ä¸€ç§noteçš„æ•°é‡ï¼Œå¹¶åˆè®¡æ€»é‡
```mysql
SELECT sum(a)
FROM (
	SELECT COUNT(*)  a
	FROM books
	GROUP BY note
	) t
	
SELECT ifnull(note , 'åˆè®¡æ€»é‡') , COUNT(*)  
FROM books
GROUP BY note with rollup 
```

- 20ã€ç»Ÿè®¡åº“å­˜é‡å‰ä¸‰åçš„å›¾ä¹¦
```mysql
SELECT *
FROM books
order by num desc
limit 0,3
```

- 21ã€æ‰¾å‡ºæœ€æ—©å‡ºç‰ˆçš„ä¸€æœ¬ä¹¦
```mysql
SELECT *
FROM books
ORDER BY `pubdate` 
limit 1
```

- 22ã€æ‰¾å‡ºnovelä¸­ä»·æ ¼æœ€é«˜çš„ä¸€æœ¬ä¹¦
```mysql
SELECT *
FROM books 
WHERE price >= ALL(
				SELECT price
				FROM books
				)
AND note = 'novel'
```

- 23ã€æ‰¾å‡ºä¹¦åä¸­å­—æ•°æœ€å¤šçš„ä¸€æœ¬ä¹¦ï¼Œä¸å«ç©ºæ ¼
```mysql
SELECT *
FROM books
order by LENGTH(REPLACE(NAME, ' ','')) DESC
limit 1


SELECT *
FROm books
WHERE length(name) >=ALL (
					SELECT length(name)
					FROM books
					)
```


## 6 è¡¥å……

### 6.1 æ·»åŠ æ•°æ®çš„å¦å¤–ä¸€ç§æ–¹å¼

```mysql
INSERT INTO my_employees
SELECT 1,'patel','Ralph','Rpatel',895 UNION ALL
SELECT 2,'Dancs','Betty','Bdancs',860 UNION ALL
SELECT 3,'Biri','Ben','Bbiri',1100 UNION ALL
SELECT 4,'Newman','Chad','Cnewman',750 UNION ALL
SELECT 5,'Ropeburn','Audrey','Aropebur',1550;
```

### 6.2 åˆ é™¤å¤šè¡¨å…±æœ‰æ•°æ®çš„æ–¹å¼

```mysql
DELETE u,e
FROM users u
JOIN my_employees e ON u.`userid`=e.`Userid`
WHERE u.`userid`='Bbiri';
```