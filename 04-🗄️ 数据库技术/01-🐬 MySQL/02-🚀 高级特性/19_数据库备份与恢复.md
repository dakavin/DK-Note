---
æ–‡ç« æ ‡é¢˜: "[[19_æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤]]"
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  è¯¦ç»†ä»‹ç»MySQLæ•°æ®åº“å¤‡ä»½æ¢å¤æ–¹æ³•ï¼ŒåŒ…æ‹¬ç‰©ç†å¤‡ä»½ä¸é€»è¾‘å¤‡ä»½åŒºåˆ«ï¼Œmysqldumpå·¥å…·å„ç§å¤‡ä»½åœºæ™¯ï¼Œmysqlå‘½ä»¤æ¢å¤æ•°æ®ï¼Œä»¥åŠè¡¨çš„å¯¼å‡ºå¯¼å…¥æ“ä½œ
tags:
  - MySQL
  - æ•°æ®åº“å¤‡ä»½
  - mysqldump
  - æ•°æ®æ¢å¤
  - é€»è¾‘å¤‡ä»½
  - ç‰©ç†å¤‡ä»½
  - æ•°æ®å¯¼å‡º
  - æ•°æ®å¯¼å…¥
ç›¸å…³æ–‡ç« :
  - "[[1_ğŸ“•åšå®¢è®¾ç½®æ¨¡å—åŠŸèƒ½åˆ†æã€è¡¨è®¾è®¡]]"
  - "[[1_æŒä¹…åŒ–åŸºç¡€é¢è¯•é¢˜]]"
  - "[[1_Part1]]"
  - "[[2_ğŸ“•æ ‡ç­¾ç®¡ç†ï¼šæ¥å£å¼€å‘]]"
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/03-ğŸ‹ å®¹å™¨åŒ–/01-ğŸ“š DockeråŸºç¡€/9_å¸¸è§ç¯å¢ƒå®‰è£…/2_å®‰è£…MySQL]]"
æ–‡ç« åˆ†ç±»: ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯
æ–‡ç« è·¯å¾„: 04-ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯/01-ğŸ¬ MySQL/02-ğŸš€ é«˜çº§ç‰¹æ€§/19_æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤.md
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­â­ ç²¾é€šå¿…å¤‡
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2025-05-27 23:09:58
---
### ç¬¬19ç«  æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤

#### 1. ç‰©ç†å¤‡ä»½ä¸é€»è¾‘å¤‡ä»½

ç‰©ç†å¤‡ä»½ï¼šå¤‡ä»½æ•°æ®æ–‡ä»¶ï¼Œè½¬å‚¨æ•°æ®åº“ç‰©ç†æ–‡ä»¶åˆ°æŸä¸€ç›®å½•ã€‚ç‰©ç†å¤‡ä»½æ¢å¤é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œä½†å ç”¨ç©ºé—´æ¯”è¾ƒå¤§ï¼ŒMySQLä¸­å¯ä»¥ç”¨`xtrabackup`å·¥å…·æ¥è¿›è¡Œç‰©ç†å¤‡ä»½ã€‚

é€»è¾‘å¤‡ä»½ï¼šå¯¹æ•°æ®åº“å¯¹è±¡åˆ©ç”¨å·¥å…·è¿›è¡Œå¯¼å‡ºå·¥ä½œï¼Œæ±‡æ€»å…¥å¤‡ä»½æ–‡ä»¶å†…ã€‚é€»è¾‘å¤‡ä»½æ¢å¤é€Ÿåº¦æ…¢ï¼Œä½†å ç”¨ç©ºé—´å°ï¼Œæ›´çµæ´»ã€‚MySQL ä¸­å¸¸ç”¨çš„é€»è¾‘å¤‡ä»½å·¥å…·ä¸º`mysqldump`ã€‚é€»è¾‘å¤‡ä»½å°±æ˜¯`å¤‡ä»½sqlè¯­å¥`ï¼Œåœ¨æ¢å¤çš„æ—¶å€™æ‰§è¡Œå¤‡ä»½çš„sqlè¯­å¥å®ç°æ•°æ®åº“æ•°æ®çš„é‡ç°ã€‚

#### 2. mysqldumpå®ç°é€»è¾‘å¤‡ä»½

##### 2.1 å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“

```shell
mysqldump â€“u ç”¨æˆ·åç§° â€“h ä¸»æœºåç§° â€“på¯†ç  å¾…å¤‡ä»½çš„æ•°æ®åº“åç§°[tbname, [tbname...]]> å¤‡ä»½æ–‡ä»¶å ç§°.sql
```

```shell
mysqldump -uroot -p atguigu>atguigu.sql #å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨å½“å‰ç›®å½•ä¸‹
mysqldump -uroot -p atguigudb1 > /var/lib/mysql/atguigu.sql
```

##### 2.2 å¤‡ä»½å…¨éƒ¨æ•°æ®åº“

```shell
mysqldump -uroot -pxxxxxx --all-databases > all_database.sql 
mysqldump -uroot -pxxxxxx -A > all_database.sql
```

##### 2.3 å¤‡ä»½éƒ¨åˆ†æ•°æ®åº“

```shell
mysqldump â€“u user â€“h host â€“p --databases [æ•°æ®åº“çš„åç§°1 [æ•°æ®åº“çš„åç§°2...]] > å¤‡ä»½æ–‡ä»¶å ç§°.sql
```

```shell
mysqldump -uroot -p --databases atguigu atguigu12 >two_database.sql
mysqldump -uroot -p -B atguigu atguigu12 > two_database.sql
```

##### 2.4 å¤‡ä»½éƒ¨åˆ†è¡¨

```shell
mysqldump â€“u user â€“h host â€“p æ•°æ®åº“çš„åç§° [è¡¨å1 [è¡¨å2...]] > å¤‡ä»½æ–‡ä»¶åç§°.sql
```

```shell
mysqldump -uroot -p atguigu book> book.sql
#å¤‡ä»½å¤šå¼ è¡¨ 
mysqldump -uroot -p atguigu book account > 2_tables_bak.sql
```

##### 2.5 å¤‡ä»½å•è¡¨çš„éƒ¨åˆ†æ•°æ®

```shell
mysqldump -uroot -p atguigu student --where="id < 10 " > student_part_id10_low_bak.sql
```

##### 2.6 æ’é™¤æŸäº›è¡¨çš„å¤‡ä»½

```shell
mysqldump -uroot -p atguigu --ignore-table=atguigu.student > no_stu_bak.sql
```

##### 2.7 åªå¤‡ä»½ç»“æ„æˆ–åªå¤‡ä»½æ•°æ®

- åªå¤‡ä»½ç»“æ„

```shell
mysqldump -uroot -p atguigu --no-data > atguigu_no_data_bak.sql
```

- åªå¤‡ä»½æ•°æ®

```shell
mysqldump -uroot -p atguigu --no-create-info > atguigu_no_create_info_bak.sql
```

##### 2.8 å¤‡ä»½ä¸­åŒ…å«å­˜å‚¨è¿‡ç¨‹ã€å‡½æ•°ã€äº‹ä»¶ 

```shell
mysqldump -uroot -p -R -E --databases atguigu > fun_atguigu_bak.sql
```

#### 3. mysqlå‘½ä»¤æ¢å¤æ•°æ®

```shell
mysql â€“u root â€“p [dbname] < backup.sql
```

##### 3.1 å•åº“å¤‡ä»½ä¸­æ¢å¤å•åº“

```shell
#å¤‡ä»½æ–‡ä»¶ä¸­åŒ…å«äº†åˆ›å»ºæ•°æ®åº“çš„è¯­å¥
mysql -uroot -p < atguigu.sql
#å¤‡ä»½æ–‡ä»¶ä¸­ä¸åŒ…å«äº†åˆ›å»ºæ•°æ®åº“çš„è¯­å¥
mysql -uroot -p atguigu4< atguigu.sql
```

##### 3.2 å…¨é‡å¤‡ä»½æ¢å¤

```shell
mysql â€“u root â€“p < all.sql
```

##### 3.3 ä»å…¨é‡å¤‡ä»½ä¸­æ¢å¤å•åº“

```shell
sed -n '/^-- Current Database: `atguigu`/,/^-- Current Database: `/p' all_database.sql > atguigu.sql 
#åˆ†ç¦»å®Œæˆåæˆ‘ä»¬å†å¯¼å…¥atguigu.sqlå³å¯æ¢å¤å•ä¸ªåº“
```

##### 3.4 ä»å•åº“å¤‡ä»½ä¸­æ¢å¤å•è¡¨

```shell
cat atguigu.sql | sed -e '/./{H;$!d;}' -e 'x;/CREATE TABLE `class`/!d;q' > class_structure.sql 
cat atguigu.sql | grep --ignore-case 'insert into `class`' > class_data.sql 
#ç”¨shellè¯­æ³•åˆ†ç¦»å‡ºåˆ›å»ºè¡¨çš„è¯­å¥åŠæ’å…¥æ•°æ®çš„è¯­å¥å å†ä¾æ¬¡å¯¼å‡ºå³å¯å®Œæˆæ¢å¤ 

use atguigu; 
mysql> source class_structure.sql; 
Query OK, 0 rows affected, 1 warning (0.00 sec) 

mysql> source class_data.sql; 
Query OK, 1 row affected (0.01 sec)
```

#### 4. è¡¨çš„å¯¼å‡ºä¸å¯¼å…¥

##### 4.1 è¡¨çš„å¯¼å‡º

1. ä½¿ç”¨SELECTâ€¦INTO OUTFILEå¯¼å‡ºæ–‡æœ¬æ–‡ä»¶ 

```mysql
SHOW GLOBAL VARIABLES LIKE '%secure%';
SELECT * FROM account INTO OUTFILE "/var/lib/mysql-files/account.txt";
```

2. ä½¿ç”¨mysqldumpå‘½ä»¤å¯¼å‡ºæ–‡æœ¬æ–‡ä»¶

```shell
mysqldump -uroot -p -T "/var/lib/mysql-files/" atguigu account
# æˆ–
mysqldump -uroot -p -T "/var/lib/mysql-files/" atguigu account --fields-terminated- by=',' --fields-optionally-enclosed-by='\"'
```

3. ä½¿ç”¨mysqlå‘½ä»¤å¯¼å‡ºæ–‡æœ¬æ–‡ä»¶

```shell
mysql -uroot -p --execute="SELECT * FROM account;" atguigu> "/var/lib/mysql-files/account.txt"
```

##### 4.2 è¡¨çš„å¯¼å…¥

1. ä½¿ç”¨LOAD DATA INFILEæ–¹å¼å¯¼å…¥æ–‡æœ¬æ–‡ä»¶

```mysql
LOAD DATA INFILE '/var/lib/mysql-files/account_0.txt' INTO TABLE atguigu.account;
# æˆ–
LOAD DATA INFILE '/var/lib/mysql-files/account_1.txt' INTO TABLE atguigu.account FIELDS TERMINATED BY ',' ENCLOSED BY '\"';
```

2. ä½¿ç”¨mysqlimportæ–¹å¼å¯¼å…¥æ–‡æœ¬æ–‡ä»¶

```shell
mysqlimport -uroot -p atguigu '/var/lib/mysql-files/account.txt' --fields-terminated- by=',' --fields-optionally-enclosed-by='\"'
```

