---
æ–‡ç« æ ‡é¢˜: "[[3_ç¯å¢ƒæ­å»º]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  è¯¦ç»†ä»‹ç»åœ¨Linuxç¯å¢ƒä¸‹å®‰è£…é…ç½®Redis 5.0.5çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…å«gccå®‰è£…ã€Redisç¼–è¯‘å®‰è£…ã€é…ç½®æ–‡ä»¶ä¿®æ”¹å’Œå¼€æœºè‡ªå¯åŠ¨è®¾ç½®ã€‚
tags:
- "Rediså®‰è£…"
- "Linuxç¯å¢ƒæ­å»º"
- "gccç¼–è¯‘"
- "Redisé…ç½®"
- "å¼€æœºè‡ªå¯åŠ¨"
- "æœåŠ¡å™¨éƒ¨ç½²"
- "æ•°æ®åº“å®‰è£…"
- "ç³»ç»Ÿè¿ç»´"
ç›¸å…³æ–‡ç« :
- "[[2_å®‰è£…MySQL]]"
- "[[3_Rediså¤šçº¿ç¨‹é¢è¯•ä¸åˆ†æ]]"
- "[[3_Redisé›†ç¾¤]]"
æ–‡ç« åˆ†ç±»: "ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯"
æ–‡ç« è·¯å¾„: "04-ğŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯/02-ğŸ”´ Redis/03-ğŸ“ è®­ç»ƒè¥ç¬”è®°/1_Rediså…¥é—¨/3_ç¯å¢ƒæ­å»º.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2025-05-27 23:09:58
---

å¯ä»¥æœ¬åœ°æ­å»ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨äº‘æœåŠ¡å™¨æ­å»º

æ¨èä½¿ç”¨5.0.5ç‰ˆæœ¬ï¼Œåœ¨6.0ä¹‹å‰æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é¿å…å¤šçº¿ç¨‹é¢å¤–çš„å¤æ‚åº¦ï¼ŒåŒæ—¶ï¼Œå¤§å‚å¾ˆå¤šéƒ¨é—¨éƒ½æ˜¯ä½¿ç”¨5.0ç‰ˆæœ¬

## 1 å®‰è£…gcc
### 1.1 gccå®‰è£…ä½ç½®
è¿›å…¥åˆ°/usr/localç›®å½•ä¸‹
`cd /usr/local`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/aad9d90da6e8181402ee9190677d9235.png)

### 1.2 yum install gcc-c++
redisæ˜¯cè¯­è¨€å¼€å‘ï¼Œå®‰è£…rediséœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ–gccç¯å¢ƒ
è¾“å…¥å‘½ä»¤ï¼š
`yum install gcc-c++`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/569132198c358b03d13d6ac48bb17103.png)

å›è½¦åå‡ºç°è¿™ä¸ªï¼ŒæŒ‰yç¡®è®¤![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/704aafc5f4c37e795fbd84e497ca517c.png)

å†æ¬¡æŒ‰y![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/8a324e8eaec70b97e48759ae8bd7b9dd.png)

å‡ºç°è¿™ä¸ªè¡¨ç¤ºå®‰è£…æˆåŠŸ

## 2 redisä¸‹è½½ä¸å®‰è£…
### 2.1 ä¸‹è½½redis
`wget http://download.redis.io/releases/redis-5.0.5.tar.gz`![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/4b6d33b4213f9330782e85c96acf22f0.png)

ä¸‹è½½æ—¶å¦‚æœé‡åˆ°å¡ä½è¿›åº¦ä¸‹ä¸åŠ¨äº†ã€‚![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/e384381f718a38df0056a12b7c2b5631.png)

`ä¾‹å¦‚ç¬”è€…å¡åœ¨äº†70%
é¦–å…ˆç”¨ ctrl+z ç»“æŸä¸‹è½½,æ³¨æ„ä¸è¦ç”¨ ctrl+c.`
å¦‚æœç”¨äº†ctrl+cå°±æ˜¯ç›´æ¥ç»“æŸï¼Œå› ä¸ºwgetæ˜¯å•çº¿ç¨‹çš„ã€‚
ç”¨ wget -c url é‡æ–°ä¸‹è½½
è®°ä½å…ˆctrl+zç»“æŸï¼Œç„¶åwget -c url ç»§ç»­ä¸‹è½½![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0764d1bcc14ac4576f94235db4a21500.png)

ä¸‹è½½å®Œæˆã€‚
è¾“å…¥llæŸ¥çœ‹æ˜¯å¦æœ‰rediså‹ç¼©åŒ…![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/1499b137afb9e3ca82006e7358eb0f57.png)


### 2.2 è§£å‹

`tar -zxvf redis-5.0.5.tar.gz`![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/16ef468ccf93a2742af6bf1a81e46b0d.png)

è§£å‹åå†æ¬¡è¾“å…¥llæŸ¥çœ‹æ˜¯å¦æœ‰è§£å‹å¥½çš„redis![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/3f5f3e8270d5b83284da8ac286227257.png)
### 2.3 ç¼–è¯‘å®‰è£…
#### 2.3.1 ç¼–è¯‘
è¿›å…¥redisç›®å½•å¹¶æ‰§è¡Œmakeå‘½ä»¤ç¼–è¯‘
`cd redis-5.0.5`
`make`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/b63af9ba88c3c688ed2b337898a655b6.png)

ç¼–è¯‘å®Œæˆå‡ºç°ä»¥ä¸‹å†…å®¹![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/fcfd48d32079c13365c36f94e6bc5031.png)

#### 2.3.2 å®‰è£…
æ‰§è¡Œå®‰è£…å‘½ä»¤
`make PREFIX=/usr/local/redis install`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/6e9d732d3e80f33f113aeeab0100a31d.png)

å®‰è£…å®Œæˆåè¿›å…¥`/usr/local/redis/bin`ç›®å½• è¿™ä¸ªredisç›®å½•(redisçš„å®‰è£…ç›®å½•)æ˜¯ä¸Šä¸€æ­¥å‘½ä»¤å®‰è£…è‡ªåŠ¨åˆ›å»ºçš„ï¼ˆä¸æ˜¯redis-5.0.5ç›®å½•(reidsè§£å‹åçš„æ–‡ä»¶ç›®å½•)ï¼‰
`cd ../redis/bin`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/1aaf0b290249c0d99da61b5e6b06fc1a.png)

å¯ä»¥çœ‹åˆ°æœ‰ä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶ã€‚
redis-server æ˜¯redisæœåŠ¡å™¨
redis-cli æ˜¯rediså®¢æˆ·llllç«¯
è¿”å›`/usr/local`ç›®å½•åè¿›å…¥`redis-5.0.5`

æ­¤ç›®å½•ä¸‹æœ‰ä¸ªredis.confæ–‡ä»¶![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/d95b14e7e386eb6b3a90b3175f3c415e.png)

å°†è¯¥æ–‡ä»¶ç§»åŠ¨åˆ°`/usr/local/redis/bin`ç›®å½•ä¸‹
`cp ./redis.conf /usr/local/redis/bin/`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/071dc5bbb80569996d0a1e797f478ac7.png)

è¿›å…¥`/usr/local/redis/bin`ç›®å½•
`cd /usr/local/redis/bin`
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/cba914bd1a4d8080efec8cb74a0a09d1.png)

å¯ä»¥çœ‹åˆ°redis.confå·²ç»ç§»åŠ¨åˆ°`/usr/local/redis/bin`ç›®å½•ä¸‹

#### 2.3.3 ä¿®æ”¹é…ç½®æ–‡ä»¶ redis.conf

(1)æ³¨é‡Šæ‰bind 127.0.0.1  
è‹±æ–‡æ³¨é‡Šè§£é‡Šçš„å¾ˆæ¸…æ¥šï¼ˆç¿»è¯‘è½¯ä»¶å˜å˜çš„ï¼‰ï¼Œå¦‚æœæ”¾å¼€bind 127.0.0.1å³åªæœ‰æœ¬æœºå¯ä»¥è®¿é—®ï¼Œå¦‚æœæ³¨é‡Šæ‰ï¼Œæ‰€æœ‰ç¯å¢ƒéƒ½å¯ä»¥è®¿é—®ã€‚è‡ªå·±ç©æ— æ‰€è°“ï¼Œç”Ÿäº§ç­‰æ¯”è¾ƒé‡è¦çš„ç¯å¢ƒè¿˜æ˜¯å»ºè®®ç»‘å®šè®¿é—®çš„ip![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/bff0738cfb579dbbbeab8340615fe62a.png)

(2)ä¿æŠ¤æ¨¡å¼ä¿®æ”¹ï¼šprotected-modeçš„å€¼é»˜è®¤ä¸ºyesï¼Œå°†å…¶ä¿®æ”¹ä¸ºnoï¼›  
(è¯¥æ¨¡å¼æ§åˆ¶å¤–éƒ¨ç½‘æ˜¯å¦å¯ä»¥è¿æ¥redisæœåŠ¡ï¼Œé»˜è®¤æ˜¯yes,æ‰€ä»¥é»˜è®¤æˆ‘ä»¬å¤–ç½‘æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå¦‚éœ€å¤–ç½‘è¿æ¥rendisæœåŠ¡åˆ™éœ€è¦å°†æ­¤å±æ€§æ”¹ä¸ºno)
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/4310cd2799d583b4ea02791f4a061816.png)

(3)å®ˆæŠ¤è¿›ç¨‹ä¿®æ”¹ï¼šdaemonizeçš„å€¼é»˜è®¤ä¸ºnoï¼Œå°†å…¶ä¿®æ”¹ä¸ºyes;  
ï¼ˆyesè¡¨ç¤ºå¯ç”¨å®ˆæŠ¤è¿›ç¨‹ï¼Œé»˜è®¤æ˜¯noå³ä¸ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼‰![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/8d7059b049bb422043c6110293b2f347.png)
(4)rediså¯†ç ä¿®æ”¹:requirepass  
ï¼ˆè®¾ç½® redis è¿æ¥å¯†ç ï¼Œå›¾ä¾‹å¯†ç ä¸ºredis@123ï¼‰![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/06239a5fe8941f1b67bdaa3c7ee1068b.png)
(5) ä¿å­˜æ–‡ä»¶
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/d36009be62d98a9261900f55664748fe.png)

#### 2.3.4 æ›´æ–°é…ç½®æ–‡ä»¶åé‡å¯

å…ˆå°†redisè¿›ç¨‹åœæ­¢ï¼Œåœ¨é‡å¯

```shell
ps -ef|grep redis
kill -9 è¿›ç¨‹å·
cd /usr/local/redis-5.0.5
./bin/redis-server ./redis.conf
```

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/54ddd584955b1f9046ed4b891a41aff1.png)

#### 2.3.5 å¼€æ”¾6379ç«¯å£

```shell
# æŸ¥çœ‹firewalldçŠ¶æ€ï¼Œå‘ç°å½“å‰æ˜¯deadçŠ¶æ€ï¼Œå³é˜²ç«å¢™æœªå¼€å¯
systemctl status firewalld

# åç»­æ“ä½œå¯¹äºå…³é—­é˜²ç«å¢™å¤±æ•ˆ
# æŸ¥çœ‹å·²ç»å¼€æ”¾çš„ç«¯å£
firewall-cmd --list-ports
# å¼€å¯ç«¯å£ä»¥åï¼Œé‡å¯é˜²ç«å¢™ç”Ÿæ•ˆ
firewall-cmd --zone=public --add-port=6379/tcp --permanent
# é‡å¯é˜²ç«å¢™
firewall-cmd --reload 
```

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/e60a069c57b9261d5941bd152f88c098.png)
## 3 rediså¯åŠ¨
### 3.1 å¯åŠ¨æœåŠ¡å™¨
`./redis-server redis.conf`

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a0bf04546f779c2b100f81bebb7731de.png)

å‡ºç°è¿™ä¸ªè¡¨ç¤ºæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

åœ¨xshellæ–°å»ºä¸€ä¸ªä¼šè¯ï¼Œè¾“å…¥ssh ipåœ°å€ï¼Œåœ¨å¼¹å‡ºçš„ç•Œé¢è¾“å…¥ç”¨æˆ·åå¯†ç 
è¿›å…¥åˆ°`/usr/local/redis/bin`
`cd /usr/local/redis/bin`

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/5ae220ad56c238771e38d45c0447f686.png)


### 3.2 å¯åŠ¨rediså®¢æˆ·ç«¯
`./redis-cli`

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/c722f965e6448b80da6ab8a74510238c.png)

è¿æ¥å®¢æˆ·ç«¯æˆåŠŸ

å·¥å…·è¿æ¥redisä¿¡æ¯ä¼šæŠ¥AUTH ERRORé”™è¯¯, æŠŠè¿æ¥ä¿¡æ¯æ·»åŠ å¯†ç è¿æ¥å³å¯![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/4ee2cc0b9012c24201282c025e5b7546.png)

è¿›è¡Œç®€å•æµ‹è¯•

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/de2b1aaf6fc490d6ebce74324b00392f.png)

ç›´è‡³ï¼Œrediså·²ç»å®‰è£…å®Œæˆäº†ã€‚

## 4 å…³é—­redisæœåŠ¡

1) é€šè¿‡killå‘½ä»¤ï¼šï¼ˆæš´åŠ›å…³é—­ï¼Œå®¹æ˜“ä¸¢å¤±æ•°æ®ï¼‰

```shell
#æŸ¥çœ‹redisçš„è¿›ç¨‹pid
ps -ef|grep redis 
kill -9 pid
```

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/4fb63f34c7fe35a382884ca2f1bbd26a.png)

é—­ï¼šï¼ˆæ­£å¸¸ç”¨è¿™ä¸ªæ–¹å¼å…³é—­ï¼‰

```shell
redis-cli shutdown # å¦‚æœredis è®¾ç½®å¯†ç å¯åŠ¨ï¼Œæƒ³å…³é—­redisæœåŠ¡å™¨ï¼š./redis-cli -a å¯†ç  shutdown ./bin/redis-cli -a redis@123 shutdown
```

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/82625022567cfc3468efe85fb595e358.png)


## 5 è®¾ç½®rediså¼€æœºè‡ªå¯åŠ¨

ä¿®æ”¹åˆå§‹åŒ–æ–‡ä»¶

```javascript
# è¿›å…¥ç›®å½•
cd /etc/init.d/
# ä¿®æ”¹æ–‡ä»¶
vi redis_init_script
```

é…ç½®æ–‡ä»¶

```javascript
#!/bin/sh
#
# Simple Redis init.d script conceived to work on Linux systems
# as it does use of the /proc filesystem.

### BEGIN INIT INFO
# Provides:     redis_6379
# Default-Start:        2 3 4 5
# Default-Stop:         0 1 6
# Short-Description:    Redis data structure server
# Description:          Redis data structure server. See https://redis.io
### END INIT INFO

# å¼€æœºè‡ªå¯åŠ¨
#chkconfig: 22345 10 90
#description: start and stop redis

# ç«¯å£å·
REDISPORT=6379
# serveræ‰§è¡Œæ–‡ä»¶
EXEC=/usr/local/develop/redis-5.0.5/bin/redis-server
# cliæ‰§è¡Œæ–‡ä»¶
CLIEXEC=/usr/local/develop/redis-5.0.5/bin/redis-cli
# PIDä½ç½®
PIDFILE=/var/run/redis_${REDISPORT}.pid
# é…ç½®æ–‡ä»¶
CONF="/usr/local/develop/redis-5.0.5/bin/redis.conf"

case "$1" in
    start)
        if [ -f $PIDFILE ]
        then
                echo "$PIDFILE exists, process is already running or crashed"
        else
                echo "Starting Redis server..."
                $EXEC $CONF
        fi
        ;;
    stop)
        if [ ! -f $PIDFILE ]
        then
                echo "$PIDFILE does not exist, process is not running"
        else
                PID=$(cat $PIDFILE)
                echo "Stopping ..."
                $CLIEXEC -a 123456 -p $REDISPORT shutdown
                while [ -x /proc/${PID} ]
                do
                    echo "Waiting for Redis to shutdown ..."
                    sleep 1
                done
                echo "Redis stopped"
        fi
        ;;
    *)
        echo "Please use start or stop as first argument"
        ;;
esac
```

å¯åŠ¨
```javascript
# å¯åŠ¨
[root@localhost init.d]# ./redis_init_script start
Starting Redis server...
66453:C 06 Sep 2022 23:50:08.712 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
66453:C 06 Sep 2022 23:50:08.712 # Redis version=5.0.5, bits=64, commit=00000000, modified=0, pid=66453, just started
66453:C 06 Sep 2022 23:50:08.712 # Configuration loaded


# æŸ¥çœ‹æœåŠ¡ å·²ç»åœ¨6379ç«¯å£è¿è¡Œäº†
[root@localhost init.d]# ps -ef|grep redis
root      66454      1  0 23:50 ?        00:00:00 /usr/local/bin/redis-server 0.0.0.0:6379
root      66460  61679  0 23:50 pts/1    00:00:00 grep --color=auto redis
[root@localhost init.d]#
```

æ³¨æ„å¯åŠ¨çš„æ—¶å€™å‡ºç°Permission deniedï¼Œä½¿ç”¨chmodä¿®æ”¹æ–‡ä»¶æƒé™å³å¯![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/33c7b38507e0b17e0f09aa95c7b8a71d.png)
- `è®¾ç½®å¼€æœºè‡ªå¯åŠ¨`

```javascript
# è®¾ç½®å¼€æœºè‡ªå·±åŠ¨
chkconfig redis_init_script on
```

