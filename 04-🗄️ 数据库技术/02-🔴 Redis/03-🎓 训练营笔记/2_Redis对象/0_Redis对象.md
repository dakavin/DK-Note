---
æ–‡ç« æ ‡é¢˜: "[[0_Rediså¯¹è±¡]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  ä»‹ç»Rediså¯¹è±¡çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…æ‹¬redisObjectç»“æž„ä½“çš„ç»„æˆéƒ¨åˆ†ã€6ç§å¯¹è±¡ç±»åž‹ã€é€šç”¨å‘½ä»¤ï¼Œä»¥åŠå¯¹è±¡ä¸Žåº•å±‚æ•°æ®ç»“æž„çš„å…³ç³»ã€‚
tags:
- "Redis"
- "redisObject"
- "æ•°æ®ç»“æž„"
- "å†…å­˜ç®¡ç†"
- "å¯¹è±¡ç±»åž‹"
- "é€šç”¨å‘½ä»¤"
- "NoSQL"
- "é”®å€¼å­˜å‚¨"
ç›¸å…³æ–‡ç« :
- "[[1_String]]"
- "[[1_Rediså†…å­˜é¢è¯•ä¸Žåˆ†æž]]"
- "[[1_Stringé¢è¯•ä¸Žåˆ†æž]]"
- "[[12_å¯¹åº”å¼•ç”¨è®¡æ•°ï¼ˆä¸é‡è¦ï¼‰]]"
- "[[5_Hash]]"
æ–‡ç« åˆ†ç±»: "ðŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯"
æ–‡ç« è·¯å¾„: "04-ðŸ—„ï¸ æ•°æ®åº“æŠ€æœ¯/02-ðŸ”´ Redis/03-ðŸŽ“ è®­ç»ƒè¥ç¬”è®°/2_Rediså¯¹è±¡/0_Rediså¯¹è±¡.md"
æ–‡ç« éš¾åº¦: åˆçº§ ðŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2025-05-27 23:09:57
---

## 1 Redis Objectæ˜¯ä»€ä¹ˆï¼Ÿ

Redis æ˜¯key-valueå­˜å‚¨ï¼Œ`keyå’Œvalueåœ¨Redisä¸­éƒ½è¢«æŠ½è±¡ä¸ºå¯¹è±¡`

`keyåªèƒ½æ˜¯Stringå¯¹è±¡`ï¼Œè€Œ`Valueæ”¯æŒä¸°å¯Œçš„å¯¹è±¡ç§ç±»`ï¼ŒåŒ…æ‹¬Stringã€Listã€Setã€Hashã€Sorted Setã€Streamç­‰

## 2 Objectåœ¨å†…å­˜ä¸­æ˜¯ä»€ä¹ˆæ ·å­

redisObjectå®šä¹‰å¦‚ä¸‹ï¼š
```C
// from Redis 5.0.5
#define LRU_BITS 24

typedef struct redisObject{
	unsigned type:4;
	unsigned encoding:4;
	unsigned lru:LRU_BITS; /* LRU time or
							* LFU data */
	int refcount;
	void *ptr;
}robj;
```

`type`ï¼šæ˜¯å“ªç§Rediså¯¹è±¡

`encoding`ï¼šè¡¨ç¤ºç”¨å“ªç§åº•å±‚ç¼–ç ï¼Œç”¨`OBJECT ENCODING[key]`å¯ä»¥çœ‹åˆ°å¯¹åº”çš„ç¼–ç æ–¹å¼

`lru`ï¼šè®°å½•å¯¹è±¡è®¿é—®ä¿¡æ¯ï¼Œç”¨äºŽå†…å­˜æ·˜æ±°ï¼Œè¿™ä¸ªå¯ä»¥å…ˆå¿½ç•¥ï¼ŒåŽç»­ç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»

`refcount`ï¼šå¼•ç”¨è®¡æ•°ï¼Œç”¨æ¥æè¿°æœ‰å¤šå°‘ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥å¯¹è±¡

`ptr`ï¼šå†…å®¹æŒ‡é’ˆï¼ŒæŒ‡å‘å®žé™…å†…å®¹

## 3 å¯¹è±¡ä¸Žæ•°æ®ç»“æž„

å®žé™…æ“ä½œçš„ä¸»è¦æœ‰`6ä¸ªRediså¯¹è±¡`ï¼Œä»–ä»¬åº•å±‚ä¾èµ–ä¸€äº›æ•°æ®ç»“æž„ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€è·³è¡¨ã€å“ˆå¸Œè¡¨ã€åŽ‹ç¼©åˆ—è¡¨ã€åŒç«¯é“¾è¡¨ç­‰ï¼Œä¸åŒå¯¹è±¡å¯èƒ½æœ‰ä¾èµ–ç›¸åŒçš„æ•°æ®ç»“æž„ï¼Œæœ‰äº›æ•™ç¨‹ä¼šå…ˆè®²è¿™äº›åº•å±‚çš„ç»“æž„ï¼Œä½†æ˜¯æœ¬è¯¾ç¨‹ä¼šä»¥å¯¹è±¡ä¸ºé©±åŠ¨ï¼Œè®²åˆ°æŸä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå†ä»‹ç»å…³è”çš„æ•°æ®ç»“æž„ã€‚

è¿™ä¹Ÿæ˜¯æœ¬è¯¾ç¨‹çš„ä¸€ä¸ªå‡†åˆ™ï¼Œå®žè·µä¼˜äºŽåŽŸç†ï¼Œå¯¹ä½¿ç”¨è€…è€Œè¨€ï¼Œä¸ä¼šç›´æŽ¥ä½¿ç”¨åº•å±‚æ•°æ®ç»“æž„ï¼Œç›´æŽ¥æ‰“äº¤é“çš„æ˜¯å¯¹è±¡ï¼Œå…ˆç†Ÿæ‚‰å¯¹è±¡æ“ä½œï¼Œå†è‡ªç„¶æŽ¢ç©¶å¯¹è±¡åº•å±‚ç»“æž„ï¼Œè¿™ç§å…³è”æ€§å­¦ä¹ çš„å¡åº¦ä¹Ÿä¼šå¹³ç¼“äº›ã€‚


## 4 Redisé€šç”¨å‘½ä»¤

é€šç”¨æŒ‡ä»¤æ˜¯éƒ¨åˆ†æ•°æ®ç±»åž‹çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤ï¼Œå¸¸è§çš„æœ‰ï¼š

- `KEYS`ï¼šæŸ¥çœ‹ç¬¦åˆæ¨¡æ¿çš„æ‰€æœ‰key
	- å› ä¸ºredisä¸­æ¯ä¸ªæŸ¥è¯¢æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä¸å»ºè®®åœ¨ç”Ÿäº§çŽ¯å¢ƒè®¾å¤‡ä¸Šä½¿ç”¨keys
- `DEL`ï¼šåˆ é™¤ä¸€ä¸ªæŒ‡å®šçš„key
- `EXISTS`ï¼šåˆ¤æ–­keyæ˜¯å¦å­˜åœ¨
- `EXPIRE`ï¼šç»™ä¸€ä¸ªkeyè®¾ç½®æœ‰æ•ˆæœŸï¼Œæœ‰æ•ˆæœŸåˆ°æœŸæ—¶è¯¥keyä¼šè¢«è‡ªåŠ¨åˆ é™¤
- `TTL`ï¼šæŸ¥çœ‹ä¸€ä¸ªKEYçš„å‰©ä½™æœ‰æ•ˆæœŸ

é€šè¿‡help [command] å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªå‘½ä»¤çš„å…·ä½“ç”¨æ³•ï¼Œä¾‹å¦‚ï¼š

```sh
# æŸ¥çœ‹keyså‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼š
127.0.0.1:6379> help keys

KEYS pattern
summary: Find all keys matching the given pattern
since: 1.0.0
group: generic
```

