---
文章标题: "[[2_Redis单线程面试与分析]]" 
文章作者: Dakkk
文章概要: |
  文章分析了Redis单线程核心处理机制，解释了其为何选择单线程、性能表现及高速原因（内存操作、高效数据结构、I/O多路复用）。同时阐明了Redis在4.0和6.0版本引入多线程处理异步操作及网络I/O解包的演进，是常见的Redis面试考点。
文章标签:
- "Redis"
- "单线程"
- "多线程"
- "性能优化"
- "I/O多路复用"
- "面试"
- "内存数据库"
- "数据结构"
相关文章:
- "[[2_Redis是单线程，还是多线程（重点理解）]]"
- "[[5_多线程是怎么回事（需要了解）]]"
- "[[2_补充：Redis之IO多路复用模型实现原理]]"
- "[[2_Redis是什么]]"
- "[[3_单线程为什么能这么快（重点理解）]]"
文章分类: "🎉 面试"
文章路径: "11-🎉 面试/3_训练营/8_Redis面试题/2_Redis运作/2_Redis单线程面试与分析.md"
文章难度: 初级 💧
目前阶段: ✅ 已完成
重要性: ⭐⭐⭐⭐⭐ 精通必备
创建时间: 2024-08-11 18:15:12
修改时间: 2024-08-11 18:15:12
---

## 1 面试考点分析

Redis对使用者而言，最常见的还是用命令来操作各种数据对象以达到存储数据的目的，这些操作命令在Redis中具体是怎么运行的，是非常关键的。我们学习过程中需要聚焦整体的执行流程、同时部分也需要有所了解。

## 2 面试题

### 2.1 Redis是单线程还是多线程

分析：
- 重点点明核心处理逻辑是单线程的

回答：
- 核心处理逻辑，Redis一直是单线程的；
- 某些异步流程从4.0开始用多线程，如UNLINK、FLUSHALL ASYNC等非阻塞操作
- 网络I/O解包从6.0开始用的都是多线程

>**Redis 在 2.6 版本**，会启动 2 个后台线程，分别处理`关闭文件、AOF 刷盘`这两个任务；
>
>**Redis 在 4.0 版本之后**，新增了一个新的后台线程，用来`异步释放 Redis 内存，也就是 lazyfree 线程`。例如执行 unlink key / flushdb async / flushall async 等命令，会把这些删除操作交给后台线程来执行，好处是不会导致 Redis 主线程卡顿。因此，当我们要删除一个大 key 的时候，不要使用 del 命令删除，因为 del 是在主线程处理的，这样会导致 Redis 主线程卡顿，因此我们应该使用 unlink 命令来异步删除大 key。

后台线程相当于一个消费者，生产者把耗时任务丢到任务队列中，消费者（BIO）不停轮询这个队列，拿出任务就去执行对应的方法即可。![](assets/Pasted%20image%2020231024205153.png)

### 2.2 Redis为什么选择单线程做核心处理

分析：
- 多线程复杂、成本高

回答：
- `瓶颈在I/O不是CPU`，这种情况下，选择多线程成本和复杂性高，综合投入产出比，所以选择了单线程

### 2.3 Redis单线程性能如何

分析：
- 对性能要有个大概的认知，一般业界认知就是Redis的性能是能达到10多w的
- 具体而言每个厂商也有偏差，腾讯云2核8g是8-10w
![](assets/Pasted%20image%2020231021212258.png)

回答：
- 非常好，2核8G的机器读性能可以达到10w/s左右，写性能也能有7,8w/s

### 2.4 为什么单线程还能这么快？

分析：
- 内存、数据结构、多路复用，三个方面

回答：
- Redis是内存数据库，内存操作本身就很快
- Redis选了高效的数据结构，很多对象底层有多种实现以应对不同的场景，追求性能的极致。
- Redis采用了I/O多路复用机制，使其在网络I/O操作中能并发处理放大量的客户端请求，实现高吞吐量