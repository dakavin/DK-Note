## 1. 分组函数

### 1.1 功能及分类

- 功能：用作统计使用，又称为聚合函数或组函数

- 分类：sum 求和、avg 平均值、max 最大值 、min 最小值 、count 计算个数

### 1.2 简单的使用

```mysql
SELECT SUM(salary) FROM employees;

SELECT AVG(salary) FROM employees;

SELECT MIN(salary) FROM employees;

SELECT MAX(salary) FROM employees;

SELECT COUNT(salary) FROM employees;

SELECT SUM(salary) 和,AVG(salary) 平均,MAX(salary) 最高,MIN(salary) 最低,COUNT(salary) 个数
FROM employees;

SELECT SUM(salary) 和,ROUND(AVG(salary),2) 平均,MAX(salary) 最高,MIN(salary) 最低,COUNT(salary) 个数

FROM employees;
```

### 1.3 参数支持哪些类型

```mysql
SELECT SUM(last_name) ,AVG(last_name) FROM employees;#无法计算

SELECT SUM(hiredate) ,AVG(hiredate) FROM employees;#无法计算

SELECT MAX(last_name),MIN(last_name) FROM employees;

SELECT MAX(hiredate),MIN(hiredate) FROM employees;

SELECT COUNT(commission_pct) FROM employees;

SELECT COUNT(last_name) FROM employees;
```

### 1.4 是否忽略null

- `忽略null的！！！`

```mysql
SELECT SUM(commission_pct),AVG(commission_pct),SUM(commission_pct)/35,SUM(commission_pct)/107 
FROM employees;

SELECT MAX(commission_pct) ,MIN(commission_pct) FROM employees;

SELECT COUNT(commission_pct) FROM employees;

SELECT commission_pct FROM employees;
```

### 1.5 和distinct搭配实现去重的运算

```mysql
SELECT SUM(DISTINCT salary),SUM(salary) FROM employees;

SELECT COUNT(DISTINCT salary),COUNT(salary) FROM employees;
```

### 1.6 count函数的详细介绍

```mysql
SELECT COUNT(salary) FROM employees;

SELECT COUNT(*) FROM employees;

SELECT COUNT(1) FROM employees;
```

## 2. 分组查询--group by

### 2.1 基本语法

```mysql
select 查询字段

from 表

【where 筛选条件】

group by 分组的字段

【HAVING  条件】

【order by 排序的字段】;

#引入：查询每个部门的员工个数

SELECT COUNT(*) FROM employees GROUP BY job_id;
```


### 2.2 简单的分组

```mysql
#案例1：查询每个工种的员工平均工资

SELECT AVG(salary),job_id

FROM employees

GROUP BY job_id;

#案例2：查询每个位置的部门个数

SELECT COUNT(*),location_id

FROM departments

GROUP BY location_id;
```

### 2.3 可以实现分组前的筛选

```mysql
#案例1：查询每个领导手下有奖金的员工的平均工资

SELECT AVG(salary),manager_id

FROM employees

WHERE commission_pct IS NOT NULL

GROUP BY manager_id;
```

### 2.4 分组后筛选

```mysql
#案例：查询的员工个数>5的部门

#①查询每个部门的员工个数

SELECT COUNT(*),department_id

FROM employees

GROUP BY department_id;

#② 筛选刚才①结果

SELECT COUNT(*),department_id

FROM employees

GROUP BY department_id

HAVING COUNT(*)>5;
```

### 2.5 添加排序

```mysql
#案例：查询每个工种有奖金的员工的最高工资>6000的工种编号和最高工资,同时按最高工资升序

SELECT job_id,MAX(salary) m

FROM employees

WHERE commission_pct IS NOT NULL

GROUP BY job_id

HAVING m>6000

ORDER BY m ;
```

### 2.6 按多个字段分组

```mysql
#案例：查询每个工种每个部门的最低工资,并按最低工资降序

SELECT job_id,department_id，MIN(salary)

FROM employees

GROUP BY  job_id,department_id

ORDER BY MIN(salary) DESC;
```