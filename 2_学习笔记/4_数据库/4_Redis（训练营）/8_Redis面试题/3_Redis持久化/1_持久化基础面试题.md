
## 1 Redis为什么需要持久化

分析：
- 持久化基础考察

回答：
- 持久化顾名思义，就是`将内存数据存入磁盘，持久化的保存下来`。
- Redis虽然最多的场景是缓存，但有时候即便是缓存也不想重启之后缓存都不在了，这样请求一下都打到存储了
- 同时Redis本身也可以做存储，这时候就更需要持久化了

回答1：
- 数据保护、数据恢复、数据备份、数据迁移和扩展
- 再说说RDB和AOF

## 2 RDB和AOF本质区别是什么？（背背回答，尝试说出自己更深的理解，不要拖沓）

分析：
- 如果是将区别可以从文件类型、文件恢复速度、安全性来回答，当本质区别就是RDB是使用快照进行持久化，AOF是日志。
- 其他可以列举的区别点 都是能从 快照 与 日志 中的对比找出的
	- `文件类型`：RDB是二进制文件，AOF是文本文件
	- `安全性`：RDB容易丢失较多的数据，AOF根据策略决定，比如可以配置1s刷盘一次，就只丢1s内的数据
	- `文件恢复速度`：RDB是二进制文件，所以恢复速度比AOF快
	- `操作的开销`：RDB保存是全量保存，操作比较重，通常设置至少间隔几分钟保存一次数据。而AOF的刷盘是一次追加操作，操作比较轻，通常设置策略为每一秒进行一次刷盘

回答：
- 本质区别就是 RDB是`全量保存快照`进行持久化，而 AOF 是`追加日志文件`进行持久化

## 3 如果RDB和AOF只能选一种，你选哪个？（比较了解）

分析：
- 其实就是让我们在性能和可靠之间做一个选择
- 这里不提供一个所谓完全正确的答案，主要是让大家对两种持久化有更深刻的理解

回答1：
- 如果我们能`接受分钟级别的数据丢失`，可以考虑选择RDB
- 如果需要`尽量保证数据安全`，可以考虑`AOF、RDB一起开启`
- 如果只用AOF，那么优先`选择everysec策略`进行刷盘（在可靠和性能之间有一个平衡）

回答2：
- 如果需要持久化，又只能开一种，我会选择RDB，这也是Redis官方的推荐和默认选择
## 4 同时开启AOF和RDB，启动时加载哪个？

分析：
- 有AOF，只会用AOF

回答：
- AOF和RDB同时开启，只会用AOF，`即使此时AOF文件因为异常原因不存在，也不会用RDB`，原因就是既然开启了AOF就是想要AOF少丢数据的能力，所以即使没有AOF文件也不会用RDB，这样`异常也能发现及时处理`，不然后者丢了数据就是潜在风险。