
TCP/IP是当今计算机网络界使用最为广泛的协议。TCP/IP的知识对于那些向构筑网络、搭建网络以及管理网络、设计和制造网络设备甚至是做网络设备编程的人来说都是至关重要的。那么，TCP/IP究竟是什么？本节就TCP/IP协议做一个简单地介绍。

## 1、TCP/IP与OSI参考模型

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/994c9e36c6e742e45126e3affedc47a3.png)

我们已经了解了OSI参考模型中各个分层的作用。TCP/IP诞生以来的各种协议其实也能对应到OSI参考模型当中。如果了解了这些协议分层属于OSI的那一层，就能对该协议的目的有所了解。

然后对于每个协议的具体计数要求就可以参考相应的规范了。在此，暂时略过协议本身的细节，先介绍各个协议与OSI参考模型中各个分层之间的对应关系。

图中列出来TCP/IP与OSI分层之间的大致关系。不难看出，TCP/IP与OSI在分层模块上稍有区别。OSI参考模型注重`通信协议必要的功能是什么`，而TCP/IP则更强调`在计算机上实现协议应该开发哪种程序`

## 2、硬件（物理层）

`TCP/IP的最底层是负责数据传输的硬件。`

这种硬件就相当于以太网或电话线路等物理层的设备。关于它的内容一致无法统一定义。因为只要人们在物理层面上所使用的传输媒介不同（如使用网线或无线），网络的带宽、可靠性、安全性、延迟等都会有所不同，而这些方面有没有一个既定的指标。

总之，TCP/IP是在网络互连的设备之间能够通信的前提下才被提出的协议。

## 3、网络接口层（数据链路层）

网络接口层（有时人们也将网络接口层与硬件层合并起来称作网络通信层）

`利用以太网中的数据链路层进行通信，因此属于接口层`。也就是说，把它当做让NIC（Network Interface Card 通信适配器）起作用的`驱动程序`也无妨。

驱动程序是在操作系统和硬件之间起桥梁作用的软件。计算机的外围附加设备或扩展卡，不是直接插到电脑上或电脑的扩展槽上就能马上使用的，还需要有相应驱动程序的支持。例如换了一个新的NIC网卡，不仅需要硬件，还需要软件才能真正的投入使用。

因此，人们常常还需要再操作系统的基础上安装一些驱动软件以便使用这些附加硬件（现在也有很多是即插即拔的设备，那是因为计算机的操作系统早已经内置安装好了对应网卡的驱动程序，而并非不需要驱动）。

## 4、互联网层（网络层）

互联网层使用IP协议，它相当于OSI模型中的第3层网络层，IP协议基于IP地址转发分包数据。

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/ef7037120972b1ce52bb11bd97f2ba87.png)

TCP/IP分层中的互联网层和传输层的功能通常由操作系统提供。尤其是路由器，它必须得实现通过互联网层转发分组数据包的功能。

此外，`连接互联网的所有主机跟路由器必须都实现IP的功能`。其他连接互联网的网络设备（如网桥、中继器或集线器）就没必要一定实现IP或TCP的功能（有时为了监控和管理网桥、中继器、集线器等设备，也需要让他们具有IP、TCP功能）

### 4.1 IP

`IP是跨越网络传送数据包，使整个互联网都能收到数据的协议。`

IP协议使数据能够发送到地球的另外一端，这期间它使用IP地址作为主机的标识（连接IP网络的所有设备必须有自己唯一的识别号以便识别具体的设备。分组数据在IP地址的基础上被发送到对端）

IP还隐含着数据链路层的功能。通过IP，相互通信的主机之间不论经过怎样的底层数据链路都能够实现通信。

虽然IP也是分组交换的一种协议，但是`它不具有重发机制`。即使分组数据包未能到达对端主机也不会重发。因此，`属于非可靠性传输协议`。

### 4.2 ICMP

IP数据包在发送途中，一旦发送异常导致无法到达对端目标地址时，需要给发送端发送一个发送异常的通知。ICMP就是为这一功能而制定的。它有时也被用来诊断网络的健康状况。
### 4.3 ARP

从分组数据包的IP地址中解析出物理地址（MAC地址）的一种协议。

## 5、传输层

TCP/IP的传输层有两个具有代表的协议。该层的功能本身与OSI参考模型中的传输层类似。

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a24344ea361e831cab06c0ffe8f1f12f.png)

传输层最主要的功能就是能够让应用程序之间实现通信。计算机内部，通常同一时间运行着多个程序。为此，必须分清是哪些程序与那些程序在进行通信。识别这些应用程序的是端口号。

### 5.1 TCP

TCP是一种面向有连接的传输层协议。它可以保证两端通信主机之间的通信可达。TCP能够正确处理在传输过程中丢包、传输顺序乱掉等异常情况。此外，TCP还能够有效利用带宽，缓解网络拥堵。

然后，为了建立与断开连接，有时它需要至少7次的发包收包，导致网络流量的浪费。此外，为了提高网络的利用率，TCP协议中定义了各种各样复杂的规范，因此不利于视频会议（音频、视频的数据量既定）等场合使用

### 5.2 UDP

UDP有别与TCP，它是一种面向无连接的传输层协议。UDP不会关注对端是否真的收到了传送过去的数据，如果需要检查对端是否收到分组数据包，或者对端是否连接到网络，这需要再应用程序中实现。

UDP常用于分组数据较少或多播、广播通信以及视频通信等多媒体领域。
## 6、 应用层（会话层以上的分层）

TCP/IP的分层中，将OSI参考模型中的会话层、表示层和应用层的功能都`集中到了应用程序中实现`。这些功能有时有一个单一的程序实现，有时也可能由多个程序实现。因此，细看TCP/IP的应用程序功能会发现，它不仅实现OSI模型中应用层的内容，还要实现会话层与表示层的功能。

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/7733326cd1aafab0a9ed1fc4011b020f.png)

`TCP/IP应用的架构绝大多数属于客户端/服务端模型`。提供服务的程序叫服务端，接收服务的程序叫客户端。在这种通信模式中，提供服务的程序会预先被部署到主机上，等待接收任何时刻客户可能发送的请求。

客户端可以随时发送请求给服务端。有时服务端可能会有处理异常、超出负载等情况，这时客户端可以在等待片刻后重发一次请求，

### 6.1 WWW

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/f509fc841b4f2eb01c58a203be4fec32.png)

WWW（中文叫万维网，是一种互联网上数据读取的规范。有时也叫做Web、WWW或W3）可以说是互联网能如此普及的一个重要原动力。用户在一种叫Web浏览器（通常可以简化称作浏览器。微软公司的Internet Explore以及Mozilla Foundation的Firefox等都属于浏览器。他们已被人们广泛使用）的软件上借助鼠标和键盘就可以轻轻松松地在网上自由地冲浪。也就是说轻按一些鼠标架设在远端服务器上的各种信息就会呈现到浏览器上。浏览器中既可以显示文字、图片、动画等信息，还能播放声音已经运行程序。

浏览器与服务端之前通信所用的协议的HTTP（HyperText Transfer Protocol）。所传输数据的主要格式是HTML（HyperText Markup Language）。WWW中的HTTP属于OSI应用层的协议，而HTML属于表示层的协议。

### 6.2 电子邮件（E-Mail）

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/b0367049c787087613ca73c158af7d3a.png)

电子邮件其实就是指在网络上发送信件。有了电子邮件，不管距离多远的人，只要连着互联网就可以相互发送邮件。发送电子邮件时引导的协议叫做SMTP（Simple Mail Transfer Protocol）

最初，人们只能发送文本格式（只能由文字组成的信息）的电子邮件。然而现在，电子邮件的格式由MIME（在互联网上广泛使用、用来定义邮件数据格式的一种规范。在WWW与网络论坛中也可以使用）协议扩展以后，就可以发送声音、图像等各式各样的信息。甚至还可以修改邮件文字的大小、颜色。

这里提到的MIME属于OSI参考模型的第6层（表示层）

### 6.3 文件传输(FTP)

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0d1419718d63e6a1d49aea9ca54ded5a.png)

文件传输是指将保存在其他计算机硬盘上的文件转移到本地的硬盘上，或将本地硬盘的文件传送到其他机器硬盘上的意思。

该过程使用的协议叫FTP（File Transfer Protocol）。FTP很早就已经投入使用，传输过程中可以选择二进制方式还是文本方式（用文本方式在Windows、MacOS或Unix等系统之间进行文件传输，会自动修改换行符。这也属于表示层的功能）

在FTP中进行文件传输时会建立两个TCP连接，分别是`发出传输请求时索要用到的控制连接`与`实际传输数据时所要用到的数据连接`
> 这两种连接的控制管理属于会话层的功能

### 6.4 远程登录（TELNET与SSH）

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/61bd0563b4c535c012c94b90b544bed7.png)

远程登录是指登录到远程的计算机上，使那台计算机上的程序得以运行的一种功能。TCP/IP网络中远程登录常用TELNET（TELetypewriter NETwork的缩写。有时也称作默认协议）和SSH（Secure SHell）两种协议。其实还有很多其他可以实现远程登录的协议，如BSD UNIX系中rlogin的r命令协议以及X Windows System中的X协议。

### 6.5 网络管理（SNMP）

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/b17e85b1edc731d824fe032bb8c4264c.png)

在TCP/IP中进行网络管理，采用SNMP（Simple Network Management Protocol）协议。使用SNMP管理的主机、网桥、路由器等称作SNMP代理（Agent），而进行管理的那一段叫做管理器（Manager）。SNMP正是这个Manager与Agent所要用到的协议。

在SNMP的代理端，保存着网络接口的信息、通信数据量、异常数据量以及设备温度等信息。这个信息可以通过MIB（Management Information Base）（MIB也被成为是一种可透过网络的结构变量）访问。因此，在TCP/IP的问过管理中，SNMP属于应用协议，MIB属于表示层协议。

一个网络范围越大，结构越复杂，就越需要对其进行有效的管理。而SNMP可以让管理员及时检查网络拥堵情况，及早发现故障，也可以为以后扩大网络收集必要的信息。

