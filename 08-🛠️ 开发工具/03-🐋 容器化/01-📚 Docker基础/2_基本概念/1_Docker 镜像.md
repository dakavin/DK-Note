---
文章标题: "[[1_Docker 镜像]]"
文章作者: Dakkk
文章概要: |
  文章定义了Docker镜像为容器运行的root文件系统，并详细阐述其基于Union FS的分层存储机制。镜像由多层不可变文件系统组成，每层构建后固定。该设计便于镜像复用与定制，但也提醒构建时需注意清理冗余数据，以优化镜像大小。
tags:
  - Docker
  - 镜像
  - 分层存储
  - Union FS
  - 容器
  - 文件系统
  - 镜像构建
相关文章:
  - "[[2_Docker容器]]"
  - "[[../5_容器/6_导出&导入容器]]"
  - "[[15_使用Docker构建根文件系统（Skip）]]"
  - "[[../5_容器/1_启动容器]]"
  - "[[../7_Dockerfile/1_Dockerfile是什么]]"
文章分类: 🛠️ 开发工具和OS相关
文章路径: 08-🛠️ 开发工具和OS相关/03-🐋 容器化/01-📚 Docker基础/2_基本概念/1_Docker 镜像.md
文章难度: 入门 🌱
目前阶段: ✅ 已完成
重要性: ⭐⭐⭐⭐⭐ 精通必备
创建时间: 2024-08-11 18:15:12
修改时间: 2025-05-28 01:03:09
---

Docker 有三大基本概念，分别是镜像（Image）、容器（Container）和仓库（Repository）。**镜像是 Docker 容器运行的前提，仓库是存放镜像的场所。**
## 1 什么是 Docker 镜像 ?

在谈及 Docker 镜像之前，需知道操作系统分为 **内核** 和 **用户空间**。对于 `Linux` 而言，内核启动后，会挂载 `root` 文件系统为其提供用户空间支持。而 **Docker 镜像**（`Image`），就相当于是一个 `root` 文件系统。比如官方镜像 `ubuntu:18.04` 就包含了完整的一套 Ubuntu 18.04 最小系统的 `root` 文件系统。

**Docker 镜像是一个特殊的文件系统**，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。
## 2 分层存储

刚才说道，镜像包含操作系统完整的 `root` 文件系统，其体积往往是庞大的，因此 Docker 在设计之初，就充分利用 Union FS 的技术，将其设计为分层存储的架构。所以严格来说，镜像并非是像一个 `ISO` 那样的打包文件，镜像只是一个虚拟的概念，其实际体现并非由一个文件组成，而是由一组文件系统组成，或者说，由多层文件系统联合组成。
![Docker 镜像分层存储](https://img.quanxiaoha.com/quanxiaoha/166256480238642 "Docker 镜像分层存储")

==镜像构建时，会一层层构建，前一层是后一层的基础==。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。比如，删除前一层文件的操作，实际不是真的删除前一层的文件，而是仅在当前层标记为该文件已删除。在最终容器运行的时候，虽然不会看到这个文件，但是实际上该文件会一直跟随镜像。因此，在构建镜像的时候，需要额外小心，每一层尽量只包含该层需要添加的东西，任何额外的东西应该在该层构建结束前清理掉。

分层存储的特征还使得镜像的复用、定制变的更为容易。甚至可以用之前构建好的镜像作为基础层，然后进一步添加新的层，以定制自己所需的内容，构建新的镜像。
