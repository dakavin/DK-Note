---
æ–‡ç« æ ‡é¢˜: "[[6_28.å®ç°strStr()]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« è¯¦ç»†è§£æäº†å¦‚ä½•å®ç°`strStr()`å‡½æ•°ï¼Œåˆ†åˆ«ä»‹ç»äº†æš´åŠ›åŒ¹é…å’ŒKMPç®—æ³•ä¸¤ç§æ–¹æ³•ã€‚å†…å®¹æ¶µç›–é¢˜æ„ç†è§£ã€ä¸¤ç§ç®—æ³•çš„æ€è·¯å¯¹æ¯”ï¼Œå¹¶æä¾›äº†è¯¦ç»†çš„Javaä»£ç å®ç°ï¼Œç€é‡å¼ºè°ƒäº†æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä»¥åŠè¾¹ç•Œæ¡ä»¶å¤„ç†ã€‚
tags:
- "å­—ç¬¦ä¸²åŒ¹é…"
- "KMPç®—æ³•"
- "æš´åŠ›åŒ¹é…"
- "ç®—æ³•"
- "LeetCode"
- "Java"
- "å­—ç¬¦ä¸²æœç´¢"
ç›¸å…³æ–‡ç« :
- "[[1_232.ç”¨æ ˆå®ç°é˜Ÿåˆ—]]"
- "[[2_349.ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†]]"
- "[[3_20.æœ‰æ•ˆæ‹¬å·]]"
- "[[3_202.å¿«ä¹æ•°]]"
- "[[4_1047.åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ç›¸é‚»é‡å¤é¡¹]]"
æ–‡ç« åˆ†ç±»: "ğŸ“ è®¡ç®—æœºåŸºç¡€"
æ–‡ç« è·¯å¾„: "07-ğŸ“ è®¡ç®—æœºåŸºç¡€/02-ğŸ§® ç®—æ³•è®¾è®¡/04-ğŸ¯ å­—ç¬¦ä¸²/6_28.å®ç°strStr().md"
æ–‡ç« éš¾åº¦: ä¸­çº§ ğŸŒ³
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­â­ ç²¾é€šå¿…å¤‡
åˆ›å»ºæ—¶é—´: 2025-04-24 23:51:31
ä¿®æ”¹æ—¶é—´: 2025-05-28 00:44:03
---

[28. æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/)

## 1 é¢˜æ„ç†è§£

é¢˜æ„ï¼šå¯¹äºä¸¤ä¸ªå­—ç¬¦ä¸²s1å’Œs2ï¼Œåœ¨s1ä¸­æ‰¾åˆ°å’Œs2ç›¸åŒçš„å­ä¸²ï¼Œä¸”è¿”å›ç¬¬ä¸€ä¸ªç›¸åŒå­ä¸²çš„å¤´å…ƒç´ ä¸‹æ ‡

**ç¤ºä¾‹ 1: è¾“å…¥: haystack = "hello", needle = "ll" è¾“å‡º: 2**

**ç¤ºä¾‹ 2: è¾“å…¥: haystack = "aaaaa", needle = "bba" è¾“å‡º: -1**

è¯´æ˜: å½“Â needleÂ æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬åº”å½“è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåœ¨é¢è¯•ä¸­å¾ˆå¥½çš„é—®é¢˜ã€‚ å¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œå½“Â needleÂ æ˜¯ç©ºå­—ç¬¦ä¸²æ—¶æˆ‘ä»¬åº”å½“è¿”å› 0 ã€‚

## 2 æ€è·¯

### 2.1 æš´åŠ›åŒ¹é…

å¯¹äº s1 = "aabaabaaf" å’Œ s2 = "aabaaf" è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²
- ä¸¤ä¸ªå­—ç¬¦ä¸²éƒ½ä»ä¸‹æ ‡ä¸º 0 å¼€å§‹ï¼Œi1 = 0ï¼Œi2 = 0ï¼Œä¸”å®ƒä»¬é•¿åº¦ä¸º l1 å’Œ l2
- åˆ¤æ–­ç‰¹æ®Šæƒ…å†µ
	- l2 = 0ï¼Œç›´æ¥è¿”å›0
	- l2 > l1ï¼Œç›´æ¥è¿”å›-1
- å¼€å§‹å¾ªç¯éå†ï¼Œæ³¨æ„å¾ªç¯çš„æ¡ä»¶æ˜¯ `i1 < l1 - l2 + 1`
	- å…ˆéå†s1å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°é¦–å­—æ¯ç›¸ç­‰çš„åœ°æ–¹ï¼Œä¸ç›¸ç­‰åˆ™ i1++
	- åˆ¤æ–­æ­¤æ—¶ i1 æ˜¯å¦å¤§äº l1 ï¼›å¦‚æœæ˜¯ï¼Œè¯´æ˜æ²¡æœ‰ç›¸åŒå­ä¸²ï¼›å¦‚æœä¸æ˜¯ï¼Œç»§ç»­ä¸‹ä¸€æ­¥
	- ä»ä¸‹ä¸€ä¸ªå¯¹åº”å­—æ¯å¼€å§‹æ¯”è¾ƒï¼ˆå› ä¸ºé¦–å­—æ¯å·²ç»ç›¸ç­‰ï¼‰
	- å¦‚æœæ¯”è¾ƒæ—¶ï¼Œå‘ç° i2 = l2ï¼Œè¯´æ˜æ‰¾åˆ°äº†å­ä¸²ï¼›å¦åˆ™å›é€€ `i1 -= i2 -1,i2 =0`

### 2.2 KMPç®—æ³•

[0_KMPç®—æ³•](0_KMPç®—æ³•.md)
## 3 å¯¹æ¯”

- æš´åŠ›åŒ¹é…
	- ä¸æ–­è°ƒæ•´çˆ¶ä¸²çš„æŒ‡é’ˆï¼Œå®ç°çš„
- KMPç®—æ³•
	- ä¸æ–­è°ƒæ•´å­ä¸²çš„æŒ‡é’ˆï¼ˆnextæ•°ç»„çš„å€¼â€”â€”ä¹‹å‰åŒ¹é…è¿‡çš„çŠ¶æ€ï¼‰å®ç°çš„![KMPç²¾è®²4.gif|300|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/26dde3bfb2dc6fe5c8026c9dcfe4fca9.gif)
## 4 ä»£ç å®ç°

### 4.1 æš´åŠ›åŒ¹é…

```java
/**
 * åŸºäºçª—å£æ»‘åŠ¨çš„ç®—æ³•
 * <p>
 * æ—¶é—´å¤æ‚åº¦ï¼šO(m*n)
 * ç©ºé—´å¤æ‚åº¦ï¼šO(1)
 * æ³¨ï¼šnä¸ºhaystackçš„é•¿åº¦ï¼Œmä¸ºneedleçš„é•¿åº¦
 */
class Solution {
    public int strStr(String haystack, String needle) {
        int m = needle.length();
        int n = haystack.length();
        //1. å…ˆæ’é™¤ä¸ç¬¦åˆçš„æƒ…å†µ
        if(m==0){
            return 0;
        }
        if(n<m){
            return -1;
        }
        //2.é€ä¸€åŒ¹é…,åŒ¹é…çš„æ¬¡æ•°æœ€å¤§ä¸ºn-m+1
        int i = 0; //haystackå­—ç¬¦ä¸²çš„æŒ‡é’ˆ
        int j = 0; //needleå­—ç¬¦ä¸²çš„æŒ‡é’ˆ
        while(i<n-m+1){
            //2.1 æ‰¾åˆ°é¦–å­—æ¯ç›¸ç­‰
            while(i<n&&haystack.charAt(i)!=needle.charAt(j)){
                i++;
            }
            //2.2 æ²¡æœ‰é¦–å­—æ¯ç›¸ç­‰
            if(i==n){
                return -1;
            }
            //2.3 éå†åç»­å­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ç›¸ç­‰
            i++;
            j++;
            while(i<n&&j<m&&haystack.charAt(i)==needle.charAt(j)){
                i++;
                j++;
            }
            //2.4 æ‰¾åˆ°ç›¸ç­‰/ä¸ç›¸ç­‰çš„æƒ…å†µ
            if(j==m){
                return i-j;
            }else{
                //å›é€€iå’ŒjæŒ‡é’ˆ
                //iå›é€€åˆ°ï¼Œé¦–å­—æ¯ç›¸åŒçš„åä¸€ä¸ªå­—ç¬¦ï¼Œç»§ç»­åŒ¹é…
                i -= j-1;
                j=0;
            }
        }
        return -1;
    }
}
```

å¤ä¹ ï¼ˆ2024-3-30ï¼‰
- æ³¨æ„ä¸‰ä¸ªwhileå¾ªç¯çš„åˆ¤æ–­æ¡ä»¶
	- ç¬¬ä¸€ä¸ª `i<n-m+1` ï¼šæ‰¾åˆ°é¦–å­—æ¯ç›¸ç­‰æ—¶ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ç›¸ç­‰ï¼Œè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼›
	- ç¬¬äºŒä¸ª `i<n`ï¼šé˜²æ­¢iè„šæ ‡è¶Šç•Œ
	- ç¬¬ä¸‰ä¸ª `i<n&&j<m` ï¼šé˜²æ­¢è„šæ ‡è¶Šç•Œ

### 4.2 KMP

```java
// æ–¹æ³•ä¸€
class Solution {
    public void getNext(int[] next, String s){
        int j = -1;
        next[0] = j;
        for (int i = 1; i < s.length(); i++){
            while(j >= 0 && s.charAt(i) != s.charAt(j+1)){
                j=next[j];
            }

            if(s.charAt(i) == s.charAt(j+1)){
                j++;
            }
            next[i] = j;
        }
    }
    public int strStr(String haystack, String needle) {
        if(needle.length()==0){
            return 0;
        }

        int[] next = new int[needle.length()];
        getNext(next, needle);
        int j = -1;
        for(int i = 0; i < haystack.length(); i++){
            while(j>=0 && haystack.charAt(i) != needle.charAt(j+1)){
                j = next[j];
            }
            if(haystack.charAt(i) == needle.charAt(j+1)){
                j++;
            }
            if(j == needle.length()-1){
                return (i-needle.length()+1);
            }
        }

        return -1;
    }
}
```

```java
class Solution {
    //å‰ç¼€è¡¨ï¼ˆä¸å‡ä¸€ï¼‰Javaå®ç°
    public int strStr(String haystack, String needle) {
        if (needle.length() == 0) return 0;
        int[] next = new int[needle.length()];
        getNext(next, needle);

        int j = 0;
        for (int i = 0; i < haystack.length(); i++) {
            while (j > 0 && needle.charAt(j) != haystack.charAt(i)) 
                j = next[j - 1];
            if (needle.charAt(j) == haystack.charAt(i)) 
                j++;
            if (j == needle.length()) 
                return i - needle.length() + 1;
        }
        return -1;

    }
    
    private void getNext(int[] next, String s) {
        int j = 0;
        next[0] = 0;
        for (int i = 1; i < s.length(); i++) {
            while (j > 0 && s.charAt(j) != s.charAt(i)) 
                j = next[j - 1];
            if (s.charAt(j) == s.charAt(i)) 
                j++;
            next[i] = j; 
        }
    }
}
```

å¤ä¹ ï¼ˆ2024-3-30ï¼‰
- æ³¨æ„ `j = next[j - 1]` ï¼Œæ˜¯æ‰¾å½“å‰å­—ç¬¦çš„å‰é¢å­—ç¬¦ä¸²çš„å¾ªç¯ä¸å˜é‡ï¼ˆå³nextæ•°ç»„çš„å€¼ / ä¹Ÿæ˜¯ æœ€é•¿ç›¸ç­‰å‰åç¼€çš„é•¿åº¦ï¼‰
- æ³¨æ„ **è„šæ ‡è¶Šç•Œé—®é¢˜**