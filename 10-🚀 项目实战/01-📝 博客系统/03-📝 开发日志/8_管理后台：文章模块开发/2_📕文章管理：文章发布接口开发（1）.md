---
æ–‡ç« æ ‡é¢˜: "[[2_ğŸ“•æ–‡ç« ç®¡ç†ï¼šæ–‡ç« å‘å¸ƒæ¥å£å¼€å‘ï¼ˆ1ï¼‰]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†åŸºäºSpring Bootå’ŒMybatis-Plusæ„å»ºæ–‡ç« å‘å¸ƒæ¥å£çš„å®ç°ã€‚æ¶µç›–DO/Mapperåˆ›å»ºã€è¯·æ±‚VOå®šä¹‰ã€Serviceå±‚ä¸šåŠ¡é€»è¾‘ï¼ˆåŒ…å«äº‹åŠ¡ç®¡ç†å’Œåˆ†ç±»æ ¡éªŒï¼‰ä»¥åŠControllerå±‚å¼€å‘ã€‚é€šè¿‡æµ‹è¯•éªŒè¯äº†æ¥å£åŠŸèƒ½ä¸äº‹åŠ¡å›æ»šã€‚
æ–‡ç« æ ‡ç­¾:
- "Java"
- "Spring Boot"
- "Mybatis-Plus"
- "APIå¼€å‘"
- "æ–‡ç« ç®¡ç†"
- "äº‹åŠ¡ç®¡ç†"
- "æ•°æ®åº“æ“ä½œ"
ç›¸å…³æ–‡ç« :
- "[[4_ğŸ“•åšå®¢è®¾ç½®ï¼šæ›´æ–°æ¥å£å¼€å‘]]"
- "[[4_ğŸ“•æ–‡ç« åˆ†ç±»ï¼šåˆ é™¤æ¥å£å¼€å‘]]"
- "[[5_ğŸ“•æ–‡ç« åˆ†ç±»ï¼šåˆ†ç±»Selectä¸‹æ‹‰åˆ—è¡¨æ¥å£å¼€å‘]]"
- "[[6_ğŸ“•åšå®¢è®¾ç½®ï¼šè·å–è¯¦æƒ…æ¥å£å¼€å‘]]"
- "[[0_å¯¼è¯»]]"
æ–‡ç« åˆ†ç±»: "ğŸš€ é¡¹ç›®å®æˆ˜"
æ–‡ç« è·¯å¾„: "10-ğŸš€ é¡¹ç›®å®æˆ˜/01-ğŸ“ åšå®¢ç³»ç»Ÿ/03-ğŸ“ å¼€å‘æ—¥å¿—/8_ç®¡ç†åå°ï¼šæ–‡ç« æ¨¡å—å¼€å‘/2_ğŸ“•æ–‡ç« ç®¡ç†ï¼šæ–‡ç« å‘å¸ƒæ¥å£å¼€å‘ï¼ˆ1ï¼‰.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­â­ ç²¾é€šå¿…å¤‡
åˆ›å»ºæ—¶é—´: 2024-04-30 14:41:14
ä¿®æ”¹æ—¶é—´: 2025-05-27 00:58:01
---

æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ­£å¼å¼€å§‹è¿›å…¥åˆ°æ–‡ç« ç®¡ç†æ¨¡å—çš„æ¥å£å¼€å‘å·¥ä½œï¼Œé¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªæ¥å£ â€”â€” æ–‡ç« å‘å¸ƒã€‚
## 1 åˆ›å»ºè¡¨å¯¹åº”çš„ DO å’Œ Mapper æ¥å£

ä¸Šå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†æ–‡ç« ç®¡ç†æ¨¡å—æ‰€éœ€çš„è¡¨éƒ½å»ºç«‹å¥½äº†ï¼Œæ¥ä¸‹æ¥æŠŠå¯¹åº”çš„Â `DO`Â å®ä½“ç±»å’ŒÂ `Mapper`Â æ¥å£åˆ†åˆ«åˆ›å»ºä¸€ä¸‹ï¼š

![image.png|300](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/05c6cf03052cf8148e1379e61a45b859.png)

### 1.1 æ–‡ç« 

åœ¨Â `weblog-module-common`Â æ¨¡å—ä¸­Â `/domain/dos`Â ä»¥åŠÂ `/domain/mapper`Â åŒ…ä¸‹åˆ†åˆ«åˆ›å»ºÂ `DO`Â ç±»å’Œæ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@TableName("t_article")
public class ArticleDO {

    @TableId(type = IdType.AUTO)
    private Long id;

    private String title;

    private String cover;

    private String summary;

    private LocalDateTime createTime;

    private LocalDateTime updateTime;

    private Boolean isDeleted;

    private Long readNum;
}
```

```java
public interface ArticleMapper extends BaseMapper<ArticleDO> {
}
```

### 1.2 æ–‡ç« å†…å®¹

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@TableName("t_article_content")
public class ArticleContentDO {

    @TableId(type = IdType.AUTO)
    private Long id;

    private Long articleId;

    private String content;

}
```

```java
public interface ArticleContentMapper extends BaseMapper<ArticleContentDO> {

}
```

### 1.3 æ–‡ç« -åˆ†ç±»å…³è”å…³ç³»

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@TableName("t_article_category_rel")
public class ArticleCategoryRelDO {

    @TableId(type = IdType.AUTO)
    private Long id;

    private Long articleId;

    private Long categoryId;
}
```

```java
public interface ArticleCategoryRelMapper extends BaseMapper<ArticleCategoryRelDO> {

}
```

### 1.4 æ–‡ç« -æ ‡ç­¾å…³è”å…³ç³»

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@TableName("t_article_tag_rel")
public class ArticleTagRelDO {

    @TableId(type = IdType.AUTO)
    private Long id;

    private Long articleId;

    private Long tagId;
}
```

```java
public interface ArticleTagRelMapper extends BaseMapper<ArticleTagRelDO> {

}
```

## 2 æ–°å¢æ–‡ç« å‘å¸ƒè¯·æ±‚ VO

ç„¶åï¼Œåœ¨Â `weblog-module-admin`Â æ¨¡å—ä¸­çš„Â `/model/vo`Â åŒ…ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªÂ `/article`Â åŒ…ï¼Œä¸“é—¨ç”¨äºæ”¾ç½®å’Œæ–‡ç« ç›¸å…³çš„Â `VO`ç±»ï¼Œç„¶ååˆ›å»ºÂ `PublishArticleReqVO`Â è¯·æ±‚ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169709622271523)

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@ApiModel(value = "å‘å¸ƒæ–‡ç«  VO")
public class PublishArticleReqVO {

    @NotBlank(message = "æ–‡ç« æ ‡é¢˜ä¸èƒ½ä¸ºç©º")
    @Length(min = 1, max = 40, message = "æ–‡ç« æ ‡é¢˜å­—æ•°éœ€å¤§äº 1 å°äº 40")
    private String title;

    @NotBlank(message = "æ–‡ç« å†…å®¹ä¸èƒ½ä¸ºç©º")
    private String content;

    @NotBlank(message = "æ–‡ç« å°é¢ä¸èƒ½ä¸ºç©º")
    private String cover;
    
	/**  
	 * æ–‡ç« æ‘˜è¦ï¼ˆä¸å¼ºåˆ¶è¦æ±‚ï¼‰  
	 */
    private String summary;

    @NotNull(message = "æ–‡ç« åˆ†ç±»ä¸èƒ½ä¸ºç©º")
    private Long categoryId;

    @NotEmpty(message = "æ–‡ç« æ ‡ç­¾ä¸èƒ½ä¸ºç©º")
    private List<String> tags;
}
```

è€ƒè™‘åˆ°å‘å¸ƒæ–‡ç« æ—¶ï¼Œéƒ¨åˆ†ç”¨æˆ·å¯èƒ½ä¸æƒ³è¢«å¼ºåˆ¶å¡«å†™æ–‡ç« æ‘˜è¦ï¼ŒÂ `summary`Â æ‘˜è¦å­—æ®µå¹¶æ²¡æœ‰æ·»åŠ æ ¡éªŒæ³¨è§£ã€‚

## 3 æ–°å»º service

æ¥ä¸‹æ¥æ˜¯ä¸šåŠ¡å±‚ï¼Œåœ¨Â `/service`Â åŒ…ä¸­åˆ›å»ºÂ `AdminArticleService`Â æ¥å£ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªå‘å¸ƒæ–‡ç« çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public interface AdminArticleService {
    /**
     * å‘å¸ƒæ–‡ç« 
     * @param publishArticleReqVO
     * @return
     */
    Response publishArticle(PublishArticleReqVO publishArticleReqVO);
}
```

ç„¶ååœ¨Â `/impl`Â åŒ…ä¸­ï¼Œåˆ›å»ºè¯¥æ¥å£çš„å®ç°ç±»Â `AdminArticleServiceImpl`ï¼Œ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```java
@Service
@Slf4j
public class AdminArticleServiceImpl implements AdminArticleService {

    @Autowired
    private ArticleMapper articleMapper;
    @Autowired
    private ArticleContentMapper articleContentMapper;
    @Autowired
    private ArticleCategoryRelMapper articleCategoryRelMapper;
    @Autowired
    private CategoryMapper categoryMapper;

    /**
     * å‘å¸ƒæ–‡ç« 
     *
     * @param publishArticleReqVO
     * @return
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public Response publishArticle(PublishArticleReqVO publishArticleReqVO) {
        // 1. VO è½¬ ArticleDO, å¹¶ä¿å­˜
        ArticleDO articleDO = ArticleDO.builder()
                .title(publishArticleReqVO.getTitle())
                .cover(publishArticleReqVO.getCover())
                .summary(publishArticleReqVO.getSummary())
                .createTime(LocalDateTime.now())
                .updateTime(LocalDateTime.now())
                .build();
        articleMapper.insert(articleDO);

        // æ‹¿åˆ°æ’å…¥è®°å½•çš„ä¸»é”® ID
        Long articleId = articleDO.getId();

        // 2. VO è½¬ ArticleContentDOï¼Œå¹¶ä¿å­˜
        ArticleContentDO articleContentDO = ArticleContentDO.builder()
                .articleId(articleId)
                .content(publishArticleReqVO.getContent())
                .build();
        articleContentMapper.insert(articleContentDO);

        // 3. å¤„ç†æ–‡ç« å…³è”çš„åˆ†ç±»
        Long categoryId = publishArticleReqVO.getCategoryId();

        // 3.1 æ ¡éªŒæäº¤çš„åˆ†ç±»æ˜¯å¦çœŸå®å­˜åœ¨
        CategoryDO categoryDO = categoryMapper.selectById(categoryId);
        if (Objects.isNull(categoryDO)) {
            log.warn("==> åˆ†ç±»ä¸å­˜åœ¨, categoryId: {}", categoryId);
            throw new BizException(ResponseCodeEnum.CATEGORY_NOT_EXISTED);
        }
        
        ArticleCategoryRelDO articleCategoryRelDO = ArticleCategoryRelDO.builder()
                .articleId(articleId)
                .categoryId(categoryId)
                .build();
        articleCategoryRelMapper.insert(articleCategoryRelDO);

        // 4. ä¿å­˜æ–‡ç« å…³è”çš„æ ‡ç­¾é›†åˆ
        List<String> publishTags = publishArticleReqVO.getTags();
        insertTags(publishTags);

        return Response.success();
    }

    /**
     * ä¿å­˜æ ‡ç­¾
     * @param publishTags
     */
    private void insertTags(List<String> publishTags) {
        // TODO 
    }
}
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨å‘å¸ƒæ–‡ç« çš„å®ç°æ–¹æ³•ä¸Šï¼Œæ·»åŠ äº†Â `@Transactional(rollbackFor = Exception.class)`Â äº‹åŠ¡æ³¨è§£ï¼Œè¡¨ç¤ºåœ¨è¯¥æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¿è¯æ–¹æ³•å†…æ‰€æœ‰æ“ä½œæ˜¯ä¸ªåŸå­æ€§çš„ï¼Œè¦ä¸å…¨éƒ¨æˆåŠŸï¼Œè¦ä¸å…¨éƒ¨å¤±è´¥ï¼Œä¸€æ—¦ä¸­é—´å‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡ã€‚ç„¶ååœ¨çœ‹çœ‹æ–¹æ³•ä¸­çš„éƒ½å¹²äº†å•¥ï¼Ÿé¦–å…ˆå°†Â `VO`Â è¯·æ±‚ç±»ä¸­çš„ç›¸å…³å­—æ®µæå–äº†å‡ºæ¥ï¼Œå¦‚æ–‡ç« æ ‡é¢˜ã€å°é¢ç­‰ï¼Œç”¨æ¥æ„å»ºÂ `ArticleDO`Â ç±»ï¼Œå¹¶æ‰§è¡Œäº†Â `insert`Â æ–°å¢æ–‡ç« æ“ä½œï¼Œç„¶åï¼Œæ‹¿åˆ°äº†æ–‡ç« Â `ID`, æ¥ç€ä¿å­˜æ–‡ç« å†…å®¹ï¼Œå†æ¥ç€ä¿å­˜æ–‡ç« åˆ†ç±»å…³è”è®°å½•ï¼Œæ³¨æ„ï¼Œä¿å­˜è®°å½•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ ¡éªŒäº†æäº¤è¿‡æ¥çš„åˆ†ç±»æ˜¯å¦å­˜åœ¨äºè¡¨ä¸­ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªä¸šåŠ¡å¼‚å¸¸ï¼Œæç¤ºè¯¥åˆ†ç±»ä¸å­˜åœ¨ï¼›æœ€åæ˜¯ä¿å­˜äº†æ–‡ç« æ ‡ç­¾å…³è”è®°å½•ã€‚

> æ³¨æ„ï¼šè¿™é‡Œä¿å­˜æ ‡ç­¾çš„å…·ä½“é€»è¾‘æ²¡å†™ï¼Œæš‚æ—¶ç©ºç€ï¼Œä¼šåœ¨åç»­å°èŠ‚ä¸­æ‹å‡ºæ¥å•ç‹¬è®²ï¼Œè¿™å—å°†æ¼”ç¤ºå¦‚ä½•é€šè¿‡ Mybatis Plus å®ç°çœŸå®çš„æ‰¹é‡æ’å…¥ã€‚

### 3.1 æ·»åŠ å…¨å±€æšä¸¾å€¼

ç¼–è¾‘å…¨å±€å“åº”æšä¸¾Â `ResponseCodeEnum`ï¼Œ æ·»åŠ å¦‚ä¸‹æšä¸¾å€¼ï¼š

```java
CATEGORY_NOT_EXISTED("20009", "æäº¤çš„åˆ†ç±»ä¸å­˜åœ¨ï¼"),
```

## 4 æ–°å»º controller

å®Œæˆäº†ä¸šåŠ¡å±‚åï¼Œæˆ‘ä»¬åœ¨Â `/controller`Â åŒ…ä¸­æ–°å»ºÂ `AdminArticleController`Â æ§åˆ¶å™¨ï¼Œç”¨äºç»Ÿä¸€æ”¾ç½®æ–‡ç« ç®¡ç†ç›¸å…³çš„æ¥å£ï¼Œç„¶åæ·»åŠ Â `/admin/article/publish`Â æ–‡ç« å‘å¸ƒæ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
@RestController
@RequestMapping("/admin/article")
@Api(tags = "Admin æ–‡ç« æ¨¡å—")
public class AdminArticleController {

    @Autowired
    private AdminArticleService articleService;

    @PostMapping("/publish")
    @ApiOperation(value = "æ–‡ç« å‘å¸ƒ")
    @ApiOperationLog(description = "æ–‡ç« å‘å¸ƒ")
    @PreAuthorize("hasRole('ROLE_ADMIN')")
    public Response publishArticle(@RequestBody @Validated PublishArticleReqVO publishArticleReqVO) {
        return articleService.publishArticle(publishArticleReqVO);
    }

}
```

## 5 ç®€å•æµ‹è¯•ä¸€ä¸‹

åŠŸèƒ½å¼€å‘å®Œæˆåï¼Œé‡å¯é¡¹ç›®ï¼Œæµè§ˆå™¨è®¿é—®Â `/doc.html`Â , æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚

### 5.1 æäº¤ä¸€ä¸ªä¸å­˜åœ¨çš„åˆ†ç±»

å…¥å‚å¦‚ä¸‹ï¼Œè¿™é‡Œå¡«å†™çš„åˆ†ç±»Â `ID`Â æ˜¯è¡¨ä¸­ä¸å­˜åœ¨çš„ï¼Œæäº¤çœ‹çœ‹æ•ˆæœï¼š

```json
{
  "categoryId": 1,
  "content": "å†…å®¹",
  "cover": "https://img.quanxiaoha.com/quanxiaoha/193dd1504ebb4f138085acb23619e0dd.jpg",
  "summary": "æµ‹è¯•æ‘˜è¦",
  "tags": ["Java", "å·¥å…·"],
  "title": "æµ‹è¯•æ ‡é¢˜"
}
```

![](https://img.quanxiaoha.com/quanxiaoha/169710421724166)

åç«¯æ£€æµ‹åˆ°è¯¥æ¡åˆ†ç±»ä¸å­˜åœ¨äºè¡¨ä¸­ï¼Œå¹¶è¿”å›äº†å¯¹åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

### 5.2 æ­£ç¡®æ•°æ®æäº¤

è¿™æ¬¡æ¢æˆä¸€ä¸ªè¡¨ä¸­å­˜åœ¨çš„åˆ†ç±»Â `ID`, å†æ¬¡æäº¤ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169710430636459)

åç«¯å“åº”æ“ä½œæˆåŠŸï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥æ‰“å¼€å¯¹åº”çš„å‡ å¼ æ–‡ç« è¡¨ï¼Œçœ‹çœ‹è®°å½•æ˜¯å¦çœŸçš„æ·»åŠ æˆåŠŸï¼Œä¸å‡ºæ„å¤–ï¼Œæ•°æ®éƒ½æœ‰äº†ï¼ˆæ–‡ç« æ ‡ç­¾å…³è”è®°å½•é™¤å¤–ï¼‰ã€‚

### 5.3 æ¨¡æ‹Ÿä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼Œçœ‹çœ‹äº‹åŠ¡æ˜¯å¦æ­£å¸¸å›æ»š

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œäº‹åŠ¡æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ä¸ºäº†æ¨¡æ‹Ÿä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

```java
int i = 10 / 0;
```

å†æ¬¡è°ƒç”¨å‘å¸ƒæ–‡ç« æ¥å£ï¼Œè¯¥è¡Œä»£ç è¿è¡Œåï¼Œä¼šæŠ¥ _åˆ†æ¯ä¸èƒ½ä¸º 0 å¼‚å¸¸_ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169710457078258)

ä½ ä¼šå‘ç°ï¼Œç›¸å…³è®°å½•éƒ½æ²¡æœ‰æ·»åŠ æˆåŠŸï¼Œè¿™è¡¨ç¤ºäº‹åŠ¡æ³¨è§£ç”Ÿæ•ˆäº†ï¼Œäº‹åŠ¡è¢«å›æ»šäº†ã€‚
## 7 ç»“è¯­

æœ¬å°ç»“ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†æ–‡ç« å‘å¸ƒæ¥å£çš„åŸºæœ¬åŠŸèƒ½ï¼Œå¹¶è°ƒè¯•é€šè¿‡ã€‚æ³¨æ„ï¼Œæ ‡ç­¾ä¿å­˜çš„é€»è¾‘å¹¶æ²¡æœ‰å†™å®Œï¼Œå› ä¸ºè¿™å—æˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•é€šè¿‡ Mybatis Plus å®ç°çœŸå®æ‰¹é‡æ’å…¥åŠŸèƒ½ï¼Œåœ¨ä¸‹é¢å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šç»†è®²ã€‚