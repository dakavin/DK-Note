---
æ–‡ç« æ ‡é¢˜: "[[3_è·å–æ–‡ç« è¯¦æƒ…æ¥å£å¼€å‘]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« è¯¦ç»†é˜è¿°äº†è·å–æ–‡ç« è¯¦æƒ…APIçš„å¼€å‘ã€‚æ¶µç›–æ¥å£å®šä¹‰ã€VOåˆ›å»ºã€MyBatis-Plusæ•°æ®æŸ¥è¯¢ï¼Œä»¥åŠServiceå±‚ä¸šåŠ¡æ•°æ®æ•´åˆä¸Controllerå±‚æ¥å£æš´éœ²ï¼Œå¹¶è¿›è¡Œæµ‹è¯•éªŒè¯ã€‚
æ–‡ç« æ ‡ç­¾:
- "RESTful API"
- "Spring Boot"
- "Java"
- "MyBatis-Plus"
- "APIè®¾è®¡"
- "åç«¯å¼€å‘"
- "æ•°æ®æŸ¥è¯¢"
- "VO"
ç›¸å…³æ–‡ç« :
- "[[3_ğŸ“•ä¾§è¾¹æ ï¼šè·å–åˆ†ç±»ã€æ ‡ç­¾åˆ—è¡¨æ¥å£å¼€å‘]]"
- "[[4_ğŸ“•æ–‡ç« åˆ†ç±»ï¼šåˆ é™¤æ¥å£å¼€å‘]]"
- "[[4_ğŸ“•æ–‡ç« ç®¡ç†ï¼šæ–‡ç« åˆ é™¤æ¥å£å¼€å‘]]"
- "[[5_ğŸ“•æ–‡ç« ç®¡ç†ï¼šåˆ†é¡µæ¥å£å¼€å‘]]"
- "[[10_è·å–æŸä¸ªæ ‡ç­¾ä¸‹çš„æ–‡ç« åˆ—è¡¨â€”â€”åˆ†é¡µæ¥å£å¼€å‘]]"
æ–‡ç« åˆ†ç±»: "ğŸš€ é¡¹ç›®å®æˆ˜"
æ–‡ç« è·¯å¾„: "10-ğŸš€ é¡¹ç›®å®æˆ˜/01-ğŸ“ åšå®¢ç³»ç»Ÿ/03-ğŸ“ å¼€å‘æ—¥å¿—/11_åšå®¢å‰å°ï¼šæ–‡ç« è¯¦æƒ…é¡µå¼€å‘/3_è·å–æ–‡ç« è¯¦æƒ…æ¥å£å¼€å‘.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-05-15 22:38:06
ä¿®æ”¹æ—¶é—´: 2025-05-27 01:01:19
---

ä¸Šå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†Â `Markdown`Â æ–‡æœ¬è½¬æ¢Â `HTML`Â çš„å·¥å…·ç±»å°è£…å¥½äº†ã€‚è¿™å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠè·å–æ–‡ç« è¯¦æƒ…æ¥å£å¼€å‘å®Œæˆã€‚

![](https://img.quanxiaoha.com/quanxiaoha/169873323652524)

## 1. æ¥å£ã€å‡ºå…¥å‚æ ¼å¼å®šä¹‰

é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹ç€Â `UI`Â åŸå‹å›¾ï¼Œæ¥ç¡®å®šä¸€ä¸‹æ¥å£çš„å‡ºå…¥å‚Â `JSON`Â æ ¼å¼ã€‚

### 1.1 æ¥å£è·¯å¾„

```http
POST /article/detail
```

### 1.2 å…¥å‚

```json
{
  "articleId": 12 // æ–‡ç«  ID
}
```

### 1.3 å‡ºå‚

```json
{
  "success": true,
  "message": null,
  "errorCode": null,
  "data": {
    "title": "æµ‹è¯•", // æ–‡ç« æ ‡é¢˜
    "content": "æ­£æ–‡", // æ–‡ç« æ­£æ–‡ï¼ˆHTMLä»£ç ï¼‰
    "createTime": "2023-10-14 16:20:26", // æ–‡ç« å‘å¸ƒæ—¶é—´
    "categoryId": 12, // æ‰€å±åˆ†ç±» ID
    "categoryName": "fsdfd", // æ‰€å±åˆ†ç±»åç§°
    "readNum": 1, // é˜…è¯»é‡
    "tags": [ // æ ‡ç­¾é›†åˆ
      {
        "id": 35,
        "name": "ä½ å¥½å‘€"
      }
    ],
    "preArticle": { // ä¸Šä¸€ç¯‡æ–‡ç« 
      "articleId": 16,
      "articleTitle": "test"
    },
    "nextArticle": { // ä¸‹ä¸€ç¯‡æ–‡ç« 
      "articleId": 9,
      "articleTitle": "æµ‹è¯•æ ‡é¢˜"
    }
  }
}
```

## 2. æ–°å¢å‡ºå…¥å‚ VO

æ¥å£å‡ºå…¥å‚æ ¼å¼ç¡®å®šåï¼Œæˆ‘ä»¬æ¥åˆ›å»ºå¯¹åº”çš„Â `VO`Â ç±»ã€‚

![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/05/982123f2dd146d81c7bcb923165e6b37.png)

### 2.1 å…¥å‚ VO

åœ¨Â `weblog-web`Â å­æ¨¡å—ä¸­çš„Â `/model/vo/article`Â åŒ…ä¸‹ï¼Œåˆ›å»ºÂ `FindArticleDetailReqVO`Â å…¥å‚Â `VO`Â ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
package com.quanxiaoha.weblog.web.model.vo.article;

import io.swagger.annotations.ApiModel;
import lombok.Builder;
import lombok.Data;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@ApiModel(value = "æŸ¥è¯¢æ–‡ç« è¯¦æƒ… VO")
public class FindArticleDetailReqVO {
    /**
     * æ–‡ç«  ID
     */
    private Long articleId;
}

```

### 2.2 å‡ºå‚ VO

#### 2.2.1 è·å–æ–‡ç« è¯¦æƒ… VO

```java
package com.quanxiaoha.weblog.web.model.vo.article;

import com.quanxiaoha.weblog.web.model.vo.tag.FindTagListRspVO;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDateTime;
import java.util.List;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class FindArticleDetailRspVO {
    /**
     * æ–‡ç« æ ‡é¢˜
     */
    private String title;
    /**
     * æ–‡ç« æ­£æ–‡ï¼ˆHTMLï¼‰
     */
    private String content;
    /**
     * å‘å¸ƒæ—¶é—´
     */
    private LocalDateTime createTime;
    /**
     * åˆ†ç±» ID
     */
    private Long categoryId;
    /**
     * åˆ†ç±»åç§°
     */
    private String categoryName;
    /**
     * é˜…è¯»é‡
     */
    private Long readNum;
    /**
     * æ ‡ç­¾é›†åˆ
     */
    private List<FindTagListRspVO> tags;
    /**
     * ä¸Šä¸€ç¯‡æ–‡ç« 
     */
    private FindPreNextArticleRspVO preArticle;
    /**
     * ä¸‹ä¸€ç¯‡æ–‡ç« 
     */
    private FindPreNextArticleRspVO nextArticle;
}

```

#### 2.2.2 ä¸Šä¸‹ç¯‡æ–‡ç«  VO

```java
package com.quanxiaoha.weblog.web.model.vo.article;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class FindPreNextArticleRspVO {
    /**
     * æ–‡ç«  ID
     */
    private Long articleId;

    /**
     * æ–‡ç« æ ‡é¢˜
     */
    private String articleTitle;
}

```

## 3. å°è£… mapper æŸ¥è¯¢æ–¹æ³•

ä¸ºäº†ç­‰ä¼šèƒ½åœ¨Â `service`Â ä¸šåŠ¡å±‚ä¸­ï¼Œç»„åˆæ–‡ç« è¯¦æƒ…é¡µæ‰€éœ€çš„ç›¸å…³æ•°æ®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»™ç›¸å…³Â `mapper`Â æ¥å£å°è£…å‡ ä¸ªæŸ¥è¯¢æ–¹æ³•ï¼Œä¸šåŠ¡å±‚éœ€è¦ç”¨åˆ°ã€‚

### 3.1 æ ¹æ®æ ‡ç­¾ ID æ‰¹é‡æŸ¥è¯¢

ç¼–è¾‘Â `TagMapper`Â æ¥å£ï¼Œæ·»åŠ æ ¹æ®æ ‡ç­¾ ID æ‰¹é‡æŸ¥è¯¢çš„é»˜è®¤æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
public interface TagMapper extends BaseMapper<TagDO> {

	// çœç•¥...

    /**
     * æ ¹æ®æ ‡ç­¾ ID æ‰¹é‡æŸ¥è¯¢
     * @param tagIds
     * @return
     */
    default List<TagDO> selectByIds(List<Long> tagIds) {
        return selectList(Wrappers.<TagDO>lambdaQuery()
                .in(TagDO::getId, tagIds));
    }
}
```

### 3.2 æŸ¥è¯¢ä¸Šä¸€ç¯‡æ–‡ç« 

![](https://img.quanxiaoha.com/quanxiaoha/169873440771747)

å¦‚æœå½“å‰æ–‡ç« å­˜åœ¨ä¸Šä¸‹ç¯‡æ–‡ç« æ—¶ï¼Œåº•éƒ¨è¿˜éœ€è¦æ˜¾ç¤ºå‡ºæ¥ï¼Œæ–¹ä¾¿ç”¨æˆ·è·³è½¬ã€‚æ‰€ä»¥ï¼Œè¿˜éœ€è¦å°è£…ä¸¤ä¸ªæŸ¥è¯¢ä¸Šä¸‹é¡µæ–‡ç« çš„é»˜è®¤æ–¹æ³•, é¦–å…ˆæ˜¯æŸ¥è¯¢ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public interface ArticleMapper extends BaseMapper<ArticleDO> {

  	// çœç•¥...

    /**
     * æŸ¥è¯¢ä¸Šä¸€ç¯‡æ–‡ç« 
     * @param articleId
     * @return
     */
    default ArticleDO selectPreArticle(Long articleId) {
        return selectOne(Wrappers.<ArticleDO>lambdaQuery()
                .orderByAsc(ArticleDO::getId) // æŒ‰æ–‡ç«  ID å‡åºæ’åˆ—
                .gt(ArticleDO::getId, articleId) // æŸ¥è¯¢æ¯”å½“å‰æ–‡ç«  ID å¤§çš„
                .last("limit 1")); // ç¬¬ä¸€æ¡è®°å½•å³ä¸ºä¸Šä¸€ç¯‡æ–‡ç« 
    }
}
```

æŸ¥è¯¢ä¸Šä¸€ç¯‡æ–‡ç« çš„é€»è¾‘éå¸¸ç®€å•ï¼Œæˆ‘ä»¬æŒ‰æ–‡ç« Â `ID`Â è¿›è¡Œå‡åºï¼ŒæŸ¥è¯¢æ¯”å½“å‰æ–‡ç« Â `ID`Â å¤§çš„ï¼Œç¬¬ä¸€æ¡è®°å½•å³ä¸ºä¸Šä¸€ç¯‡æ–‡ç« ã€‚

### 3.3. æŸ¥è¯¢ä¸‹ä¸€ç¯‡æ–‡ç« 

```java
public interface ArticleMapper extends BaseMapper<ArticleDO> {

  	// çœç•¥...

    /**
     * æŸ¥è¯¢ä¸‹ä¸€ç¯‡æ–‡ç« 
     * @param articleId
     * @return
     */
    default ArticleDO selectNextArticle(Long articleId) {
        return selectOne(Wrappers.<ArticleDO>lambdaQuery()
                .orderByDesc(ArticleDO::getId) // æŒ‰æ–‡ç«  ID å€’åºæ’åˆ—
                .lt(ArticleDO::getId, articleId) // æŸ¥è¯¢æ¯”å½“å‰æ–‡ç«  ID å°çš„
                .last("limit 1")); // ç¬¬ä¸€æ¡è®°å½•å³ä¸ºä¸‹ä¸€ç¯‡æ–‡ç« 
    }
}
```

æŸ¥è¯¢ä¸‹ä¸€ç¯‡æ–‡ç« é€»è¾‘æ˜¯åè¿‡æ¥çš„ï¼Œæ˜¯æŒ‰æ–‡ç« Â `ID`Â è¿›è¡Œå€’åºï¼ŒæŸ¥è¯¢æ¯”å½“å‰æ–‡ç« Â `ID`Â å°çš„ï¼Œç¬¬ä¸€æ¡è®°å½•å³ä¸ºä¸‹ä¸€ç¯‡æ–‡ç« ã€‚

## 4. ç¼–å†™ service ä¸šåŠ¡å±‚

æ¥ä¸‹æ¥ï¼Œç¼–è¾‘Â `ArticleService`Â æ–‡ç« ä¸šåŠ¡æ¥å£ï¼Œå£°æ˜ä¸€ä¸ªè·å–æ–‡ç« è¯¦æƒ…çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public interface ArticleService {
	// çœç•¥...

    /**
     * è·å–æ–‡ç« è¯¦æƒ…
     * @param findArticleDetailReqVO
     * @return
     */
    Response findArticleDetail(FindArticleDetailReqVO findArticleDetailReqVO);
}
```

ç„¶åï¼Œåœ¨Â `ArticleServiceImpl`Â å®ç°ç±»ä¸­å®ç°ä¸Šè¿°æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
@Service
@Slf4j
public class ArticleServiceImpl implements ArticleService {

    @Autowired
    private ArticleMapper articleMapper;
    @Autowired
    private ArticleContentMapper articleContentMapper;
    @Autowired
    private CategoryMapper categoryMapper;
    @Autowired
    private ArticleCategoryRelMapper articleCategoryRelMapper;
    @Autowired
    private TagMapper tagMapper;
    @Autowired
    private ArticleTagRelMapper articleTagRelMapper;

    // çœç•¥...

    /**
     * è·å–æ–‡ç« è¯¦æƒ…
     *
     * @param findArticleDetailReqVO
     * @return
     */
    @Override
    public Response findArticleDetail(FindArticleDetailReqVO findArticleDetailReqVO) {
        Long articleId = findArticleDetailReqVO.getArticleId();

        ArticleDO articleDO = articleMapper.selectById(articleId);

        // åˆ¤æ–­æ–‡ç« æ˜¯å¦å­˜åœ¨
        if (Objects.isNull(articleDO)) {
            log.warn("==> è¯¥æ–‡ç« ä¸å­˜åœ¨, articleId: {}", articleId);
            throw new BizException(ResponseCodeEnum.ARTICLE_NOT_FOUND);
        }

        // æŸ¥è¯¢æ­£æ–‡
        ArticleContentDO articleContentDO = articleContentMapper.selectByArticleId(articleId);

        // DO è½¬ VO
        FindArticleDetailRspVO vo = FindArticleDetailRspVO.builder()
                .title(articleDO.getTitle())
                .createTime(articleDO.getCreateTime())
                .content(MarkdownHelper.convertMarkdown2Html(articleContentDO.getContent()))
                .readNum(articleDO.getReadNum())
                .build();

        // æŸ¥è¯¢æ‰€å±åˆ†ç±»
        ArticleCategoryRelDO articleCategoryRelDO = articleCategoryRelMapper.selectByArticleId(articleId);
        CategoryDO categoryDO = categoryMapper.selectById(articleCategoryRelDO.getCategoryId());
        vo.setCategoryId(categoryDO.getId());
        vo.setCategoryName(categoryDO.getName());

        // æŸ¥è¯¢æ ‡ç­¾
        List<ArticleTagRelDO> articleTagRelDOS = articleTagRelMapper.selectByArticleId(articleId);
        List<Long> tagIds = articleTagRelDOS.stream().map(ArticleTagRelDO::getTagId).collect(Collectors.toList());
        List<TagDO> tagDOS = tagMapper.selectByIds(tagIds);

        // æ ‡ç­¾ DO è½¬ VO
        List<FindTagListRspVO> tagVOS = tagDOS.stream()
                .map(tagDO -> FindTagListRspVO.builder().id(tagDO.getId()).name(tagDO.getName()).build())
                .collect(Collectors.toList());
        vo.setTags(tagVOS);

        // ä¸Šä¸€ç¯‡
        ArticleDO preArticleDO = articleMapper.selectPreArticle(articleId);
        if (Objects.nonNull(preArticleDO)) {
            FindPreNextArticleRspVO preArticleVO = FindPreNextArticleRspVO.builder()
                    .articleId(preArticleDO.getId())
                    .articleTitle(preArticleDO.getTitle())
                    .build();
            vo.setPreArticle(preArticleVO);
        }

        // ä¸‹ä¸€ç¯‡
        ArticleDO nextArticleDO = articleMapper.selectNextArticle(articleId);
        if (Objects.nonNull(nextArticleDO)) {
            FindPreNextArticleRspVO nextArticleVO = FindPreNextArticleRspVO.builder()
                    .articleId(nextArticleDO.getId())
                    .articleTitle(nextArticleDO.getTitle())
                    .build();
            vo.setNextArticle(nextArticleVO);
        }

        return Response.success(vo);
    }
}
```

ä¸Šè¿°é€»è¾‘ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å…¥å‚æäº¤çš„æ–‡ç« Â `ID`Â è¿›è¡ŒæŸ¥è¯¢æ–‡ç« è¡¨ï¼Œè‹¥æ–‡ç« ä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œæç¤ºå‰ç«¯ _è¯¥æ–‡ç« ä¸å­˜åœ¨_ï¼Œ å¦‚æœæ–‡ç« å­˜åœ¨ï¼Œåˆ™å†æŸ¥è¯¢å…¶Â `markdown`Â æ­£æ–‡ï¼Œç»„è£…Â `FindArticleDetailRspVO`Â å“åº”ç±»ï¼Œå°†ç›¸å…³å­—æ®µè®¾ç½®ä¸€ä¸‹ï¼Œå…¶ä¸­çš„Â `content`Â å­—æ®µï¼Œé€šè¿‡ä¸Šå°èŠ‚ä¸­å°è£…å¥½çš„Â `MarkdownHelper`Â å·¥å…·ç±»è½¬æ¢ä¸ºÂ `HTML`Â ä»£ç ã€‚ä¹‹åï¼Œåˆ™æ˜¯è¯¥æ–‡ç« çš„åˆ†ç±»ã€æ ‡ç­¾é›†åˆæ•°æ®ï¼Œä»¥åŠä¸Šä¸‹ç¯‡æ–‡ç« æ•°æ®è®¾ç½®ï¼Œæœ€ç»ˆè¿”å›å‰ç«¯ã€‚

## 5. æ·»åŠ  controller æ¥å£

ä¸šåŠ¡å±‚çš„é€»è¾‘å¼€å‘å®Œæ¯•åï¼Œç¼–è¾‘Â `ArticleController`Â æ§åˆ¶å™¨ï¼Œæ·»åŠ Â `/aritcle/detail`Â æ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
@RestController
@RequestMapping("/article")
@Api(tags = "æ–‡ç« ")
public class ArticleController {

	// çœç•¥...

    @PostMapping("/detail")
    @ApiOperation(value = "è·å–æ–‡ç« è¯¦æƒ…")
    @ApiOperationLog(description = "è·å–æ–‡ç« è¯¦æƒ…")
    public Response findArticleDetail(@RequestBody FindArticleDetailReqVO findArticleDetailReqVO) {
        return articleService.findArticleDetail(findArticleDetailReqVO);
    }

}
```

## 6. æµ‹è¯•çœ‹çœ‹

é‡å¯é¡¹ç›®ï¼Œæµè§ˆå™¨è®¿é—®Â `/doc.html`Â , æµ‹è¯•ä¸€æ³¢è¯¥æ¥å£åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚å½“è¯·æ±‚ä¸€ç¯‡ä¸å­˜åœ¨çš„æ–‡ç« æ—¶ï¼Œå“åº”å‚æ•°å¦‚ä¸‹ï¼š

![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/05/9306ebdf6697e7875d43ea6463981509.png)

è¯·æ±‚è¡¨ä¸­å­˜åœ¨çš„æ–‡ç« Â `ID`Â , å“åº”å‚æ•°å¦‚ä¸‹ï¼š

![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/05/447249a0d42c94e0188e8f9de7c5a004.png)


å¯ä»¥çœ‹åˆ°ï¼Œè¿”å‚æ•°æ®éƒ½æ˜¯Â `OK`Â çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†è¡¨ä¸­å­˜å‚¨çš„Â `markdown`Â æ–‡æœ¬è½¬æ¢ä¸ºäº†Â `HTML`Â ä»£ç ã€‚