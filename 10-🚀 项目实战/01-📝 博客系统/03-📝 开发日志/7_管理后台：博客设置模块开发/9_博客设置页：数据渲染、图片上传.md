---
æ–‡ç« æ ‡é¢˜: "[[9_åšå®¢è®¾ç½®é¡µï¼šæ•°æ®æ¸²æŸ“ã€å›¾ç‰‡ä¸Šä¼ ]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« è¯¦ç»†é˜è¿°åšå®¢è®¾ç½®é¡µé¢çš„å®ç°ã€‚é¦–å…ˆï¼Œé€šè¿‡ Axios è¯·æ±‚åç«¯æ¥å£è·å–åšå®¢é…ç½®æ•°æ®å¹¶æ¸²æŸ“åˆ° Vue.js è¡¨å•ã€‚å…¶æ¬¡ï¼Œåˆ©ç”¨ Element Plus çš„ `el-upload` ç»„ä»¶ï¼Œç»“åˆ `FormData` æ‰‹åŠ¨ä¸Šä¼ å›¾ç‰‡ï¼ˆå¦‚LOGOå’Œå¤´åƒï¼‰ï¼Œå¹¶æ›´æ–°è¡¨å•æ•°æ®ï¼Œå®ç°å‰åç«¯å›¾ç‰‡ä¸Šä¼ è”è°ƒåŠŸèƒ½ã€‚
æ–‡ç« æ ‡ç­¾:
- "Vue.js"
- "Element Plus"
- "Axios"
- "å‰ç«¯å¼€å‘"
- "æ•°æ®æ¸²æŸ“"
- "æ–‡ä»¶ä¸Šä¼ "
- "APIé›†æˆ"
- "åšå®¢ç®¡ç†"
ç›¸å…³æ–‡ç« :
- "[[10_æ–‡ç« åˆ†ç±»ï¼šåˆ é™¤åŠŸèƒ½å¼€å‘]]"
- "[[8_æ–‡ç« åˆ†ç±»ï¼šåˆ†é¡µåˆ—è¡¨æ•°æ®åŠ¨æ€æ¸²æŸ“]]"
- "[[17_Ajax]]"
- "[[1_ç™»å½•é¡µè®¾è®¡ï¼šæ”¯æŒå“åº”å¼å¸ƒå±€]]"
- "[[11_AdminTagListï¼šå…³é—­å…¶ä»–ã€å…¨éƒ¨æ ‡ç­¾é¡µ]]"
æ–‡ç« åˆ†ç±»: "ğŸš€ é¡¹ç›®å®æˆ˜"
æ–‡ç« è·¯å¾„: "10-ğŸš€ é¡¹ç›®å®æˆ˜/01-ğŸ“ åšå®¢ç³»ç»Ÿ/03-ğŸ“ å¼€å‘æ—¥å¿—/7_ç®¡ç†åå°ï¼šåšå®¢è®¾ç½®æ¨¡å—å¼€å‘/9_åšå®¢è®¾ç½®é¡µï¼šæ•°æ®æ¸²æŸ“ã€å›¾ç‰‡ä¸Šä¼ .md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-05-04 21:42:17
ä¿®æ”¹æ—¶é—´: 2025-05-27 00:57:40
---


å½“æˆ‘ä»¬æ‰“å¼€åšå®¢è®¾ç½®é¡µæ—¶ï¼Œéœ€è¦è¯·æ±‚åå°è·å–è¯¦æƒ…æ¥å£ï¼Œå°†æ‹¿åˆ°çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼Œä¾›ç”¨æˆ·æŸ¥çœ‹ï¼Œä»è€Œæ–¹ä¾¿ç”¨æˆ·ä¿®æ”¹å¯¹åº”çš„è®¾ç½®ã€‚æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°±æ¥å…ˆæå®šæ­¤åŠŸèƒ½ã€‚
## 1. è¯¦æƒ…æ•°æ®æ¸²æŸ“

### 1.1 å°è£… axios è¯·æ±‚

åœ¨Â `/api/admin`Â æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªÂ `blogsettings.js`Â æ–‡ä»¶ï¼Œ ç”¨äºç»Ÿä¸€æ”¾ç½®å’Œåšå®¢è®¾ç½®åŠŸèƒ½ç›¸å…³çš„æ¥å£ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªè·å–åšå®¢è®¾ç½®è¯¦æƒ…çš„æ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
import axios from "@/axios";

// è·å–åšå®¢è®¾ç½®è¯¦æƒ…
export function getBlogSettingsDetail() {
    return axios.post("/admin/blog/settings/detail")
}
```

### 1.2 æ·»åŠ æ¸²æŸ“é¡µé¢æ•°æ®æ–¹æ³•

æ¥å£è¯·æ±‚å°è£…å¥½åï¼Œç¼–è¾‘Â `blog-settings.vue`Â æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªæ¸²æŸ“é¡µé¢æ•°æ®çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

> PS : è¿™é‡Œæˆ‘ä»¬å°†ä¹‹å‰çš„Â `blog-setting.vue`Â é¡µé¢åç§°æ”¹ä¸ºÂ `blog-settings.vue`Â , å¤šåŠ ä¸ªÂ `s`Â , ä¿æŒå‰åç«¯å‘½åä¸€è‡´ï¼ˆæœ‰ç‚¹å‘½åæ´ç™–ï¼Œå«Œéº»çƒ¦çš„å°ä¼™ä¼´å¯ä»¥å¿½ç•¥ä¸ç®¡ï¼‰ã€‚æ³¨æ„ï¼Œå…¶ä»–æ–‡ä»¶ä¸­å¼•ç”¨çš„åœ°æ–¹ï¼Œä¹Ÿéœ€è¦ä¸€ä¸€ä¿®æ”¹ï¼ŒåŒ…æ‹¬å‰ç«¯è·¯ç”±ä¹Ÿæ”¹æˆÂ `/admin/blog/settings`Â ã€‚
> 
> å› ä¸ºæ¶‰åŠçš„åœ°æ–¹æœ‰å¤šå¤„ï¼Œä½ å¯èƒ½ä¼šé—æ¼æŸä¸ªåœ°æ–¹ã€‚å¦‚æœæœ‰é”™è¯¯ï¼Œç»“åˆæµè§ˆå™¨æ§åˆ¶å°æ‰“å°çš„æ—¥å¿—ï¼Œæ¥æ’æŸ¥æ˜¯å“ªé‡Œå¿˜è®°æ”¹äº†ã€‚è°ƒè¯•çš„æ—¶å€™ï¼Œè®°å¾—æ¸…ç©ºÂ `cookie`Â ä¸­çš„Â `tabList`Â æ•°æ®ã€‚

```html
<script setup>
// çœç•¥...
import { getBlogSettingsDetail } from '@/api/admin/blogsettings'
// çœç•¥...

// åˆå§‹åŒ–åšå®¢è®¾ç½®æ•°æ®ï¼Œå¹¶æ¸²æŸ“åˆ°é¡µé¢ä¸Š
function initBlogSettings() {
	// è¯·æ±‚åå°æ¥å£
    getBlogSettingsDetail().then((e) => {
        if (e.success == true) {
            // è®¾ç½®è¡¨å•æ•°æ®
            form.name = e.data.name
            form.author = e.data.author
            form.logo = e.data.logo
            form.avatar = e.data.avatar
            form.introduction = e.data.introduction

            // ç¬¬ä¸‰æ–¹å¹³å°ä¿¡æ¯è®¾ç½®ï¼Œå…ˆåˆ¤æ–­åç«¯è¿”å›å¹³å°é“¾æ¥æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œåˆ™å°† switch ç»„ä»¶ç½®ä¸ºé€‰ä¸­çŠ¶æ€ï¼Œå¹¶è®¾ç½®è¡¨å•å¯¹åº”æ•°æ®
            if (e.data.githubHomepage) {
                isGithubChecked.value = true
                form.githubHomepage = e.data.githubHomepage
            }

            if (e.data.giteeHomepage) {
                isGiteeChecked.value = true
                form.giteeHomepage = e.data.giteeHomepage
            }

            if (e.data.zhihuHomepage) {
                isZhihuChecked.value = true
                form.zhihuHomepage = e.data.zhihuHomepage
            }

            if (e.data.csdnHomepage) {
                isCSDNChecked.value = true
                form.csdnHomepage = e.data.csdnHomepage
            }
        }
    })
}
// æ‰‹åŠ¨è°ƒç”¨ä¸€ä¸‹åˆå§‹åŒ–æ–¹æ³•
initBlogSettings()
</script>
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œé¦–å…ˆå°†å‰é¢å°è£…çš„Â `getBlogSettingsDetail`Â æ–¹æ³•å¼•å…¥äº†ï¼Œç„¶åï¼Œå®šä¹‰äº†ä¸€ä¸ªÂ `initBlogSettings()`Â åˆå§‹åŒ–åšå®¢è®¾ç½®è¯¦æƒ…çš„æ–¹æ³•ï¼Œåœ¨è¯¥æ¥å£ä¸­è¯·æ±‚äº†åå°æ¥å£ï¼Œå½“æœåŠ¡ç«¯å“å‚æˆåŠŸï¼Œåˆ™è®¾ç½®æ•°æ®åˆ°Â `form`Â å¯¹è±¡ä¸­ï¼Œæœ€ç»ˆæ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚æœ€ç»ˆæ•ˆæœå¦‚ä¸‹:

![image.png|600](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/05/89967f28c1ad7750ec9930d76685d1b0.png)

## 2. å›¾ç‰‡ä¸Šä¼ 

æ•°æ®æ¸²æŸ“çš„åŠŸèƒ½å¼€å‘å®Œæ¯•åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡ä¸Šä¼ ç»„ä»¶å’Œåå°æ–‡ä»¶ä¸Šä¼ æ¥å£ä¹Ÿè”è°ƒä¸€ä¸‹ã€‚

### 2.1 å°è£…æ–‡ä»¶ä¸Šä¼ æ¥å£

åœ¨Â `/api/admin/`Â æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªÂ `file.js`Â æ–‡ä»¶ï¼Œç”¨äºç»Ÿä¸€æ”¾ç½®å’Œæ–‡ä»¶ç›¸å…³çš„è¯·æ±‚æ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
import axios from "@/axios";

// ä¸Šä¼ æ–‡ä»¶
export function uploadFile(form) {
    return axios.post("/admin/file/upload", form)
}
```

### 2.2 åšå®¢ LOGO å›¾ç‰‡ä¸Šä¼ 

ç„¶åï¼Œç¼–è¾‘Â `blog-settings.vue`Â é¡µé¢ä¸­çš„åšå®¢ LOGOÂ `<el-upload>`Â ä¸Šä¼ ç»„ä»¶ï¼Œå°†ä¸€äº›ä¸éœ€è¦çš„äº‹ä»¶ç›‘å¬åˆ é™¤æ‰ï¼Œæ·»åŠ Â `on-change`Â ç›‘å¬æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
               // çœç•¥...
               <el-form-item label="åšå®¢ LOGO" prop="logo">
                    <el-upload class="avatar-uploader" action="#"
                        :on-change="handleLogoChange" :auto-upload="false"
                        :show-file-list="false">
                        <img v-if="form.logo" :src="form.logo" class="avatar" />
                        <el-icon v-else class="avatar-uploader-icon">
                            <Plus />
                        </el-icon>
                    </el-upload>
                </el-form-item>
                // çœç•¥...
                
<script setup>
// ä¸Šä¼  logo å›¾ç‰‡  
const handleLogoChange = (file) => {  
    // è¡¨å•å¯¹è±¡  
    let formData = new FormData()  
    // æ·»åŠ  file å­—æ®µï¼Œå¹¶å°†æ–‡ä»¶ä¼ å…¥  
    formData.append('file',file.raw)  
    uploadFile(formData).then((res)=>{  
        // å“å‚å¤±è´¥ï¼Œæç¤ºé”™è¯¯æ¶ˆæ¯  
        if (res.success === false){  
            let msg = res.msg  
            showMessage(msg,'error')  
            return  
        }  
        // æˆåŠŸåˆ™ åå°ä¸Šä¼ å›¾ç‰‡ï¼Œå¹¶è·å–å›¾ç‰‡é“¾æ¥  
        if (form.logo === res.data.url){  
            showMessage("LOGOå·²å­˜åœ¨ï¼Œè¯·å‹¿é‡å¤ä¸Šä¼ ",'warning')  
        }else{  
            form.logo = res.data.url  
            showMessage("LOGOä¸Šä¼ æˆåŠŸ",'info')  
        }    })  
}
</script>
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯¹Â `<el-upload>`Â ç»„ä»¶è®¾ç½®äº†Â `:auto-upload="false"`Â å±æ€§ï¼Œç”¨äºå°†è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½å…³é—­ã€‚å¦å¤–ï¼Œè¿˜æ·»åŠ äº†Â `on-change`Â äº‹ä»¶ç›‘å¬ï¼Œä¸»è¦ç›‘å¬æ–‡ä»¶çŠ¶æ€çš„æ”¹å˜ï¼Œå…¥å‚ä¸ºä¸Šä¼ çš„Â `file`Â æ–‡ä»¶ã€‚åœ¨å…¶å¯¹åº”çš„ç›‘å¬æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ„é€ äº†ä¸€ä¸ªÂ `FormData`Â è¡¨å•å¯¹è±¡ï¼Œå°†æ–‡ä»¶è¿½åŠ äº†è¿›å»ï¼Œè°ƒç”¨æ¥å£æ—¶ï¼Œå°†æ­¤è¡¨å•å¯¹è±¡ä½œä¸ºä¼ å…¥å¯¹è±¡ï¼Œå½“æœåŠ¡ç«¯è¿”å‚ä¸Šä¼ å¤±è´¥æ—¶ï¼Œåˆ™å¼¹å‡ºé”™è¯¯æç¤ºæ¶ˆæ¯ï¼Œå¦åˆ™å°†Â `form`Â è¡¨å•ä¸­çš„Â `logo`Â é“¾æ¥ä¿®æ”¹ä¸ºè¿”å›çš„å›¾ç‰‡åœ°å€ï¼Œå¹¶æç¤ºä¸Šä¼ æˆåŠŸã€‚

å®Œæˆä¸Šè¿°å·¥ä½œåï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€æ³¢ï¼Œçœ‹çœ‹ä¸Šä¼ æ˜¯å¦å¥½ä½¿ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169692515239221)

### 2.3 ä½œè€…å¤´åƒä¸Šä¼ 

ä¾è‘«èŠ¦ç”»ç“¢ï¼Œæˆ‘ä»¬å†æ¥æŠŠä½œè€…å¤´åƒä¸Šä¼ åŠŸèƒ½æå®šï¼Œå’Œä¸Šé¢å·®ä¸å¤šï¼Œå°±ä¸å†èµ˜è¿°äº†ã€‚ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š

```
				// çœç•¥...
				<el-form-item label="ä½œè€…å¤´åƒ" prop="avatar">
                    <el-upload class="avatar-uploader" action="#"
                    :on-change="handleAvatarChange" :auto-upload="false"
                        :show-file-list="false">
                        <img v-if="form.avatar" :src="form.avatar" class="avatar" />
                        <el-icon v-else class="avatar-uploader-icon">
                            <Plus />
                        </el-icon>
                    </el-upload>
                </el-form-item>
   				// çœç•¥...
   				
   				<script setup>
                import { uploadFile } from '@/api/admin/file'
                import { showMessage } from '@/composables/util'
                
                // çœç•¥...
                // ä¸Šä¼ ä½œè€…å¤´åƒ
                const handleAvatarChange = (file) => {
                    // è¡¨å•å¯¹è±¡
                    let formData = new FormData()
                    // æ·»åŠ  file å­—æ®µï¼Œå¹¶å°†æ–‡ä»¶ä¼ å…¥ 
                    formData.append('file', file.raw)
                    uploadFile(formData).then((e) => {
                        // å“å‚å¤±è´¥ï¼Œæç¤ºé”™è¯¯æ¶ˆæ¯
                        if (e.success == false) {
                            let message = e.message
                            showMessage(message, 'error')
                            return
                        }

                        // æˆåŠŸåˆ™è®¾ç½®ä½œè€…å¤´åƒé“¾æ¥ï¼Œå¹¶æç¤ºæˆåŠŸ
                        form.avatar = e.data.url
                        showMessage('ä¸Šä¼ æˆåŠŸ')
                    })
                }

                </script>
```
## 4. ç»“è¯­

æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å®Œæˆäº†åšå®¢è®¾ç½®é¡µé¢çš„æ•°æ®æ¸²æŸ“åŠŸèƒ½ï¼Œä»¥åŠå°†Â `<el-upload>`Â ä¸Šä¼ ç»„ä»¶å’Œåç«¯çš„æ–‡ä»¶ä¸Šä¼ æ¥å£è°ƒè¯•é€šè¿‡äº†ã€‚