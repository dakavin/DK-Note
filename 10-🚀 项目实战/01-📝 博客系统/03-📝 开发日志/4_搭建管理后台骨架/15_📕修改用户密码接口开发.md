---
æ–‡ç« æ ‡é¢˜: "[[15_ğŸ“•ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£å¼€å‘]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« è¯¦ç»†é˜è¿°äº†åŸºäºSpring Bootçš„ç”¨æˆ·å¯†ç ä¿®æ”¹åç«¯æ¥å£å¼€å‘ã€‚æ¶µç›–VOè®¾è®¡ã€Mapperã€Serviceã€Controllerå±‚å®ç°ï¼Œé›†æˆå¯†ç åŠ å¯†ã€å…¥å‚æ ¡éªŒåŠMyBatis-Plusä¼˜åŒ–æ•°æ®åº“æ“ä½œï¼Œå¹¶é€šè¿‡Knife4jè¿›è¡Œæ¥å£æµ‹è¯•ï¼Œå±•ç¤ºè§„èŒƒçš„APIå¼€å‘æµç¨‹ã€‚
æ–‡ç« æ ‡ç­¾:
- "åç«¯å¼€å‘"
- "Spring Boot"
- "REST API"
- "ç”¨æˆ·ç®¡ç†"
- "å¯†ç å®‰å…¨"
- "MyBatis-Plus"
- "APIè®¾è®¡"
- "Knife4j"
ç›¸å…³æ–‡ç« :
- "[[0_å¯¼è¯»]]"
- "[[11_ğŸ“•å…¨å±€å¼‚å¸¸å¤„ç†å™¨+å‚æ•°æ ¡éªŒï¼ˆæœ€ä½³å®è·µï¼‰]]"
- "[[12_ğŸ“•æ•´åˆ Knife4jï¼šæå‡æ¥å£è°ƒè¯•æ•ˆç‡]]"
- "[[0_å‚è€ƒæ–‡ç« ç´¢å¼•]]"
- "[[1_Javaå­¦ä¹ è·¯çº¿]]"
æ–‡ç« åˆ†ç±»: "ğŸš€ é¡¹ç›®å®æˆ˜"
æ–‡ç« è·¯å¾„: "10-ğŸš€ é¡¹ç›®å®æˆ˜/01-ğŸ“ åšå®¢ç³»ç»Ÿ/03-ğŸ“ å¼€å‘æ—¥å¿—/4_æ­å»ºç®¡ç†åå°éª¨æ¶/15_ğŸ“•ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£å¼€å‘.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­ æ ¸å¿ƒèƒ½åŠ›
åˆ›å»ºæ—¶é—´: 2024-04-25 20:56:57
ä¿®æ”¹æ—¶é—´: 2025-05-27 00:55:34
---

æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡å›åç«¯ï¼Œå°†Â `AdminHeader`Â å¤´ç»„ä»¶ä¸­ _ä¿®æ”¹å¯†ç _ å¯¹åº”çš„åå°æ¥å£å¼€å‘å¥½ã€‚

![](https://img.quanxiaoha.com/quanxiaoha/169475755047944)

## 1 æ–°å»ºä¿®æ”¹å¯†ç å…¥å‚å®ä½“ç±»

å› ä¸ºä¿®æ”¹å¯†ç å½’å±äºåå°ç®¡ç†çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£ç›¸å…³çš„ä»£ç ï¼Œä¸»è¦æ”¾åœ¨Â `weblog-module-admin`Â æ¨¡å—ä¸‹ã€‚æ–°å»ºÂ `/model/vo`Â æ¨¡å‹åŒ…ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169476033481149)

åœ¨åŒ…ä¸‹æ–°å»ºÂ `UpdateAdminUserPasswordReqVO`Â å…¥å‚å®ä½“ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

> ğŸ’¡ TIP :Â `VO`Â è¡¨ç¤ºè§†å›¾å±‚å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å‰ç«¯æäº¤è¿‡æ¥çš„æ•°æ®å¯¹è±¡ï¼›`req`Â æ˜¯Â `reqeuest`Â çš„ç¼©å†™ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¯·æ±‚ç±»ã€‚è¿™æ ·çš„çº¦æŸæœ‰åŠ©äºå¯¹å®ä½“ç±»çš„ç»´æŠ¤ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥è¯¥ç±»çš„ä½œç”¨åŸŸã€‚

```java
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@ApiModel(value = "ä¿®æ”¹ç”¨æˆ·å¯†ç  VO")
public class UpdateAdminUserPasswordReqVO {

    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @ApiModelProperty(value = "ç”¨æˆ·å")
    private String username;

    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @ApiModelProperty(value = "å¯†ç ")
    private String password;
}
```

å®ä½“ç±»ä¸­ä¸»è¦åŒ…å«äº†ï¼Œä¿®æ”¹å¯†ç éœ€è¦çš„ä¸¤ä¸ªå­—æ®µï¼Œç”¨æˆ·åå’Œå¯†ç ã€‚

> ğŸ’¡ TIP : è‹¥æç¤ºÂ `@NotBlank`Â æ³¨è§£æ‰¾ä¸åˆ°ï¼Œéœ€è¦åœ¨Â `weblog-module-admin`Â çš„Â `pom.xml`Â æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š


 ```xml
<!-- å…¥å‚æ ¡éªŒ -->
<dependency> 			
	<groupId>jakarta.validation</groupId>
	<artifactId>jakarta.validation-api</artifactId>		
</dependency>
 ```

## 2 mapper æ¥å£ä¸­æ·»åŠ ä¿®æ”¹å¯†ç æ–¹æ³•

ç¼–è¾‘Â `weblog-module-common`Â æ¨¡å—ä¸­çš„Â `UserMapper`Â æ¥å£ï¼Œæ·»åŠ Â `updatePasswordByUsername`Â é»˜è®¤æ–¹æ³•, ä»£ç å¦‚ä¸‹ï¼š

```java
/**  
 * ä¿®æ”¹ç”¨æˆ·å¯†ç   
 */  
default int updatePasswordByUsernameInt(String username,String password){  
    LambdaUpdateWrapper<UserDO> lqw = new LambdaUpdateWrapper<>();  
    // è®¾ç½®éœ€è¦æ›´æ–°çš„å­—æ®µ  
    lqw.set(UserDO::getUsername,username);  
    lqw.set(UserDO::getPassword,password);  
    // æ›´æ–°æ¡ä»¶  
    lqw.eq(UserDO::getUsername,username);  
  
    return update(null,lqw);  
}
```

æ­¤é»˜è®¤æ–¹æ³•æä¾›äº†æ ¹æ®ç”¨æˆ·åä¿®æ”¹å¯†ç çš„åŠŸèƒ½ã€‚é€šè¿‡Â `LambdaUpdateWrapper`Â é¦–å…ˆè®¾ç½®äº†æˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„å¯†ç ã€ä»¥åŠæ›´æ–°æ—¶é—´å­—æ®µå€¼ï¼Œç„¶åè®¾ç½®äº†æ ¹æ®ç»™å®šçš„ç”¨æˆ·åæ¥æ‰§è¡Œæ›´æ–°æ“ä½œã€‚

## 3 æ–°å»ºç”¨æˆ· Service

åœ¨Â `weblog-module-admin`Â æ¨¡å—ä¸­çš„Â `service`Â åŒ…é‡Œï¼Œæ–°å»ºÂ `AdminUserService`Â æ¥å£ï¼Œä»¥åŠå¯¹åº”çš„å®ç°ç±»Â `AdminUserServiceImpl`, ç”¨äºç»Ÿä¸€å¤„ç†ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡ä»£ç ï¼Œç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º :

![](https://img.quanxiaoha.com/quanxiaoha/169476007776889)

_AdminUserService_

```java
public interface AdminUserService {
    /**
     * ä¿®æ”¹å¯†ç 
     * @param updateAdminUserPasswordReqVO
     * @return
     */
    Response updatePassword(UpdateAdminUserPasswordReqVO updateAdminUserPasswordReqVO);
}
```

_AdminUserServiceImpl_

```java
@Service
public class AdminUserServiceImpl implements AdminUserService {

    @Autowired
    private UserMapper userMapper;
    @Autowired
    private PasswordEncoder passwordEncoder;

    /**
     * ä¿®æ”¹å¯†ç 
     * @param updateAdminUserPasswordReqVO
     * @return
     */
    @Override
    public Response updatePassword(UpdateAdminUserPasswordReqVO updateAdminUserPasswordReqVO) {
    	// æ‹¿åˆ°ç”¨æˆ·åã€å¯†ç 
        String username = updateAdminUserPasswordReqVO.getUsername();
        String password = updateAdminUserPasswordReqVO.getPassword();

        // åŠ å¯†å¯†ç 
        String encodePassword = passwordEncoder.encode(password);

        // æ›´æ–°åˆ°æ•°æ®åº“
        int count = userMapper.updatePasswordByUsername(username, encodePassword);

        return count == 1 ? Response.success() : Response.fail(ResponseCodeEnum.USERNAME_NOT_FOUND);
    }
}
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å­˜å‚¨å¯†ç å¹¶ä¸æ˜¯ä½¿ç”¨æ˜æ–‡è¿›è¡Œå­˜å‚¨çš„ï¼Œè€Œæ˜¯é€šè¿‡å‰é¢çš„æ•´åˆÂ `Spring Security`Â å°èŠ‚ä¸­ï¼Œåˆå§‹åŒ–çš„Â `PasswordEncoder`Â å¯†ç åŠ å¯†å™¨ï¼Œå…ˆå¯¹å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œå†æ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼Œæé«˜å¯†ç çš„å®‰å…¨æ€§ã€‚

![](https://img.quanxiaoha.com/quanxiaoha/169476208154755)

> ğŸ’¡ TIP : è¿™é‡Œæœ‰ä¸ªå°æŠ€å·§ï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢è¿™ä¸ªç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œæ›´æ–°æ“ä½œï¼›åä¹‹ï¼Œåˆ™æç¤ºè¯¥ç”¨æˆ·ä¸å­˜åœ¨ã€‚å½“ç”¨æˆ·å­˜åœ¨æ—¶ï¼Œè¿™æ ·çš„é€»è¾‘å°±ä¼šæ‰§è¡Œä¸¤æ¬¡Â `SQL`Â è¯­å¥ï¼ŒåŠ å¤§äº†æ•°æ®åº“Â `IO`Â çš„è´Ÿè½½ã€‚
> 
> æˆ‘ä»¬è¿™é‡Œä»…æ‰§è¡Œäº†ä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œé€šè¿‡è¿”å›çš„ _å½±å“çš„è®°å½•æ¡æ•°_Â å€¼è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥ç­‰äº 1, åˆ™æ›´æ–°æˆåŠŸï¼ŒåŒæ—¶æ„å‘³ç€è¯¥ç”¨æˆ·å­˜åœ¨ï¼Œå¦åˆ™ç­‰äº 0ï¼Œåˆ™è¯¥ç”¨æˆ·ä¸å­˜åœ¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ— è®ºä½•æ—¶ï¼Œä»…æ‰§è¡Œä¸€ä¸ªÂ `SQL`Â è¯­å¥ã€‚

## 4 æ·»åŠ ç”¨æˆ·ä¸å­˜åœ¨çŠ¶æ€ç 

å½“ç”¨æˆ·ä¸å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¿”å›`è¯¥ç”¨æˆ·ä¸å­˜åœ¨`Â çš„æç¤ºä¿¡æ¯ï¼Œéœ€è¦åœ¨Â `ResponseCodeEnum`Â æšä¸¾ç±»ä¸­ï¼Œæ·»åŠ Â `USERNAME_NOT_FOUND`Â æšä¸¾å€¼ï¼š

```
USERNAME_NOT_FOUND("20003", "è¯¥ç”¨æˆ·ä¸å­˜åœ¨"),
```

## 5 æ–°å»º controller æ¥å£

åœ¨Â `weblog-module-admin`Â æ¨¡å—ä¸­çš„Â `/controller`Â åŒ…ä¸‹ï¼Œæ–°å»ºÂ `AdminUserController`Â , æ·»åŠ æ›´æ–°ç”¨æˆ·å¯†ç çš„æ¥å£, ä»£ç å¦‚ä¸‹:

![](https://img.quanxiaoha.com/quanxiaoha/169476275521748)

```java
@RestController
@RequestMapping("/admin")
@Api(tags = "Admin ç”¨æˆ·æ¨¡å—")
public class AdminUserController {

    @Autowired
    private AdminUserService userService;

    @PostMapping("/password/update")
    @ApiOperation(value = "ä¿®æ”¹ç”¨æˆ·å¯†ç ")
    @ApiOperationLog(description = "ä¿®æ”¹ç”¨æˆ·å¯†ç ")
    public Response updatePassword(@RequestBody @Validated UpdateAdminUserPasswordReqVO updateAdminUserPasswordReqVO) {
        return userService.updatePassword(updateAdminUserPasswordReqVO);
    }
}
```

## 6 knife4j æ·»åŠ  Token ä»¤ç‰Œ

å®Œæˆä¸Šè¿°æ¥å£å¼€å‘åï¼Œé‡å¯é¡¹ç›®ï¼Œè®¿é—®Â `/doc.html`Â åœ°å€ã€‚å› ä¸ºåå°å¯¹æ‰€æœ‰ä»¥Â `/admin`Â ä¸ºå‰ç¼€çš„æ¥å£åšäº†ä¿æŠ¤ï¼Œæ‰€ä»¥åœ¨æµ‹è¯•ä¹‹å‰ï¼Œè¿˜éœ€è¯·æ±‚Â `/login`Â æ¥å£ï¼Œæ‹¿åˆ°Â `Token`Â ä»¤ç‰Œè®¾ç½®åˆ°è¯·æ±‚å¤´ä¸­ï¼Œæ‰èƒ½æ­£å¸¸è®¿é—®ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£ï¼Œè‹¥ä¸åŠ ï¼Œåå°ä¼šæç¤ºä½  _æ— æƒé™ï¼Œè¯·å…ˆç™»å½•_ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169483081664220)

### 6.1 å…¨å±€å‚æ•°è®¾ç½®

`knife4j`Â æä¾›äº†å…¨å±€å‚æ•°è®¾ç½®åŠŸèƒ½ã€‚è®©æˆ‘ä»¬å¯ä»¥å…¨å±€è®¾ç½®Â `Token`Â ä»¤ç‰Œï¼Œè¿™æ ·åç»­æ¯æ¬¡æ¥å£æµ‹è¯•ä¸­ï¼Œéƒ½ä¼šå¸¦ä¸Šå®ƒï¼Œæ— éœ€æ¯æ¬¡å•ç‹¬è®¾ç½®ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169483142942519)

ç‚¹å‡»Â _æ–‡æ¡£ç®¡ç† | å…¨å±€å‚æ•°è®¾ç½® | æ·»åŠ å‚æ•°_Â ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169483155677356)

å®‰è£…åç«¯ç™»å½•æ¥å£çº¦å®šçš„æ ¼å¼ï¼Œæ·»åŠ è¯·æ±‚å¤´ï¼Œå¹¶å°†é€šè¿‡è¯·æ±‚ç™»å½•æ¥å£æ‹¿åˆ°çš„Â `Token`Â ä»¤ç‰Œè®¾ç½®åˆ°å‚æ•°å€¼ä¸­ï¼Œç‚¹å‡» _ç¡®å®š_ã€‚

## 7 ä¸ƒã€æµ‹è¯•æ•ˆæœ

ä»¤ç‰Œè®¾ç½®å¥½åï¼Œæ¥æµ‹è¯•ä¸€ä¸‹ä¿®æ”¹ç”¨æˆ·å¯†ç æ˜¯å¦æ­£å¸¸ã€‚

### 7.1 æµ‹è¯•ä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œæ›´æ–°å¯†ç 

å…¥å‚ä¸­ï¼Œå¡«å†™ä¸€ä¸ªæ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œè¿›è¡Œæ›´æ–°ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œèƒ½å¤Ÿæ­£ç¡®æç¤ºé”™è¯¯æç¤ºä¿¡æ¯ï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169483181992258)

> ğŸ’¡ TIP ï¼š å…¨å±€å‚æ•°è®¾ç½®æˆåŠŸåï¼Œåœ¨è°ƒè¯•æ¥å£é¡µé¢ä¸­ï¼Œä½ ä¼šçœ‹åˆ°è¯·æ±‚å¤´éƒ¨æœ‰ä¸ªÂ _â‘ _Â æ ‡è¯†ï¼Œç‚¹å‡»å®ƒï¼Œä½ å°±ä¼šçœ‹åˆ°è®¾ç½®å¥½çš„Â `Token`Â è¯·æ±‚å¤´äº†ï¼š
> 
> ![](https://img.quanxiaoha.com/quanxiaoha/169483191953655)

### 7.2 å·²å­˜åœ¨çš„ç”¨æˆ·ï¼Œæ›´æ–°å¯†ç 

è¿™æ¬¡æµ‹è¯•æ•°æ®ä¸­å­˜åœ¨çš„ç”¨æˆ·ï¼Œçœ‹çœ‹èƒ½å¦æ›´æ–°æˆåŠŸï¼š

![](https://img.quanxiaoha.com/quanxiaoha/169483203239192)

OK , åŠŸèƒ½ä¸€åˆ‡æ­£å¸¸ã€‚åˆ°è¿™é‡Œï¼Œæ›´æ–°ç”¨æˆ·å¯†ç çš„åå°æ¥å£å°±å®Œæˆå•¦~

## 9 ç»“è¯­

æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å°†åç«¯çš„ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£å¼€å‘å¥½äº†ï¼Œä¸ºåç»­å°èŠ‚ä¸­ï¼Œå‰ç«¯èƒ½å¤Ÿç‚¹å‡»ä¿®æ”¹å¯†ç èœå•ï¼Œå¼¹å‡ºæ¨¡æ€æ¡†ï¼Œæ‰‹åŠ¨ä¿®æ”¹å¯†ç åšå¥½é“ºå«å·¥ä½œã€‚