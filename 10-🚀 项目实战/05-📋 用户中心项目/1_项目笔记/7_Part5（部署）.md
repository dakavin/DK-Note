---
æ–‡ç« æ ‡é¢˜: "[[7_Part5ï¼ˆéƒ¨ç½²ï¼‰]]"
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« è¯¦è¿°è½¯ä»¶å¤šç¯å¢ƒæ­å»ºï¼ˆæœ¬åœ°ã€å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰ï¼Œå¹¶æä¾›å‰ç«¯ä¸åç«¯å®è·µã€‚éšåä»‹ç»ä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼šä¼ ç»ŸLinuxæ‰‹åŠ¨é…ç½®ã€å®å¡”é¢æ¿ç®€åŒ–éƒ¨ç½²ã€ä»¥åŠDockerå®¹å™¨åŒ–éƒ¨ç½²ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œéƒ¨ç½²ä¾¿æ·æ€§ã€‚
æ–‡ç« æ ‡ç­¾:
  - å¤šç¯å¢ƒ
  - è½¯ä»¶éƒ¨ç½²
  - Docker
  - Nginx
  - Spring Boot
  - å®å¡”é¢æ¿
  - Linux
ç›¸å…³æ–‡ç« :
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/04-â˜ï¸ è¿ç»´éƒ¨ç½²/02-ğŸ¤– è‡ªåŠ¨åŒ–éƒ¨ç½²/1_å‰è¨€]]"
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/03-ğŸ‹ å®¹å™¨åŒ–/02-ğŸš€ Dockerè¿›é˜¶/1_SpringBooté¡¹ç›®éƒ¨ç½²ï¼ˆDockerï¼‰]]"
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/04-â˜ï¸ è¿ç»´éƒ¨ç½²/02-ğŸ¤– è‡ªåŠ¨åŒ–éƒ¨ç½²/3_å§¿åŠ¿2ï¼šDockeréƒ¨ç½²é¡¹ç›®]]"
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/03-ğŸ‹ å®¹å™¨åŒ–/01-ğŸ“š DockeråŸºç¡€/3_ç¯å¢ƒå®‰è£…/4_Ubuntu å®‰è£… Docker]]"
  - "[[../../../08-ğŸ› ï¸ å¼€å‘å·¥å…·/04-â˜ï¸ è¿ç»´éƒ¨ç½²/02-ğŸ¤– è‡ªåŠ¨åŒ–éƒ¨ç½²/10_è¡¥å……ï¼šJetBrainså…¨å®¶æ¡¶é›†æˆæœåŠ¡å™¨ä¸Šçš„DockeræœåŠ¡]]"
æ–‡ç« åˆ†ç±»: ğŸš€ é¡¹ç›®å®æˆ˜
æ–‡ç« è·¯å¾„: 10-ğŸš€ é¡¹ç›®å®æˆ˜/05-ğŸ“‹ ç”¨æˆ·ä¸­å¿ƒé¡¹ç›®/1_é¡¹ç›®ç¬”è®°/7_Part5ï¼ˆéƒ¨ç½²ï¼‰.md
æ–‡ç« éš¾åº¦: ä¸­çº§ ğŸŒ³
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­â­ ç²¾é€šå¿…å¤‡
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2024-08-11 18:15:12
---

## 1 å¤šç¯å¢ƒ

[å¤šç¯å¢ƒå‚è€ƒæ–‡ç« ï¼šåŸæ–‡é“¾æ¥](https://blog.csdn.net/weixin_41701290/article/details/120173283)
### 1.1 æ¦‚è¿°


**ä¸ºä»€ä¹ˆ**ï¼š
- æ¯ä¸ªç¯å¢ƒäº’ä¸å½±å“
- åŒºåˆ†ä¸åŒé˜¶æ®µï¼šæœ¬åœ° / å¼€å‘ / æµ‹è¯• /  é¢„å‘å¸ƒ / æ­£å¼ä¸Šçº¿ / æ²™ç®±ï¼ˆå®éªŒï¼‰
- å¯¹é¡¹ç›®è¿›è¡Œä¼˜åŒ–ï¼š
	- æœ¬åœ°æ—¥å¿—çº§åˆ«
	- ç²¾ç®€ä¾èµ–ï¼ŒèŠ‚çœé¡¹ç›®ä½“ç§¯
	- é¡¹ç›®çš„ç¯å¢ƒ æˆ– å‚æ•°è°ƒæ•´ï¼Œæ¯”å¦‚JVMå‚æ•°
---

**æ¦‚å¿µ**ï¼š
- æ ¹æ®å®é™…éœ€è¦ï¼Œå°†åŒä¸€ä¸ªé¡¹ç›®ï¼ˆä»£ç ï¼‰æŒ‰ç…§ä¸€å®šæ–¹æ³•è¿›è¡ŒåŒºåˆ†ï¼Œå¹¶å°†æ‰€éœ€èµ„æºå’Œé¡¹ç›®æœ¬èº«éƒ¨ç½²åˆ°ä¸åŒçš„æœºå™¨ä¸Šã€‚**ä¸åŒç¯å¢ƒçš„é¡¹ç›®å¯ä»¥æœ‰ä¸åŒçš„è¡Œä¸º**ï¼Œä¸”èƒ½å¤Ÿ **åŒæ—¶å­˜åœ¨ã€äº’ä¸å½±å“**
- æ¢ä¸ªè¯´æ³•ï¼šåŒä¸€ä¸ªé¡¹ç›®ï¼ˆä»£ç ï¼‰åœ¨ä¸åŒçš„é˜¶æ®µéœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥è°ƒæ•´é…ç½®å¹¶ä¸”éƒ¨ç½²åˆ°ä¸åŒçš„æœºå™¨ä¸Šã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/2e6c3a70a932e111b8e5cc3a8cc03136.png)

è¿™æ ·ä¸€æ¥ï¼Œæœ¬åœ°å’Œçº¿ä¸Šçš„é¡¹ç›®å°±å®Œå…¨éš”ç¦»å¼€äº†ï¼Œå¼€å‘è€…åœ¨æœ¬åœ°æƒ³æ€ä¹ˆæŠ˜è…¾å°±æ€ä¹ˆæŠ˜è…¾ï¼è¿™ä¾¿æ˜¯å¤šç¯å¢ƒçš„å¥½å¤„ã€‚

### 1.2 å¸¸ç”¨ç¯å¢ƒ

å¤šç¯å¢ƒå¬èµ·æ¥è™½ç„¶æŒºçˆ½çš„ï¼Œä½†äº‹å®ä¸Šï¼Œç¯å¢ƒä¸æ˜¯åŒºåˆ†çš„è¶Šå¤šè¶Šå¥½ï¼

ä¸€æ–¹é¢æ˜¯æ­å»ºå¤šç¯å¢ƒéœ€è¦é¢å¤–çš„å·¥ä½œé‡ï¼›å¦ä¸€æ–¹é¢æ˜¯é¡¹ç›®ä¾èµ–çš„èµ„æºè¶Šå¤šï¼Œæˆæœ¬å°±è¶Šé«˜ï¼Œè€Œä¸”ç»´æŠ¤èµ·æ¥ä¹Ÿæ›´éº»çƒ¦ã€‚

å› æ­¤ï¼Œä¼ä¸šä¸­å¸¸ç”¨çš„ç¯å¢ƒä¹Ÿå°±é‚£ä¹ˆå‡ ç§ï¼Œéƒ½å¿«æˆä¸ºä¸€ç§çº¦å®šä¿—æˆçš„è§„èŒƒäº†ï¼Œä¸‹é¢ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ã€‚

> ä¸åŒå›¢é˜ŸåŒºåˆ†ç¯å¢ƒçš„æ–¹å¼å¯èƒ½ä¸åŒï¼Œä»…ä¾›å‚è€ƒã€‚

---

**æœ¬åœ°ç¯å¢ƒ**
- ä¸€èˆ¬ç”¨Â `local`Â æ ‡è¯†ï¼Œæ˜¯æŒ‡å‰ç«¯æˆ–åç«¯ç‹¬ç«‹å¼€å‘ã€è‡ªä¸»æµ‹è¯•çš„ç¯å¢ƒã€‚é€šå¸¸å°±æ˜¯è®©é¡¹ç›®å’Œä¾èµ–åœ¨æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘ä¸Šè¿è¡Œï¼Œæ¯”å¦‚æ•°æ®åº“ã€ç¼“å­˜ã€é˜Ÿåˆ—ç­‰å„ç§æœåŠ¡ï¼Œå¯èƒ½éœ€è¦è‡ªå·±åœ¨æœ¬åœ°æ­å»ºã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/1a528c5c08eaa027db51d0367aac5098.png)
---

**å¼€å‘ç¯å¢ƒ**
- ä¸€èˆ¬ç”¨ `dev` æ ‡è¯†ï¼Œæ˜¯æŒ‡å‰ç«¯å’Œåç«¯ï¼ˆæˆ–è€…å¤šä¸ªç¨‹åºå‘˜ï¼‰ä¸€èµ·åä½œå¼€å‘ã€è”è°ƒçš„ç¯å¢ƒã€‚é€šå¸¸å°†é¡¹ç›®å’Œä¾èµ–æ”¾åœ¨å‘˜å·¥ç”µè„‘å¯ä»¥ç›´æ¥è®¿é—®çš„å¼€å‘æœºä¸Šï¼Œä¸ç”¨è‡ªå·±æ­å»ºï¼Œç›´æ¥è·‘èµ·æ¥é¡¹ç›®ï¼Œæé«˜å¼€å‘å’Œåä½œæ•ˆç‡ã€‚
- å¯¹è§„æ¨¡ä¸å¤§çš„å›¢é˜Ÿæ¥è¯´ï¼Œå¼€å‘å’Œæœ¬åœ°ç¯å¢ƒå…¶å®æœ‰ä¸€å¥—å°±å¤Ÿäº†ï¼Œæ¯•ç«Ÿæœ¬åœ°ä¹Ÿå¯ä»¥è¿æ¥å…¬ç”¨çš„æ•°æ®åº“ç­‰æœåŠ¡ã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/37682fa5a1f0369ed1bc480989df85f1.png)
---

**æµ‹è¯•ç¯å¢ƒ**
- ä¸€èˆ¬ç”¨Â `test`Â æ ‡è¯†ï¼Œæ˜¯æŒ‡å‰ç«¯å’Œåç«¯å¼€å‘å’Œè”è°ƒå®Œæˆï¼Œåšå‡ºå®Œæ•´çš„æ–°åŠŸèƒ½åï¼Œäº¤ç»™æµ‹è¯•åŒå­¦å»æ‰¾ Bug çš„ç¯å¢ƒã€‚
- é€šå¸¸åœ¨æµ‹è¯•ç¯å¢ƒéœ€è¦æœ‰==ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®åº“å’Œå…¶ä»–æœåŠ¡==ï¼Œè®©æµ‹è¯•åŒå­¦å¤§æ˜¾èº«æ‰‹ã€‚æ¯æ¬¡ä¿®æ”¹å®Œ Bug åï¼Œä¹Ÿéƒ½è¦å†æ¬¡å‘å¸ƒé¡¹ç›®åˆ°æµ‹è¯•ç¯å¢ƒï¼Œè®©æµ‹è¯•åŒå­¦é‡æ–°éªŒè¯ã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/8f59184120cfa87d4c31366e50279bf7.png)
---

**é¢„å‘å¸ƒç¯å¢ƒï¼ˆä½“éªŒæœï¼‰**
- ä¸€èˆ¬ç”¨Â `pre`Â æ ‡è¯†ï¼Œè¿™æ˜¯==å’Œçº¿ä¸Šé¡¹ç›®æœ€æ¥è¿‘çš„ç¯å¢ƒ==ï¼Œä¸€èˆ¬æ˜¯æµ‹è¯•éªŒè¯é€šè¿‡ã€äº§å“ç»ç†ä½“éªŒè¿‡åï¼Œæ‰èƒ½å°†é¡¹ç›®å‘å¸ƒåˆ°è¿™ä¸ªç¯å¢ƒã€‚
- å®é™…ä¸Šï¼Œé¢„å‘å¸ƒç¯å¢ƒçš„é¡¹ç›®è°ƒç”¨çš„åç«¯æ¥å£ã€è¿æ¥çš„æ•°æ®åº“ã€æœåŠ¡ç­‰éƒ½Â ==å’Œçº¿ä¸Šé¡¹ç›®ä¸€è‡´==Â ï¼Œå’Œçº¿ä¸Š==å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å‰ç«¯è®¿é—®çš„åŸŸåä¸åŒ==ã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/81b110d567185da08df59c55365b8b7a.png)
---

**ç”Ÿäº§/çº¿ä¸Šç¯å¢ƒ**
- ä¸€èˆ¬ç”¨Â `prod`Â æ ‡è¯†ï¼Œåˆå«çº¿ä¸Šç¯å¢ƒï¼Œæ˜¯ç»™æ‰€æœ‰çœŸå®ç”¨æˆ·ä½¿ç”¨çš„ç¯å¢ƒã€‚
- å› æ­¤ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œä¸”å‘å¸ƒé¡¹ç›®åˆ°è¯¥ç¯å¢ƒæ—¶å¿…é¡»æ ¼å¤–å°å¿ƒã€‚çº¿ä¸Šçš„æ•°æ®åº“ã€æœºå™¨ç­‰èµ„æºä¸€èˆ¬ä¹Ÿæ˜¯ç”±ä¸“ä¸šçš„è¿ç»´æ¥è´Ÿè´£ï¼Œæƒ³è¦ç™»å½•æœºå™¨ã€ä¿®æ”¹é…ç½®ï¼Œéƒ½éœ€è¦ç»è¿‡ä¸¥æ ¼å®¡æ‰¹ã€‚
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/672c9a585cb4716ea467523ce11c90db.png)
---

**æ²™ç®±ç¯å¢ƒï¼ˆå®éªŒç¯å¢ƒï¼‰**
- ä¸ºäº†æŸä¸ªåŠŸèƒ½è¿›è¡Œå®éªŒçš„ç¯å¢ƒ
### 1.3 å¦‚ä½•å®ç°ï¼Ÿ

å¤šç¯å¢ƒçš„å®ç°æ–¹å¼ï¼Œå…¶å®å¤§åŒå°å¼‚ï¼Œéµå¾ª 3 ä¸ªæ­¥éª¤ï¼šæŠ½è±¡é…ç½®ç±» + é…ç½®æ–‡ä»¶åŒ– + æ³¨å…¥ç¯å¢ƒå‚æ•°ï¼Œå°±èƒ½è½»æ¾å®ç°~

---

**æŠ½è±¡é…ç½®ç±»**
- å°†é¡¹ç›®ä»£ç ä¸­==éœ€è¦æ ¹æ®ç¯å¢ƒçš„å˜åŒ–è€Œæ›´æ”¹çš„å˜é‡==æ•´ç†åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®ç±»ä¸­ï¼Œé›†ä¸­ç®¡ç†ã€‚
- ä¾‹å¦‚ï¼šè¿æ¥æ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ•°æ®åº“ IPã€ç«¯å£ã€é…ç½®ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†==è¿™äº›å˜é‡æ”¾å…¥åˆ°ä¸€ä¸ªç±»ä¸­==ï¼Œç„¶åä»è¿™ä¸ªç±»è¯»å–å˜é‡çš„å€¼
- è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¦‚æœä»£ç ä¸­è¿˜æœ‰å…¶ä»–åœ°æ–¹ç”¨åˆ°äº†è¿™äº›å˜é‡ï¼Œä¹Ÿéƒ½å¯ä»¥ä»åŒä¸€ä¸ªç±»å»è·å–ï¼Œè€Œä¸æ˜¯æŠŠÂ ==æ­»å€¼==Â é‡å¤å†™å¤šæ¬¡ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚

---

**é…ç½®æ–‡ä»¶åŒ–**
- å¯ä»¥==ç”¨ä¸“é—¨çš„é…ç½®æ–‡ä»¶æ¥ç»´æŠ¤é…ç½®==ï¼Œä»è€Œè®©ç”¨æˆ·ä¿®æ”¹é…ç½®æ›´æ–¹ä¾¿ï¼Œä¸ç”¨å†å»æ‰¾ä»£ç ã€æ”¹ä»£ç 
- å¸¸è§çš„é…ç½®æ–‡ä»¶æ ¼å¼æœ‰Â `properties`ã€`yaml`ã€`yml`ã€`json`Â ç­‰ï¼Œæ¯”å¦‚æ–°å»ºä¸€ä¸ªæ•°æ®åº“é…ç½®æ–‡ä»¶Â `db.properties`
- æ¥ä¸‹æ¥åœ¨åˆå§‹åŒ–æ•°æ®åº“æ—¶ï¼Œå°±å¯ä»¥==å°†é…ç½®æ–‡ä»¶ä¸­çš„å€¼åŠ è½½åˆ°ä¸Šä¸€æ­¥å†™å¥½çš„é…ç½®ç±»==ä¸­ï¼Œç„¶åè¯»å–
- ==åªä¸è¿‡æ˜¯æŠŠé…ç½®çš„å€¼ä»ä»£ç ä¸­ç§»åˆ°äº†æ–‡ä»¶ä¸­è€Œå·²~==
- æ— è®ºæ˜¯å‰ç«¯è¿˜æ˜¯åç«¯ï¼Œå¤§éƒ¨åˆ†çš„å¤šç¯å¢ƒå®ç°éƒ½æ˜¯è¿™ä¸ªåŸç† â€”â€” æå¤šå¥—é…ç½®ï¼Œæ‰€ä»¥æ€»èƒ½åœ¨é¡¹ç›®ä¸­çœ‹åˆ°ç±»ä¼¼çš„é…ç½®æ–‡ä»¶
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/aa0e3fae639ce18dc08463e6008f1b11.png)
---

**æ³¨å…¥ç¯å¢ƒå‚æ•°**
- åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…¶å®æˆ‘ä»¬è¿˜æ˜¯åœ¨ä»£ç ä¸­å†™äº†Â ==æ­»å€¼==Â ï¼Œæ¥å‘Šè¯‰ç¨‹åºåº”è¯¥åŠ è½½å“ªä¸ªåç§°çš„é…ç½®æ–‡ä»¶
- æ¯”å¦‚åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼ŒåŠ è½½Â `db-dev.properties`Â ï¼Œå¼€å‘å®Œæˆåã€æ­£å¼ä¸Šçº¿å‰ï¼Œå†æ”¹ä»£ç ä¸ºåŠ è½½Â `db-prod.properties` â¡æ ·ä¸ä»…éº»çƒ¦ï¼Œè€Œä¸”å¯èƒ½å¿˜äº†ä¿®æ”¹ï¼ŒæŠŠå¼€å‘ç¯å¢ƒçš„é¡¹ç›®å‘å¸ƒåˆ°äº†çº¿ä¸Š
- æœ€ç†æƒ³çš„æ•ˆæœåº”è¯¥æ˜¯ï¼šæ— è®ºé¡¹ç›®è¦åˆ‡æ¢åˆ°å“ªä¸ªç¯å¢ƒï¼Œæ•´ä¸ªé¡¹ç›®éƒ½å®Œå…¨ä¸ç”¨ä¿®æ”¹
- å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥==å°†Â æŒ‡å®šç¯å¢ƒÂ è¿™ä»¶äº‹æ”¾åˆ°æœ€å==ï¼Œåœ¨==é€šè¿‡å‘½ä»¤å»æ‰“åŒ…æˆ–è€…å¯åŠ¨é¡¹ç›®æ—¶ï¼Œå°†ç¯å¢ƒå‚æ•°å†™è¿›å»==

- ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨ java é¡¹ç›®æ—¶ï¼Œç»™Â `env`Â ç³»ç»Ÿå˜é‡ä¼ é€’ä¸åŒå‚æ•°ï¼š
```shell
# æµ‹è¯•ç¯å¢ƒ
java -jar -Denv=test dist.jar
# ç”Ÿäº§ç¯å¢ƒ
java -jar -Dend=prod dist.jar
```

- ç„¶ååœ¨ç¨‹åºä¸­è¯»å–è¯¥å‚æ•°ï¼ŒåŠ è½½å¯¹åº”çš„é…ç½®å³å¯ï¼š
```java
// è¯»å– env å‚æ•°
String env = System.getProperty("env");
new DBConfig("db-" + env + ".properties");
```

- åŒç†ï¼Œå¯¹äºå‰ç«¯é¡¹ç›®ï¼Œå¯ä»¥åœ¨æ‰“åŒ…æ„å»ºæ—¶ä¼ å…¥ç¯å¢ƒå˜é‡ï¼Œç„¶åè‡ªå·±åœ¨ä»£ç ä¸­è¯»å–ï¼Œæˆ–è€…äº¤ç»™ Webpack ä¹‹ç±»çš„æ‰“åŒ…å·¥å…·å¤„ç†ï¼š
```json
{  "scripts": 
	{    
		"serve": "env=dev serve",    
		"build:test": "env=test build"    "build": "env=prod build"  
	} 
}
```

### 1.4 å‰ç«¯å¤šç¯å¢ƒå®æˆ˜

é¦–å…ˆï¼Œæˆ‘ä»¬å¯åŠ¨å‰ç«¯é¡¹ç›®ï¼Œè¿›å…¥ç™»å½•é¡µé¢ï¼Œéšä¾¿è¾“å…¥è´¦æˆ·å¯†ç ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚çš„åœ°å€æ˜¯`localhost:8000`
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/cf27d92edde96cd87fa3bd735df9c02e.png)

ä¹‹åè¦æŠŠæ•´ä¸ªæœåŠ¡ä¸Šçº¿ï¼Œé‚£æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘ï¼Œè‚¯å®šä¸èƒ½24hå¼€ç€ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°å€è‚¯å®šè¦æ”¹ä¸€ä¸‹ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ

---

**é—®é¢˜ï¼šæ€ä¹ˆè®©å‰ç«¯çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è¯·æ±‚localhostï¼Œä»€ä¹ˆæ—¶å€™è¯¥è¯·æ±‚è¿œç¨‹åœ°å€å‘¢ï¼Ÿ**

**ç­”æ¡ˆï¼š** å¯ä»¥åœ¨å¯åŠ¨é¡¹ç›®ï¼ˆæˆ–æ„å»ºé¡¹ç›®ï¼‰çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªç¯å¢ƒå˜é‡ç»™å®ƒå†™è¿›å»ï¼Œé€šè¿‡ä¼ å…¥ä¸€ä¸ªå˜é‡æ¥åŒºåˆ†ç¯å¢ƒ

---

**é—®é¢˜ï¼šæ€ä¹ˆæŠŠè¿™ä¸ªé…ç½®ä¼ è¾“ä¼ è¿›å»å‘¢ï¼Ÿ**

**åˆ†æï¼š**
- æˆ‘ä»¬å¯åŠ¨é¡¹ç›®çš„æ—¶å€™ï¼Œæ˜¯åœ¨package.jsonæ–‡ä»¶é‡Œå¯åŠ¨çš„ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€ç³»åˆ—çš„å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨æ‰§è¡Œè¿™äº›å‘½ä»¤çš„æ—¶å€™ç»™è¿™ä¸ªå‰ç«¯é¡¹ç›®ä¼ é€’ä¸€äº›å‚æ•°ï¼
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0335406bc9aab6902f016600fbfc5753.png)

- ï¼ˆumiæ¡†æ¶ç‰¹æ€§ï¼‰é¡¹ç›®ä½¿ç”¨çš„æ˜¯umiæ¡†æ¶ï¼Œbuildçš„æ—¶å€™ä¼šè‡ªåŠ¨ä¼ å…¥ NODE_ENV == production å‚æ•°ï¼Œstartçš„æ—¶å€™ NODE_ENV == development
- é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥çœ‹çœ‹çœ‹å…¨å±€æ–‡ä»¶ï¼Œapp.tsxæ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸€ä¸ª process.env.NODE_ENVï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œå‰ç«¯é¡¹ç›®å°±æ˜¯æ‹¿åˆ°è¿™ä¸ªå‚æ•°ï¼ˆdevelopmentï¼‰å»æ‰“åŒ…çš„
	- å¯ä»¥åœ¨ä¸‹é¢åŠ ä¸€ä¸ª`alert(process.env.NODE_ENV)`æ¥éªŒè¯ä¸€ä¸‹
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/d3490c617b1aa0bedcd4f75e4a39be76.png)
- æˆ‘ä»¬ç°åœ¨buildä¸€ä¸‹ï¼Œä¼šå‘ç°é¡¹ç›®å·²ç»ç¼–è¯‘å‡ºæ¥ä¸€ä¸ªdistç›®å½•ï¼Œè¿™å°±æ˜¯buildå‡ºæ¥çš„ç›®å½•ï¼ˆå³å°†æˆ‘ä»¬æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…å‡ºæ¥çš„ä¸€ä¸ªç›®å½•ï¼‰
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/088b21faf78461f3401478a846739265.png)

	- **æ³¨æ„**ï¼šå¦‚æœnodejsç‰ˆæœ¬å¾ˆé«˜çš„è¯ï¼Œéœ€è¦åœ¨buildå‰é¢åŠ ä¸Š`set NODE_OPTIONS=--openssl-legacy-provider &&`

- é‚£æˆ‘ä»¬è¯•ä¸€ä¸‹è¿è¡Œè¿™ä¸ªdistæ–‡ä»¶å¤¹å§ï¼
	- å…ˆå…¨å±€å®‰è£… serveæ’ä»¶ `npm i -g serve`ï¼Œæ— æ‰€è°“ä½¿ç”¨å“ªé‡Œçš„å‘½ä»¤è¡Œ
	- æ³¨æ„ï¼šå®‰è£…å®Œæˆåä½¿ç”¨`serve -v` æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ
	  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/f9194b6bce666eb5986541b61bc40374.png)
	- è¿›å…¥distç›®å½•ï¼Œä½¿ç”¨`serve`æŒ‡ä»¤ï¼Œè¿è¡Œè¿™ä¸ªç›®å½•ä¸‹çš„ç¨‹åºï¼Œå‘ç°å¯åŠ¨æˆåŠŸ
	  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/b8c3abe3200bbd3e0d8bf50845d0c3b9.png)
	- æ„æ€æ˜¯åœ¨æœ¬åœ°ç»™ä½ å¯åŠ¨äº†ä¸€ä¸ªå¤–éƒ¨æœåŠ¡å™¨ï¼Œå¯ä»¥åœ¨æœ¬åœ°æŠŠè¿™ä¸ªå‰ç«¯é¡¹ç›®ï¼Œæ”¾åˆ°è¿™ä¸ªå¤–éƒ¨æœåŠ¡å™¨ä¸Š
	- ç”¨serve å¯åŠ¨ç›¸å½“äºæˆ‘ä»¬åœ¨è‡ªå·±çš„ç”µè„‘è¿è¡Œäº†è¿™ä¸ªæ­£å¼ç¯å¢ƒï¼Œç°åœ¨è‡ªå·±çš„ç”µè„‘å°±æ˜¯è¿™ä¸ªå‰ç«¯é¡¹ç›®çš„æœåŠ¡å™¨ï¼Œåªä¸è¿‡åˆ«äººè®¿é—®ä¸äº†
	- è¿›å…¥è¿™ä¸ªç½‘ç«™ï¼Œå‘ç°å¼¹å‡ºæ¥çš„æ˜¯production è€Œä¸æ˜¯ developmentï¼Œè¯´æ˜æˆ‘ä»¬ç”¨buildå‘½ä»¤çš„æ—¶å€™ï¼Œumiæ¡†æ¶å·²ç»å¸®æˆ‘ä»¬æŠŠNODE_ENVä¿®æ”¹ä¸ºproduction
	  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/67436876aa0790264a64451142119761.png)
- æ ¹æ®ä¸Šé¢çš„ç†è®ºï¼Œæˆ‘ä»¬ç°åœ¨è¦æ±‚çº¿ä¸Šçš„å‰ç«¯è¦è¯·æ±‚åˆ°çº¿ä¸Šçš„åç«¯ï¼Œæˆ‘ä»¬ä¿®æ”¹å…¨å±€è¯·æ±‚ç±»`globalRequest.ts`ä¸­umiè¯·æ±‚åº“ï¼ˆrequestï¼‰çš„prefixï¼Œä»£ç å¦‚ä¸‹å›¾
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/638fc2e6973edff5815a5ac6f1dade8a.png)
	- prefixå°±æ˜¯æˆ‘ä»¬æ¯æ¬¡è¯·æ±‚çš„å‰ç¼€ï¼Œé€šè¿‡å‰ç¼€å¯ä»¥æ”¹å˜æ¯æ¬¡è¯·æ±‚urlå‰é¢çš„éƒ¨åˆ†ï¼ˆåŸŸå+ç«¯å£ç­‰ï¼‰
	- é‡æ–°buildå‘½ä»¤æ‰“åŒ…ä¸€ä¸‹ï¼Œç„¶åserveè¿è¡Œä¸€ä¸‹distæ–‡ä»¶ï¼Œç„¶åæ‰“å¼€é¡µé¢è¿›è¡Œç™»å½•ï¼Œå‘ç°æ¥å…¥çš„åŸŸåå‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚ä¸‹å›¾
	  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/b6bc0831b3befae6302649da71d007c1.png)
	- ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡äº†ä¸€ä¸ªç¯å¢ƒå˜é‡å°±æˆåŠŸåŒºåˆ†å‡ºäº†æœ¬åœ°ä»¥åŠçº¿ä¸Šé¡¹ç›®ï¼Œå¦‚æœè¦åŠ å…¥æµ‹è¯•ç¯å¢ƒï¼Œå°±å¦‚æ³•ç‚®åˆ¶

---

ä¸Šé¢æˆ‘ä»¬å°†äº†å¯åŠ¨æ–¹å¼ï¼ˆdev / build-serveï¼‰å’Œ è¯·æ±‚åœ°å€çš„ä¿®æ”¹ï¼Œä½†æ˜¯å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒè¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œæ¯”å¦‚è¯´é¡¹ç›®çš„é…ç½®

**é¡¹ç›®çš„é…ç½®**
- ä¸åŒçš„é¡¹ç›®ï¼ˆæ¡†æ¶ï¼‰éƒ½æœ‰ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œumiçš„é…ç½®æ–‡ä»¶æ˜¯configï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶åæ·»åŠ å¯¹åº”çš„ç¯å¢ƒåç§°åç¼€æ¥åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒ
- ä¾‹å¦‚ï¼š[å‚è€ƒæ–‡æ¡£](https://umijs.org/docs/guides/env-variables)
	- å¼€å‘ç¯å¢ƒï¼šconfig.dev.ts
	- çº¿ä¸Šç¯å¢ƒï¼šconfig.prod.ts
	- å…¬å…±ç¯å¢ƒï¼šconfig.tsï¼ˆæ‰€æœ‰ç¯å¢ƒéƒ½é€‚ç”¨çš„é…ç½®ï¼‰

æˆ‘ä»¬ç°åœ¨æœ¬åœ°ä¸Šè¿è¡Œçš„è¿™äº›ä»£ç ï¼Œæ²¡æœ‰åšä¸€äº›å‹ç¼©ï¼ŒåŠ å¯†æ··æ·†çš„å·¥ä½œ
å› ä¸ºåœ¨æœ¬åœ°è¿è¡Œæˆ‘ä»¬ä¸å¤ªéœ€è¦è€ƒè™‘æ€§èƒ½ï¼Œä½†æ˜¯å‘å¸ƒåˆ°çº¿ä¸Šçš„æ—¶å€™ï¼Œå¯èƒ½è¦å¯¹ç½‘ç«™åšä¸€äº›æŒ‰éœ€åŠ è½½ï¼Œæˆ–è€…é™æ€åŒ–

### 1.5 åç«¯å¤šç¯å¢ƒå®æˆ˜

æƒ³ä¸€ä¸‹æˆ‘ä»¬åç«¯åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯æä¾›äº†ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥ã€ç™»å½•æ³¨å†Œã€‚

é‚£æˆ‘ä»¬ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥çš„æ•°æ®å­˜åœ¨æœ¬åœ°çš„mysqlæ•°æ®åº“ï¼Œä¸Šçº¿çš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯è¦æŠŠè¿™ä¸ªæ•°æ®åº“åœ°å€æ”¹æˆä¸€ä¸ªè¿œç¨‹åœ°å€ï¼Œèµ·ç è¦å…¬ç½‘å¯ä»¥è®¿é—®ï¼Œæˆ–è€…è¯´è‡ªå·±çš„å‰åç«¯é¡¹ç›®éƒ¨ç½²çš„é‚£ä¸ªæœåŠ¡å™¨å¯ä»¥è®¿é—®

æ‰€ä»¥ï¼Œ**åç«¯å¤šç¯å¢ƒä¸»è¦ä¿®æ”¹çš„æ˜¯**ï¼š
- ä¾èµ–çš„ç¯å¢ƒåœ°å€
	- æ•°æ®åº“åœ°å€
	- ç¼“å­˜åœ°å€
	- æ¶ˆæ¯é˜Ÿåˆ—åœ°å€
	- é¡¹ç›®ç«¯å£å·
- æœåŠ¡å™¨é…ç½®

---

**åç«¯æ€ä¹ˆå»åŒºåˆ†ä¸åŒçš„ç¯å¢ƒ?**

å’Œå‰ç«¯ä¸€æ ·ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„é¡¹ç›®éƒ½æ˜¯è¿™ç§æ¨¡å¼ï¼š**é€šè¿‡é…ç½®æ–‡ä»¶åé¢åŠ ä¸€ä¸ªåç¼€æ¥åŒºåˆ†ç¯å¢ƒ**

æˆ‘ä»¬é¡¹ç›®æ˜¯Springbootæ¡†æ¶çš„ï¼Œæ‰€ä»¥é…ç½®æ–‡ä»¶å°±æ˜¯`applicaiton.ymlæ–‡ä»¶`
- è¿™ä¸ªæ–‡ä»¶æ˜¯==å…¬å…±çš„é…ç½®==ï¼Œå…¬å…±é…ç½®å°±æ˜¯==ä»»ä½•ç¯å¢ƒéƒ½ä¼šåŠ è½½è¿™ä¸ªé…ç½®==ï¼Œæ‰€ä»¥åƒä¸€äº›MPè¿™ç§æ¡†æ¶å±‚é¢çš„é…ç½®å°±å†™åœ¨è¿™é‡Œå°±å¥½äº†

é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å¤åˆ¶è¿™ä¸ªæ–‡ä»¶ï¼Œå†åˆ›å»ºä¸€ä¸ª`application-prod.ymlæ–‡ä»¶`
- è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ï¼Œç”¨äº==ç”Ÿäº§ç¯å¢ƒçš„é…ç½®==ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ é™¤æ‰ä¸€äº›å…¬å…±çš„é…ç½®ï¼Œå¦‚ä¸‹å›¾
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/12e2069ec04ffbb3c08c0da4726bc7dd.png)
> æç¤ºï¼šæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬åˆ›å»ºçš„userè¡¨çš„sqlæ–‡ä»¶ä¿å­˜åœ¨é¡¹ç›®çš„sqlç›®å½•ä¸‹ï¼Œ==åæœŸæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªåˆ›å»ºè¡¨çš„sqlè¯­å¥ï¼Œæ”¾åœ¨æœåŠ¡å™¨ä¸Šçš„mysqlæ‰§è¡Œäº†==
> ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/1e070c8c49cea650bc710013bf170a74.png)

---

**ä¿®æ”¹application-prod.ymlä¸­æ•°æ®åº“çš„é…ç½®**

å‰æï¼š
- æœ‰ä¸€ä¸ªäº‘ç«¯çš„æ•°æ®åº“
- æˆ–è€…ï¼Œè‡ªå·±çš„æœåŠ¡å™¨ä¸Šå·²ç»å®‰è£…äº†mysqlæ•°æ®åº“ï¼Œå¹¶ä¸”æ­£å¸¸å¯åŠ¨
- æ²¡æœ‰çš„è¯ï¼Œå…ˆçœ‹åé¢[2 é¡¹ç›®çš„éƒ¨ç½²ä¸Šçº¿](#2%20é¡¹ç›®çš„éƒ¨ç½²ä¸Šçº¿)  ä»¥åŠ [2.5 æœåŠ¡å™¨å®‰è£…](../../../06-ğŸ§%20Linuxç³»ç»Ÿ/02-âš™ï¸%20ç³»ç»ŸåŸºç¡€/01-ğŸ’»%20å‘½ä»¤è¡Œæ“ä½œ/7_Linuxç³»ç»Ÿè½¯ä»¶å®‰è£…-1.md#2.5%20æœåŠ¡å™¨å®‰è£…)

è¿™ä¸ªæ–‡ä»¶æ˜¯ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ï¼Œé‚£ä¹ˆæ•°æ®åº“è‚¯å®šä¹Ÿæ˜¯è¿æ¥ç”Ÿæˆç¯å¢ƒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é¡¹ç›®æ•°æ®åº“çš„ç›¸å…³é…ç½®è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹å¦‚ä¸‹
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/57f54e1812991e2261b8fd368bce52c4.png)

æˆ‘ä»¬ç°åœ¨ä½¿ç”¨mavenå·¥å…·ï¼Œå°†æœ¬åœ°é¡¹ç›®æ‰“ä¸€ä¸ªjaråŒ…ï¼Œä¼šåœ¨æ–‡ä»¶ä¸­ç”Ÿæˆä¸€ä¸ªtargetç›®å½•ï¼Œç›®å½•ä¸‹æœ‰ä¸€ä¸ªjaråŒ…å°±æ˜¯æˆ‘ä»¬åç«¯é¡¹ç›®æ‰“åŒ…å½¢æˆçš„
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/462f05bbe71c9a05ec67514249a057be.png)

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0abfefe7a3751a55a039e9fbdced069b.png)

ç°åœ¨æˆ‘ä»¬è¿›å…¥ç»ˆç«¯ï¼Œè¿è¡ŒjaråŒ…ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªå‚æ•°
```shell
java -jar ./usercenter-backend-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod
```

å¦‚æœæŠ¥é”™ï¼ˆæ²¡æœ‰æ¸…å•ä¸»å±æ€§ï¼‰ï¼Œè¯´æ˜æ˜¯ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåˆ›å»ºçš„springbooté¡¹ç›®ï¼Œéœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­æ³¨é‡Šæ‰è¿™ä¸€è¡Œ
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0691e24f7b378dcf4ab075268847b8ce.png)


è¿è¡Œåç«¯é¡¹ç›®æˆåŠŸåï¼Œæˆ‘ä»¬è¿è¡Œå‰ç«¯é¡¹ç›®ï¼Œçœ‹ä¸€çœ‹å‰ç«¯è®¿é—®é‚£ä¸€ä¸ªæ•°æ®åº“ã€‚
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/97a23ff5859d69457190a536c79c267c.png)

æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æ³¨å†Œï¼Œç„¶åå‘ç°æ³¨å†Œçš„æ•°æ®åœ¨æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“ï¼Œè¯´æ˜æˆåŠŸäº†
  ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a98381e78798e1d193b5f04c868926d2.png)
## 2 é¡¹ç›®çš„éƒ¨ç½²ä¸Šçº¿

### 2.1 åŸå§‹éƒ¨ç½²

**ä»€ä¹ˆçš„è½¯ä»¶éƒ½è‡ªå·±å®‰è£…ï¼**
#### 2.1.1 éƒ¨ç½²å‰ç«¯

å‰ç«¯éƒ¨ç½²éœ€è¦çš„è½¯ä»¶ï¼ˆwebæœåŠ¡å™¨ï¼‰
- ==nginx==ï¼šä¸»è¦ä½¿ç”¨çš„
- apache
- tomcat

---

**å®‰è£…nginxæœåŠ¡å™¨**

å®‰è£…æ–¹æ³•ï¼š
- ç”¨ç³»ç»Ÿè‡ªå¸¦çš„è½¯ä»¶åŒ…ç®¡ç†å™¨å¿«é€Ÿå®‰è£…ï¼Œcentosç³»ç»Ÿä¸­æ˜¯yum
- è‡ªå·±åˆ°[å®˜ç½‘](http://nginx.org/en/linux_packages.html)ï¼Œä¸‹è½½å®‰è£…åŒ…ï¼Œæ¥å®‰è£…ï¼ˆæˆ‘ä»¬ç”¨è¿™ç§æ–¹å¼æ¥è¿›è¡Œï¼‰

ä¸‹è½½nginxæœåŠ¡å™¨ï¼Œå¤åˆ¶é€‰æ‹©æ¬¾çš„é“¾æ¥
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/75b1d32dea5d1fd1364f08d3fb2bc86c.png)
å®‰è£…å‰ï¼Œå…ˆåšä¸€ç‚¹å‡†å¤‡å·¥ä½œ
```shell
//æŸ¥çœ‹å½“å‰ç›®å½•
pwd

// åœ¨usrç›®å½•ä¸‹åˆ›å»ºservicesç›®å½•ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰é¡¹ç›®çš„ä¾èµ–å’Œå®‰è£…åŒ…
mkdir services /usr/services

//åˆ—å‡ºç›®å‰ç›®å½•æ‰€åŒ…å«çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
ls

//è¿›å…¥servicesç›®å½•ä¸­
cd services
ls
```

åœ¨å½“å‰servicesç›®å½•ä¸‹ï¼Œä¸‹è½½å’Œè§£å‹nginx
```shell
//ä¸‹è½½
curl -o nginx-1.24.0.tar.gz http://nginx.org/download/nginx-1.24.0.tar.gz

//è§£å‹
tar -zxvf nginx-1.24.0.tar.gz
```

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/7f69f8a9e430d20cd50eed8a5127a9c8.png)

è¿›å…¥åˆ°nginxç›®å½•ä¸­ï¼Œå¹¶æŸ¥çœ‹å†…å®¹
```shelll
cd nginx-1.24.0.tar.gz
ls
```

è¿˜éœ€è¦å®‰è£…nginxçš„ç›¸å…³ä¾èµ–
```shell
yum install pcre pcre-devel -y
yum install openssl openssl-devel -y
```

è®¾ç½®ç³»ç»Ÿé…ç½®å‚æ•°ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™æ˜¯åœ¨nginxçš„ç›®å½•ä¸‹æ‰§è¡Œçš„ï¼‰
```shell
./configure --with-http_ssl_module --with-http_v2_module --with-stream
```

æ­¤æ—¶ç›´æ¥ç¼–è¯‘
```shell
make
```

**å¦‚æœç¼–è¯‘æŠ¥é”™ï¼Œè¿˜éœ€è¦å®‰è£…ä¸‹é¢çš„ä¾èµ–**
```shell
yum -y install make zlib-devel gcc-c++ libtool openssl openssl-devel

// ç„¶åé‡æ–°configure å’Œ make
```

å†æ¥å®‰è£…
```shell
make install
```

é…ç½®nginxçš„ç¯å¢ƒå˜é‡ï¼ŒåŠ å…¥åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­å»
```shell
// æ‰“å¼€ä½¿ç”¨ /etc/profileè¿™ä¸ªæ–‡ä»¶
vim /etc/profile

// æŒ‰ä¸‹shigt+g å°†å…‰æ ‡å®šä½åˆ°æœ€åä¸€è¡Œï¼Œæ–°å¢å¦‚ä¸‹å†…å®¹ï¼š
export PATH=$PATH:/usr/local/nginx/sbin

// ä½¿ç”¨ä¸Šè¿°æ–‡ä»¶ç”Ÿæ•ˆ
source /ect/profile
```

æµ‹è¯•nginxå‘½ä»¤èƒ½å¦ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œå°±è¯´æ˜æˆåŠŸäº†
```shell
nginx
```

ä½¿ç”¨å‘½ä»¤`netstat -ntlp`ï¼Œç»§ç»­æŸ¥çœ‹å½“å‰æ‰€æœ‰tcpç«¯å£æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°nginxå¯åŠ¨æˆåŠŸ
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/058c6269e555df8b3661953187824820.png)

å¤åˆ¶nginx.confæ–‡ä»¶ï¼Œå¹¶é‡å‘½åä¸ºnginx.default.conf
```shell
cd /usr/local/nginx/conf
cp nginx.conf nginx.default.conf
```

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/0835e4a7310f328a561514e352266343.png)

å›åˆ°servicesç›®å½•
```shell
cd /usr/services
```

---

**å‰ç«¯å¼€å§‹éƒ¨ç½²**

å‰ç«¯buildä¸€ä¸‹ï¼Œæ‰“åŒ…åï¼Œå°†diståŒ…æ‹–å…¥åˆ°æˆ‘ä»¬çš„servicesç›®å½•ä¸‹ï¼Œå¹¶æ”¹å
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/d31ee9ae382c3882e2dc7bf7c7085990.png)

```shell
// æ”¹å
mv dist usercenter-frontend
```

ä¿®æ”¹nginxé…ç½®æ–‡ä»¶ï¼Œè®¾ç½®==å¯åŠ¨ç”¨æˆ·==å’Œ==å‰ç«¯é¡¹ç›®æ‰€åœ¨è·¯å¾„==
```shell
// æ³¨æ„ä¸æ˜¯nginxç›®å½•ä¸‹çš„å—·

vim /usr/local/nginx/conf/nginx.conf
```

ä¿®æ”¹çš„å†…å®¹å¦‚å›¾æ‰€ç¤º
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/1f6e05f2bd110bcdabdf77c4e1d89f66.png)

è¡¥å……ï¼šä¸Šè¿°å›¾ç‰‡ä¸éœ€è¦`/root`è¿™ä¸ªç›®å½•

æ›´æ–°nginx.confæ–‡ä»¶
```shell
nginx -s reload
```

è®¿é—®æˆ‘ä»¬å…¬ç½‘çš„åœ°å€ï¼Œå‡ºç°é¡µé¢
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/086b24b40f3bf10a2e32fb866a556569.png)

#### 2.1.2 éƒ¨ç½²åç«¯

åç«¯çš„éƒ¨ç½²éœ€è¦ä¸¤ä¸ªä¾èµ– java  å’Œ maven

---

**å®‰è£…java**

```shell
yum install -y java-1.8.0-openjdk*
// yumå®‰è£…ä¸ç”¨é…ç½®ç¯å¢ƒå˜é‡
// æŸ¥çœ‹javaç‰ˆæœ¬ï¼Œå®‰è£…æˆåŠŸ
java -version
```

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/f0090856272c79e1eb7612dc47667a1f.png)

--- 

**å®‰è£…maven**

```shell
cd /usr/services

curl -o apache-maven-3.8.8-bin.tar.gz https://dlcdn.apache.org/maven/maven-3/3.8.8/binaries/apache-maven-3.8.8-bin.tar.gz

tar -zxvf apache-maven-3.8.8-bin.tar.gz
```

ä¿®æ”¹é•œåƒä¸ºé˜¿é‡Œäº‘
```shell
vim apache-maven-3.8.8/conf/settings.xml

//æ‰¾åˆ°<mirrors>æ ‡ç­¾åœ¨æ ‡ç­¾é‡Œé¢æ·»åŠ é˜¿é‡Œäº‘é•œåƒé…ç½®
Â  Â  <mirror> Â 
Â  Â  Â  Â  <id>nexus-aliyun</id>
Â  Â  Â  Â  <mirrorOf>*</mirrorOf>
Â  Â  Â  Â  <name>Nexus aliyun</name>
Â  Â  Â  Â  <url>http://maven.aliyun.com/nexus/content/groups/public</url>

Â  Â  </mirror>

Â  </mirrors>

```

è¿›å…¥åˆ°maven
```shell
cd apache-maven-3.8.8
cd bin
ls
// lsæ‰“å¼€åçœ‹åˆ°çš„mvnmvnæ˜¯mavençš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå’±ä»¬å°±æ˜¯ç”¨è¿™ä¸ªæ–‡ä»¶å»æ„å»ºé¡¹ç›®

pwd
//è·å–å½“å‰ç›®å½•è·¯å¾„åï¼Œå¤åˆ¶ä¸€ä¸‹
```

æ·»åŠ ç¯å¢ƒå˜é‡
```shell
vim /etc/profile

// æŠŠä¹–ä¹–å¤åˆ¶çš„è·¯å¾„ï¼Œæ”¾åœ¨nginxç¯å¢ƒå˜é‡åé¢

//ä½¿æ–‡ä»¶ç”Ÿæ•ˆ
source /ect/profile

//æ£€æŸ¥ä¸€äº›ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®æˆåŠŸ
mvn -v
```

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/35aa18f3c13d8ddff7e2292e134d2550.png)

---

**å°†åç«¯é¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨**

ä½¿ç”¨gitç›´æ¥æŠŠæ‹–åˆ°servicesç›®å½•ä¸­ï¼Œå…ˆä¸‹è½½git
```shell
yum install -y git
```

ä½¿ç”¨gitæ‹‰å–æˆ‘ä»¬çš„é¡¹ç›®ï¼Œè¿™é‡Œä»£ç çœç•¥ï¼Œå­¦è¿‡gitå°±çŸ¥é“å•¦

è¿›å…¥åˆ°æˆ‘ä»¬ä¸‹è½½å¥½çš„åç«¯é¡¹ç›®ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œæ¥æ‰“åŒ…æ„å»ºæˆ‘ä»¬çš„åç«¯é¡¹ç›®
```shell
cd usercenter-backend

//æ‰“åŒ…æ„å»ºï¼Œå¹¶è·³è¿‡æµ‹è¯• æˆ–è€… ç›´æ¥å°†æˆ‘ä»¬windowä¸­æ‰“åŒ…å¥½çš„é¡¹ç›®æ”¾å…¥ä¹Ÿè¡Œ
mvn package -DskipTests
```

æ‰“åŒ…å®Œæˆä¹‹åä¼šåœ¨è¿™ä¸ªåç«¯é¡¹ç›®ç”Ÿæˆä¸€ä¸ªtargetç›®å½•ï¼Œç›®å½•ä¸‹ä¿å­˜ç€æˆ‘ä»¬çš„jaråŒ…
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a78588eb544081872f2060656a9c9109.png)

æ‰§è¡Œè¿™ä¸ªjaråŒ…
```shell
//æ³¨æ„ç›®å½•
java -jar ./usercenter-backend-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod

//ä¹‹åå¦‚æœæ˜¾ç¤ºæ²¡æœ‰æƒé™ï¼Œç»™è¿™ä¸ªæ–‡ä»¶æ·»åŠ å¯æ‰§è¡Œæƒé™
chmod a+x usercenter-backend-0.0.1-SNAPSHOT.jar

//å†æ¬¡æ‰§è¡Œä¸Šè¿°å‘½ä»¤

//è¿™æ ·çš„è¯è¿™ä¸ªï¼Œçª—å£å°±ä¸€ç›´è¢«è¿™ä¸ªjaråŒ…æ‰§è¡Œçš„å†…å®¹æ‰€å æ»¡äº†ï¼Œæˆ‘ä»¬ctrl+cç»ˆæ­¢

// ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œè®©ä»–åœ¨åå°è¿è¡Œ
nohup java -jar ./usercenter-backend-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod & 

//ç›´æ¥å›è½¦ï¼Œä¸è¦ç®¡ï¼Œå°±å›åˆ°å‘½ä»¤ç•Œé¢äº†

// ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹åå°è¿è¡Œçš„æƒ…å†µ
jobs
netstat -ntlp
//æˆ–è€…
jps
```

å…³é—­
```shell
ps -ef | grep ä½ çš„jaråŒ…æ–‡ä»¶å
kill [-9] æ‰¾åˆ°å…¶è¿è¡Œçš„è¿›ç¨‹
```

**å‹æƒ…æç¤ºï¼šåˆ°è¿™é‡Œæœ€å¥½é•œåƒä¸€ä¸‹å—·ï¼**

### 2.2 å®å¡”


å®å¡”åªæ˜¯ä¸€ä¸ªLinuxè¿ç»´é¢æ¿ï¼Œæ–¹ä¾¿ç®¡ç†æœåŠ¡å™¨ï¼Œæ–¹ä¾¿æœåŠ¡å™¨ä¸­å®‰è£…è½¯ä»¶ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œå»å®˜ç½‘å®‰è£…ï¼Œ[å®˜ç½‘åœ°å€](https://www.bt.cn/new/download.html)

ç›®å‰ï¼ˆ2024-4-15ï¼‰è´­ä¹°çš„è…¾è®¯äº‘æœåŠ¡å™¨ï¼Œå·²ç»è‡ªå¸¦äº†å®å¡”Linuxé¢æ¿ï¼Œå°±ä¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸­å®‰è£…å®å¡”äº†

---

**å¼€å¯å®å¡”ç•Œé¢**

æ”¾è¡Œç«¯å£ä¸€ä¸‹å°±å¥½ï¼Œå°±æ˜¯è®©è‡ªå·±çš„ç”µè„‘ï¼ˆipï¼‰å¯ä»¥è®¿é—®æœåŠ¡å™¨
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/6ea5d05ebdcdec8c2eb2aa52d9df3f27.png)

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/34b3d2aa5ae7b2ddcf65e3fd905a361d.png)

å›åˆ°åº”ç”¨ç®¡ç†ï¼Œå¯ä»¥çœ‹åˆ°é¢æ¿é¦–é¡µåœ°å€ï¼Œæœ¬æœºä½¿ç”¨è¿™ä¸ªåœ°å€åˆ°æµè§ˆå™¨ä¸­å°±å¯ä»¥è®¿é—®
ä¸è¿‡å…ˆéœ€è¦ç‚¹å‡»ä¸‹é¢çš„ç™»å½•ï¼Œç„¶åè¾“å…¥å‘½ä»¤è·å–ç”¨æˆ·åå’Œå¯†ç 
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/2941109707f4504b84dc6e9b4cfbc6cd.png)

![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/ad70279abe74950aded044972e1941e7.png)

è¿›å…¥å®å¡”ç•Œé¢ä¹‹åï¼Œç‚¹å‡»é¢æ¿è®¾ç½®ï¼Œä¿®æ”¹ä¸€ä¸‹å®‰å…¨å…¥å£ã€ç”¨æˆ·åã€å¯†ç ç™»èµ„æ–™

---

**å›åˆ°æœåŠ¡å™¨æœ€åˆçš„é•œåƒæ–‡ä»¶ä¸­ï¼ˆå•¥éƒ½æ²¡æœ‰ï¼‰ï¼Œæˆ‘ä»¬ä¹‹å‰ä¿å­˜äº†**

å¼€å§‹ä½¿ç”¨å®å¡”å®‰è£…å‰©ä½™çš„è½¯ä»¶ï¼šnginxã€tomcatã€docker

---

**éƒ¨ç½²å‰ç«¯é¡µé¢**

åŸŸåéƒ¨ç½²å‚è€ƒé“¾æ¥ï¼š[å®å¡”Linuxé¢æ¿Javaé¡¹ç›®éƒ¨ç½²åŸŸåè®¿é—® (SpringBooté¡¹ç›®)_å®å¡” javaé¡¹ç›® é…ç½®åŸŸå-CSDNåšå®¢](https://blog.csdn.net/weixin_43652507/article/details/132076705)

å›åˆ°å®å¡”é¢æ¿ï¼Œç‚¹å‡»æ·»åŠ ç«™ç‚¹![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/85cd1142c94ce1a7a0cdfebba023b962.png)
è¿›å…¥åˆ°ç«™ç‚¹çš„ç›®å½•
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/6eb64da817953ecd506ae9696031bcc2.png)

å…¨é€‰æ–‡ä»¶åˆ é™¤æ‰ï¼
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/56568b1882ffa1dada80511ccd20fdaa.png)

ç„¶åç›´æ¥æŠŠå‰ç«¯æ‰“åŒ…å¥½çš„é¡¹ç›®distï¼Œæ‰”è¿›å»ï¼
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/69853f05b4b550794a1d9bff199817eb.png)

ç›´æ¥åœ¨å…¬ç½‘è®¿é—®ä¸€ä¸‹ï¼Œ`å¦‚æœæ˜¯åŸŸåå°±è®¿é—®åŸŸåï¼Œå¦‚æœæ˜¯æœåŠ¡å™¨ipå°±è®¿é—®æœåŠ¡å™¨ip`

---

**éƒ¨ç½²åç«¯éƒ¨åˆ†**

æ‰¾åˆ°ä¾§è¾¹æ çš„æ–‡ä»¶ï¼Œæ¥åˆ°wwwrootç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªusercenter-backendç›®å½•ï¼Œç”¨äºå­˜æ”¾æˆ‘ä»¬åç«¯é¡¹ç›®
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/2a31961742c4773fcb51fdac5187551c.png)

è¿›å…¥è¿™ä¸ªé¡¹ç›®ï¼ŒæŠŠä¹‹å‰æ‰“åŒ…å¥½çš„jaråŒ…ï¼Œæ”¾è¿›å»
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/d719ca5b7c0f23e19404f9256d41336a.png)

å¤åˆ¶è¯¥jaråŒ…æ‰€åœ¨çš„è·¯å¾„ï¼Œç„¶åå»ç½‘ç«™å“ªé‡Œåˆ›å»ºJavaé¡¹ç›®
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/55fe403876493b43a69a42be53dfc74d.png)
```shell
/www/server/java/jdk1.8.0_371/bin/java  -jar -Xmx1024M -Xms256M  /www/wwwroot/usercenter-backend/usercenter-backend-0.0.1-SNAPSHOT.jar --server.port=8080 --spring.profiles.active=prod
```


å¯ä»¥å‘ç°é¡¹ç›®è¿è¡Œä¸­ï¼Œä½†æ˜¯ç«¯å£è¿˜æ²¡æœ‰æ”¾è¡Œ![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/cee8f76b84d00a27065c76b9334edeb0.png)
å…ˆæŠŠtomcatåœæ‰ï¼Œå¦åˆ™tomcatå ç”¨8080ç«¯å£
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a17e9afe5b67f2818e176d721a63fa03.png)


å»é˜²ç«å¢™ï¼ŒæŠŠ8080ç«¯å£æ”¾è¡Œ
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/bb8be2b7170adf61486e8cd661f3aaa1.png)

è®¿é—®ä¸€ä¸‹`æœåŠ¡å™¨ipï¼š8080`ï¼Œå‘ç°æ— æ³•è®¿é—®
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/5154020362139ab30870ea253cdffb69.png)

æœ¬åœ°ä¿®æ”¹ä¸€äº›é…ç½®ï¼Œé‡æ–°æ‰“ä¸ªåŒ…ï¼Œä¼ åˆ°å®å¡”ä¸Šé¢ï¼ˆä¸‹é¢é”™äº†ï¼Œç›´æ¥å†™0.0.0.0å³å¯ï¼‰
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/87ffca32dda6c0a435dc9b4745721e0a.png)

å†æ¬¡è®¿é—®ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œéšä¾¿åŠ ä¸€ä¸ªè·¯å¾„ï¼ŒæˆåŠŸäº†
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/54bac77bdedca732f45281be7e3d5ea7.png)

---

å‰åç«¯è”è°ƒ

### 2.3 Docker

Docker æ˜¯å®¹å™¨ï¼Œå¯ä»¥å°†é¡¹ç›®çš„ç¯å¢ƒï¼ˆjavaã€nginxï¼‰å’Œé¡¹ç›®çš„ä»£ç ä¸€èµ·æ‰“åŒ…æˆé•œåƒï¼Œè¿™æ ·æœ‰æƒé™çš„ç”¨æˆ·èƒ½ä¸‹è½½é•œåƒï¼Œæ›´å®¹æ˜“åˆ†å‘å’Œç§»æ¤

å†å¯åŠ¨é¡¹ç›®æ—¶ï¼Œä¸éœ€è¦æ•²ä¸€å¤§å †å‘½ä»¤ï¼Œè€Œæ˜¯ç›´æ¥ä¸‹è½½dockeré•œåƒï¼Œå¯åŠ¨é•œåƒå°±å¯åŠ¨é¡¹ç›®äº†

**dockerå¯ä»¥ç†è§£ä¸ºè½¯ä»¶å®‰è£…åŒ…**

--- 

**å®‰è£…**
- å®˜ç½‘å®‰è£…
- å®å¡”å®‰è£…ï¼ˆæˆ‘ä»¬ç”¨è¿™ä¸ªï¼‰

---

**ä»€ä¹ˆæ˜¯Dockerfileæ–‡ä»¶**
æ€ä¹ˆæŠŠæˆ‘ä»¬çš„å‰åç«¯é¡¹ç›®åˆ¶ä½œæˆé•œåƒï¼Œè‚¯å®šæ˜¯éœ€è¦ä¸€ä¸ªæ–‡ä»¶æ¥å®šä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„å‰ç«¯é¡¹ç›®çš„ä¾èµ–ã€å¯åŠ¨æµç¨‹ï¼Œå…¨éƒ¨å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯Dockerfile

æ‰€ä»¥ï¼ŒDockerfileç”¨äºæŒ‡å®šæ„å»ºDockeré•œåƒçš„æ–¹æ³•ï¼š
- ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦å®Œå…¨ä»0è‡ªå·±å†™ï¼Œå»ºè®®å»githubï¼Œgiteeç­‰æ‰˜ç®¡å¹³å°å‚è€ƒåŒç±»é¡¹ç›®å³å¯

Dockfileæ–‡ä»¶ç¼–å†™ï¼š
- FROMï¼šä¾èµ–çš„åŸºç¡€é•œåƒ
- WORKDIRï¼šå·¥ä½œç›®å½•
- COPYï¼šä»æœ¬æœºå¤åˆ¶æ–‡ä»¶
- RUNï¼šæ‰§è¡Œå‘½ä»¤
- CMD/ENTRYPOINTï¼šé™„åŠ é¢å¤–å‚æ•°ï¼ŒæŒ‡å®šè¿è¡Œå®¹å™¨æ—¶é»˜è®¤æ‰§è¡Œçš„å‘½ä»¤

---

**æ„å»ºåç«¯**

**æ¨èä½¿ç”¨ä½¿ç”¨IDEAè¿æ¥æœåŠ¡å™¨çš„dockerï¼Œç„¶åæœ¬åœ°æ„å»ºé•œåƒåˆ°æœåŠ¡å™¨ä¸Šå»**
- [1_SpringBooté¡¹ç›®éƒ¨ç½²ï¼ˆDockerï¼‰](../../../08-ğŸ› ï¸%20å¼€å‘å·¥å…·/03-ğŸ‹%20å®¹å™¨åŒ–/02-ğŸš€%20Dockerè¿›é˜¶/1_SpringBooté¡¹ç›®éƒ¨ç½²ï¼ˆDockerï¼‰.md)

æˆ‘ä»¬è¿™é‡Œç›´æ¥å¤åˆ¶é±¼çš®çš„åç«¯Dockerfile
```dockerfile
# Docker é•œåƒæ„å»º
FROM maven:3.5-jdk-8-alpine as builder

# Copy local code to the container image.
WORKDIR /app
COPY pom.xml .
COPY src ./src

# Build a release artifact.
RUN mvn package -DskipTests

# Run the web service on container startup.
CMD ["java","-jar","/app/target/usercenter-backend-0.0.1-SNAPSHOT.jar","--spring.profiles.active=prod"]
```

åœ¨åç«¯é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªDockerfileï¼Œå¹¶å¤åˆ¶ä»£ç 
![image.png|200](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a7c11b009250c2d852737d8f64086939.png)

ç„¶åå†shellä¸­ï¼Œè¿›å…¥ /www/wwwrootä¸‹ ä½¿ç”¨gitæ‹‰å–åç«¯é¡¹ç›®
```shell
git clone åç«¯é¡¹ç›®çš„åœ°å€
```

æ‹‰å–å®Œæˆåï¼Œè¿›å…¥é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå¯ä»¥å‘ç°Dockerfileå·²ç»å­˜åœ¨äº†,æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æ„å»ºåç«¯é•œåƒ
```shell
sudo docker build -t usercenter-backend:v0.0.1 .
```

ç„¶åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™é‡Œå‘½ä»¤æ‰§è¡Œçš„å¾ˆæ…¢ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
- å› ä¸ºæˆ‘ä»¬æŠŠæˆ‘ä»¬æŠŠmaevnæ„å»ºæ‰“åŒ…é¡¹ç›®æ”¾åœ¨äº†dockefileé‡Œé¢äº†
- ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠmavenç°åœ¨æœ¬åœ°æ„å»ºï¼Œç„¶åæ‰“åŒ…æ”¾è¿‡å»

---

**æ„å»ºå‰ç«¯**

è¿˜æ˜¯ä½¿ç”¨é±¼çš®çš„Dockerfileï¼Œè¿™ä¸ªå¤åˆ¶åˆ°æ ¹ç›®å½•ä¸‹çš„Dockerfileæ–‡ä»¶ä¸­
```dockerfile
// dockeré•œåƒä¾èµ–çš„webæœåŠ¡å™¨
FROM nginx
// æŒ‡å®šnginxçš„å·¥ä½œç›®å½•
WORKDIR /usr/share/nginx/html/
// æŒ‡å®šä¸€ä¸‹ç”¨æˆ·ï¼Œå¯ä»¥ä¸å†™
USER root
// å°†dockerä¸­çš„nginxæ–‡ä»¶ï¼Œè¦†ç›–å‰ç«¯é¡¹ç›®çš„nginxæ–‡ä»¶
COPY ./docker/nginx.conf /etc/nginx/conf.d/default.conf
// å°†æˆ‘ä»¬å‰ç«¯çš„ä»£ç ï¼Œè½¬ç§»åˆ°nginxé»˜è®¤å¯ä»¥è¯†åˆ«çš„htmlç›®å½•ä¸‹
COPY ./dist  /usr/share/nginx/html/
// é¡¹ç›®ç«¯å£
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

è¿˜éœ€è¦ç²˜è´´ä¸€ä¸ªnginx.confçš„é…ç½®ï¼Œè¿™ä¸ªå¤åˆ¶åˆ°dockerç›®å½•ï¼ˆåœ¨æ ¹ç›®å½•ï¼‰ä¸‹çš„nginx.confé…ç½®ä¸­
```conf
server {
    listen 80;
    
    # gzip config
    gzip on;
    gzip_min_length 1k;
    gzip_comp_level 9;
    gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml;
    gzip_vary on;
    gzip_disable "MSIE [1-6]\.";
    root /usr/share/nginx/html;
    include /etc/nginx/mime.types;
    location / {
        try_files $uri /index.html;
    }
}
```
- try_filesï¼šè¡¨ç¤ºå¦‚æœç”¨æˆ·æ‰¾ä¸åˆ°æŸä¸ªé¡µé¢çš„è¯ï¼Œç›´æ¥åˆ°indexä¸»é¡µå»

åŒç†ï¼Œä½¿ç”¨gitæ‹‰å–æˆ‘ä»¬çš„å‰ç«¯ä»£ç ï¼Œç„¶åä½¿ç”¨dockerfileæ„å»ºå‰ç«¯é•œåƒ
```shell
sudo docker build -t usercenter-frontend:v0.0.1 .

// å¯ä»¥çœ‹ä¸€ä¸‹å®‰è£…çš„é•œåƒ
sudo docker images
```

- Docker æ„å»ºä¼˜åŒ–å¯ä»¥ä»è¿™äº›æ–¹é¢å…¥æ‰‹ï¼šå‡å°‘å°ºå¯¸ã€å‡å°‘æ„å»ºæ—¶é—´ç­‰ï¼Œæ„Ÿå…´è¶£å¯ä»¥è¯•è¯•

---

**å¯åŠ¨é¡¹ç›®**
```shell
docker run -p 80:80 -d usercenter-frontend:v0.0.1

docker run -p 8080:8080 usercenter-backend:v0.0.1
```

è™šæ‹ŸåŒ–ï¼š
- ç«¯å£æ˜ å°„ï¼šæŠŠæœ¬æœºçš„èµ„æºï¼ˆå®é™…è®¿é—®åœ°å€ï¼‰å’Œå®¹å™¨å†…éƒ¨çš„èµ„æºï¼ˆåº”ç”¨å¯åŠ¨ç«¯å£ï¼‰è¿›è¡Œå…³è”
- ç›®å½•æ˜ å°„ï¼šæŠŠæœ¬æœºçš„ç«¯å£å’Œå®¹å™¨åº”ç”¨ç«¯å£è¿›è¡Œå…³è”

---

[Docker å‘½ä»¤å¤§å…¨ | èœé¸Ÿæ•™ç¨‹ (runoob.com)](https://www.runoob.com/docker/docker-command-manual.html)

**æŸ¥çœ‹æ—¥å¿—**
```shell
//æŸ¥çœ‹è¿›ç¨‹(å¯ä»¥æŸ¥çœ‹å·²ç»å¯åŠ¨çš„å®¹å™¨IDï¼Œæ²¡æœ‰æƒé™ç”¨sudo)
//å®¹å™¨IDä¸æ˜¯å›ºå®šçš„ï¼Œä¸è¦ç›²ç›®å¤åˆ¶å‘½ä»¤å“¦
docker ps

//æŸ¥çœ‹æ—¥å¿— docker logs å®¹å™¨ID
//è¿™äº›éƒ½æ˜¯å’±ä»¬çš„è®¿é—®è®°å½•,å¯ä»¥çœ‹åˆ°å“ªä¸ªç”¨æˆ·,å“ªä¸ªIP,åœ¨ä»€ä¹ˆæ—¶é—´è®¿é—®äº†ä½ çš„ç½‘é¡µçš„å“ªäº›æ–‡ä»¶
docker logs 61444cbea251
```

è¿™æ ·çœ‹æ—¥å¿—æœ‰ç‚¹éº»çƒ¦ï¼Œæ€ä¹ˆæ ·è®©è¿™ä¸ªæ—¥å¿—ä¿æŒå§‹ç»ˆçš„æŒç»­ä¸æ–­çš„è¾“å‡º
```shell
//-fè·Ÿè¸ªæ—¥å¿—è¾“å‡º(æ²¡æœ‰æƒé™ç”¨sudo)
docker logs å®¹å™¨ID -f

//ctrl + cé€€å‡º æ€æ­»æ‰è¿™ä¸ªå®¹å™¨ docker kill å®¹å™¨ID
docker kill 61444cbea251
```

ä¸¾ä¾‹ï¼šå¦‚æœè¯´æˆ‘ä»¬è§‰å¾—è¿™äº›é•œåƒå¤ªå ç”¨ç©ºé—´äº†ï¼Œæƒ³æŠŠå®ƒåˆ æ‰ï¼Œæ€ä¹ˆåˆ ï¼Ÿ
```shell
//æŸ¥çœ‹é•œåƒ
docker images
//å¼ºåˆ¶åˆ é™¤é•œåƒ docker rmi -f é•œåƒid
```




