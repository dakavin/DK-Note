---
æ–‡ç« æ ‡é¢˜: "[[15_ç»ƒä¹ ä¸€ï¼šåŠ¨æ€æµæ°´ç¯æ§åˆ¶]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  åŸºäº51å•ç‰‡æœºçš„åŠ¨æ€æµæ°´ç¯æ§åˆ¶ç»ƒä¹ ï¼Œé€šè¿‡æŒ‰é”®ä¸­æ–­æ”¹å˜LEDæµæ°´ç¯æ–¹å‘ï¼Œå®ç°æŒ‰ä¸‹å‘å·¦ã€æ¾å¼€å‘å³çš„æ§åˆ¶é€»è¾‘
tags:
- "51å•ç‰‡æœº"
- "LEDæ§åˆ¶"
- "å¤–éƒ¨ä¸­æ–­"
- "æŒ‰é”®æ£€æµ‹"
- "æµæ°´ç¯"
- "åµŒå…¥å¼ç¼–ç¨‹"
- "Cè¯­è¨€"
- "ä¸­æ–­æœåŠ¡"
ç›¸å…³æ–‡ç« :
- "[[0_è¯¾ç¨‹å®Œæ•´å†…å®¹]]"
- "[[16_ç»ƒä¹ 2ï¼šç§’è¡¨è®¡æ•°å™¨]]"
- "[[17_ç»ƒä¹ 3ï¼šä¸²å£è°ƒå…‰]]"
- "[[0_ç¬”è®°ï¼ˆé‡ç‚¹å¤‡å¿˜ï¼‰]]"
- "[[0_Cè¯­è¨€æçº²]]"
æ–‡ç« åˆ†ç±»: "ğŸ”§ åµŒå…¥å¼å¼€å‘"
æ–‡ç« è·¯å¾„: "05-ğŸ”§ åµŒå…¥å¼å¼€å‘/01-ğŸ¯ 51å•ç‰‡æœº/03-ğŸš€ é¡¹ç›®å®æˆ˜/15_ç»ƒä¹ ä¸€ï¼šåŠ¨æ€æµæ°´ç¯æ§åˆ¶.md"
æ–‡ç« éš¾åº¦: åˆçº§ ğŸ’§
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­ é‡è¦æŠ€èƒ½
åˆ›å»ºæ—¶é—´: 2025-01-03 02:44:07
ä¿®æ”¹æ—¶é—´: 2025-05-27 23:05:39
---

## 1 è‡ªè¡Œåˆ†æ

è¦æ±‚ï¼š
- é€šè¿‡æŒ‰é”®æŒ‰ä¸‹æ”¹å˜æµæ°´ç¯çš„æ–¹å‘ï¼ŒæŒ‰ä¸‹æ—¶ä»å·¦åˆ°å³é—ªçƒï¼ŒæŠ¬èµ·æ—¶ä»å³åˆ°å·¦é—ªçƒï¼Œä»»æ„å–ä¸€ä¸ªæŒ‰é”®å³å¯

æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š
- LED
- è§¦æ‘¸ / æŒ‰é”®
- ä¸­æ–­

è‡ªå·±å†™çš„ä»£ç ï¼š
```c
#include "reg52.h"  
  
sfr P4 = 0xe8;                   //for 89C5xRC/RD+ series and 90C5xRc/RD+, location at 0E8H  
//sfr P4   = 0xc0;                  //for 90C5xAD series, location at 0C0H  
sbit INT2 = P4 ^ 3;  
sbit INT3 = P4 ^ 2;  
  
sfr XICON = 0xc0;                   //for 89C5xRC/RD+ series and 90C5xRc/RD+, location at 0C0H  
//sfr XICON = 0xe8;                 //for 90C5xAD series, location at 0E8H  
sbit PX3 = XICON ^ 7;  
sbit EX3 = XICON ^ 6;  
sbit IE3 = XICON ^ 5;  
sbit IT3 = XICON ^ 4;  
sbit PX2 = XICON ^ 3;  
sbit EX2 = XICON ^ 2;  
sbit IE2 = XICON ^ 1;  
sbit IT2 = XICON ^ 0;  
  
sbit key = P4 ^ 3;  
#define RIGHT 1  
#define lEFT 0  
  
void delay_ms(unsigned int xms)   //@12MHz  
{  
    unsigned int i, j;  
    for (i = xms; i > 0; i--) {  
        for (j = 124; j > 0; j--) {}  
    }  
}  
  
unsigned char leds[] = {0x7F, 0xBF, 0xDF};  
  
void led_loop(direct) {  
    int i = 0;  
    if (direct == RIGHT) {  
        for (i = 0; i < 3; ++i) {  
            P2 = leds[i];  
            delay_ms(500);  
        }  
    } else {  
        for (i = 2; i >= 0; --i) {  
            P2 = leds[i];  
            delay_ms(500);  
        }  
    }  
}  
  
void main() {  
    unsigned int flag = 0;  
    while (1) {  
        if (key == 0) {  
            delay_ms(10);  
            flag = !flag;  
            delay_ms(500);  
        }  
  
        if (flag == 1) {  
            led_loop(RIGHT);  
        } else {  
            led_loop(lEFT);  
        }  
    }  
}
```

## 2 å‚è€ƒç­”æ¡ˆ

åœ¨LEDå®éªŒä¸­ï¼ŒLEDå‘ˆç°å¦‚å›¾çš„å˜åŒ–ï¼Œé€šè¿‡åœ¨ä¸»å¾ªç¯ä¸­ï¼Œäº¤æ›¿å¼€å¯å¯¹åº”LEDï¼Œå¹¶åŠ ä¸Šä¸€äº›å»¶æ—¶æ¡ä»¶ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°ç¯å…‰ä»å³åˆ°å·¦å˜åŒ–

![73539a8a-57b6-418c-a0fe-363f6bed9d2f.gif|500|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/02/6073dcd5b3b9e660e2db1d3d0079a5f5.gif)

ç„¶è€Œï¼Œåœ¨è¿™ä¸ªè¯¾åå°é¡¹ç›®ä¸­ï¼Œç¯å…‰ä¸æ­¢è¦ä»å³åˆ°å·¦ï¼Œä¹Ÿè¦ä»å·¦åˆ°å³é—ªçƒ

![2.gif|500|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/02/8bedc1a473d3dfa6a029ba94fde076a4.gif)

å…¶å®ï¼Œç¯å…‰é—ªçƒè¿‡ç¨‹ï¼Œå¯ä»¥æƒ³è±¡æˆæŒ‡é’ˆåœ¨åœ†ç¯ä¸Šé¡ºé€†æ—¶é’ˆè¿åŠ¨ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„ç¯å…‰äº®èµ·

![3.gif|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/02/0f5992d3e99b9a6d93101f159a078051.gif)

å‚è€ƒä»£ç ï¼š
```c
#include "reg52.h"  
#include "intrins.h"  
  
#define RIGHT 1  
#define LEFT -1  
static int led_flag = RIGHT;  
static unsigned int led_num = 5;  
  
// ä¸­æ–­éƒ¨åˆ†ä»£ç   
sfr P4 = 0xe8;                   //for 89C5xRC/RD+ series and 90C5xRc/RD+, location at 0E8H  
//sfr P4   = 0xc0;                  //for 90C5xAD series, location at 0C0H  
sbit INT2 = P4 ^ 3;  
sbit INT3 = P4 ^ 2;  
  
sfr XICON = 0xc0;                   //for 89C5xRC/RD+ series and 90C5xRc/RD+, location at 0C0H  
//sfr XICON = 0xe8;                 //for 90C5xAD series, location at 0E8H  
sbit PX3 = XICON ^ 7;  
sbit EX3 = XICON ^ 6;  
sbit IE3 = XICON ^ 5;  
sbit IT3 = XICON ^ 4;  
sbit PX2 = XICON ^ 3;  
sbit EX2 = XICON ^ 2;  
sbit IE2 = XICON ^ 1;  
sbit IT2 = XICON ^ 0;  
  
sfr IPH = 0xB7; // å®šä¹‰é»˜è®¤å€¼ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨ï¼ˆç”¨äºå®šä¹‰ä¸­æ–­ä¼˜å…ˆçº§ï¼‰
  
sbit key = P4 ^ 3;  
  
// å»¶æ—¶å‡½æ•°  
void delay_ms(unsigned int xms)   //@12MHz  
{  
    unsigned int i, j;  
    for (i = xms; i > 0; i--) {  
        for (j = 124; j > 0; j--) {}  
    }  
}
  
// å¤–éƒ¨ä¸­æ–­0çš„å›è°ƒå‡½æ•°  
void exit0() interrupt 0{  
  
}  
  
// å¤–éƒ¨ä¸­æ–­2çš„å›è°ƒå‡½æ•°  
void exit2() interrupt 6{  
    // æŒ‰ä¸‹çš„æ—¶å€™ï¼Œè§¦å‘ä¸­æ–­2ï¼Œå¹¶ä¸”è¯»å–åˆ°keyå¯¹åº”çš„ç®¡è„šæ˜¯0  
    // æŒ‰é”®æŒ‰ä¸‹æ—¶ç¯åˆ‡æ¢æ–¹å‘ P4.3 / INT2    
    if(key == 0){  
        led_flag = LEFT;  
        delay_ms(10);  
    }  
}  
  
// ledæ§åˆ¶ä»£ç   
void open_led(unsigned int num) {  
    P2 = 0xFF & ~(1 << num); 
    // & 0xFFçš„ä½œç”¨æ˜¯ç¡®ä¿ç»“æœä¸ä¼šè¶…å‡º 8 ä½
}  
  
void main() {  
    IT0 = 1; // è®¾ç½®å¤–éƒ¨ä¸­æ–­0çš„è§¦å‘æ¡ä»¶ä¸ºä¸‹é™æ²¿  
    EX0 = 1; // è¿è¡Œä¸­æ–­0ç»è¿‡  
    IT2 = 1; // è®¾ç½®å¤–éƒ¨ä¸­æ–­2çš„è§¦å‘æ¡ä»¶ä¸ºä¸‹é™æ²¿  
    EX2 = 1; // è¿è¡Œä¸­æ–­2ç»è¿‡  
    // è®¾ç½®ä¸­æ–­2ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¸­æ–­0ä¼˜å…ˆçº§æœ€ä½  
    IPH = 0x40; // 0b0100 0000 ---> PX0H = 0,PX2H = 1  
    PX0 = 0;  
    PX2 = 1;  
    EA = 1; // ä½¿èƒ½ä¸­æ–­  
    while (1) {  
        // å¯¹åº”çš„LEDæ˜¾ç¤º  
        open_led(led_num);  
        // è®©ledç¯é—´éš”äº®èµ·
        delay_ms(1000);  
        // ä¸Šå‡æ²¿åˆ¤æ–­ï¼Œå³æ¾å¼€æŒ‰é”®åï¼Œæ¢å¤åŸæ¥çš„æ–¹å‘ ---> f = R        
        if (led_flag == LEFT && key == 1) {  
            led_flag = RIGHT;  
        }  
        // ä¸‹ä¸€ä¸ªæ˜¾ç¤ºçš„LEDè®¡ç®—  
        led_num += led_flag;  
        // é€»è¾‘åœ†ç¯æ­å»º  
        if (led_num < 5)  
            led_num = 7;  
        else if (led_num > 7) {  
            led_num = 5;  
        }  
    }  
}
```

1ã€å¼€å§‹ï¼šf=Rï¼Œkey=1ï¼Œifä¸æˆç«‹ï¼Œnum++ï¼ˆå‘å³ï¼‰
2ã€æŒ‰ä¸‹ï¼šf=Lï¼Œkey=0ï¼Œifä¸æˆç«‹ï¼Œnum--ï¼ˆå‘å·¦ï¼‰
3ã€æ¾å¼€ï¼šf=Lï¼Œkey=1ï¼Œifæˆç«‹ï¼Œf=Rï¼Œnum++ï¼ˆå‘å³ï¼‰  **æ¢å¤åˆå§‹çŠ¶æ€**