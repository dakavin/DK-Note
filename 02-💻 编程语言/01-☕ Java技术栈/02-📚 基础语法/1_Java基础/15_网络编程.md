---
æ–‡ç« æ ‡é¢˜: "[[15_ç½‘ç»œç¼–ç¨‹]]" 
æ–‡ç« ä½œè€…: Dakkk
æ–‡ç« æ¦‚è¦: |
  æ–‡ç« ç³»ç»Ÿè®²è§£Javaç½‘ç»œç¼–ç¨‹åŸºç¡€ã€‚æ¶µç›–C/Sä¸B/Sæ¶æ„ã€IPåœ°å€ã€ç«¯å£ã€TCP/IPåè®®æ ˆåŠTCP/UDPåè®®ç‰¹æ€§ï¼ˆå«ä¸‰æ¬¡æ¡æ‰‹/å››æ¬¡æŒ¥æ‰‹ï¼‰ã€‚è¯¦ç»†ä»‹ç»Javaç½‘ç»œAPIï¼ˆInetAddressã€Socketã€URLï¼‰ï¼Œå¹¶æä¾›TCP/UDPå®æˆ˜ä»£ç ç¤ºä¾‹ä¸èŠå¤©å®¤æ¡ˆä¾‹ã€‚
tags:
- "Javaç½‘ç»œç¼–ç¨‹"
- "TCP/IPåè®®"
- "Socketç¼–ç¨‹"
- "UDP"
- "IPåœ°å€"
- "ç«¯å£å·"
- "ä¸‰æ¬¡æ¡æ‰‹"
ç›¸å…³æ–‡ç« :
- "[[2_â€»TCPæˆ–IPåè®®åˆ†å±‚æ¨¡å‹]]"
æ–‡ç« åˆ†ç±»: "ğŸ’» ç¼–ç¨‹è¯­è¨€"
æ–‡ç« è·¯å¾„: "02-ğŸ’» ç¼–ç¨‹è¯­è¨€/01-â˜• JavaæŠ€æœ¯æ ˆ/02-ğŸ“š åŸºç¡€è¯­æ³•/1_JavaåŸºç¡€/15_ç½‘ç»œç¼–ç¨‹.md"
æ–‡ç« éš¾åº¦: ä¸­çº§ ğŸŒ³
ç›®å‰é˜¶æ®µ: âœ… å·²å®Œæˆ
é‡è¦æ€§: â­â­â­â­â­ ç²¾é€šå¿…å¤‡
åˆ›å»ºæ—¶é—´: 2024-08-11 18:15:12
ä¿®æ”¹æ—¶é—´: 2025-05-27 21:36:04
---

## 1 æœ¬ç« ä¸“é¢˜ä¸è„‰ç»œ

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/c87bf1b29af13fa236db0aaee4e26e59.png)

## 2 ç½‘ç»œç¼–ç¨‹æ¦‚è¿°

Javaæ˜¯ Internet ä¸Šçš„è¯­è¨€ï¼Œå®ƒä»è¯­è¨€çº§ä¸Šæä¾›äº†å¯¹ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ”¯æŒï¼Œç¨‹åºå‘˜èƒ½å¤Ÿå¾ˆå®¹æ˜“å¼€å‘å¸¸è§çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚

Javaæä¾›çš„ç½‘ç»œç±»åº“ï¼Œå¯ä»¥å®ç°æ— ç—›çš„ç½‘ç»œè¿æ¥ï¼Œè”ç½‘çš„åº•å±‚ç»†èŠ‚è¢«éšè—åœ¨ Java çš„æœ¬æœºå®‰è£…ç³»ç»Ÿé‡Œï¼Œç”± JVM è¿›è¡Œæ§åˆ¶ã€‚å¹¶ä¸” Java å®ç°äº†ä¸€ä¸ªè·¨å¹³å°çš„ç½‘ç»œåº“ï¼Œ`ç¨‹åºå‘˜é¢å¯¹çš„æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œç¼–ç¨‹ç¯å¢ƒ`ã€‚

### 2.1 è½¯ä»¶æ¶æ„

- **C/Sæ¶æ„** ï¼šå…¨ç§°ä¸ºClient/Serverç»“æ„ï¼Œæ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç»“æ„ã€‚å¸¸è§ç¨‹åºæœ‰QQã€ç¾å›¢appã€360å®‰å…¨å«å£«ç­‰è½¯ä»¶ã€‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/93e9966854e9861b247ecab59aeb2860.png)


**B/Sæ¶æ„** ï¼šå…¨ç§°ä¸ºBrowser/Serverç»“æ„ï¼Œæ˜¯æŒ‡æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç»“æ„ã€‚å¸¸è§æµè§ˆå™¨æœ‰IEã€è°·æ­Œã€ç«ç‹ç­‰ã€‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/c9cfbf3e3f90a2cefe8ad25b6573de23.png)


ä¸¤ç§æ¶æ„å„æœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯æ— è®ºå“ªç§æ¶æ„ï¼Œéƒ½ç¦»ä¸å¼€ç½‘ç»œçš„æ”¯æŒã€‚**ç½‘ç»œç¼–ç¨‹**ï¼Œå°±æ˜¯åœ¨ä¸€å®šçš„åè®®ä¸‹ï¼Œå®ç°ä¸¤å°è®¡ç®—æœºçš„é€šä¿¡çš„ç¨‹åºã€‚

### 2.2 ç½‘ç»œåŸºç¡€

- **è®¡ç®—æœºç½‘ç»œï¼š**
  æŠŠåˆ†å¸ƒåœ¨ä¸åŒåœ°ç†åŒºåŸŸçš„è®¡ç®—æœºä¸ä¸“é—¨çš„å¤–éƒ¨è®¾å¤‡ç”¨é€šä¿¡çº¿è·¯äº’è¿æˆä¸€ä¸ªè§„æ¨¡å¤§ã€åŠŸèƒ½å¼ºçš„ç½‘ç»œç³»ç»Ÿï¼Œä»è€Œä½¿ä¼—å¤šçš„è®¡ç®—æœºå¯ä»¥æ–¹ä¾¿åœ°äº’ç›¸ä¼ é€’ä¿¡æ¯ã€å…±äº«ç¡¬ä»¶ã€è½¯ä»¶ã€æ•°æ®ä¿¡æ¯ç­‰èµ„æºã€‚

- **ç½‘ç»œç¼–ç¨‹çš„ç›®çš„ï¼š** ç›´æ¥æˆ–é—´æ¥åœ°é€šè¿‡ç½‘ç»œåè®®ä¸å…¶å®ƒè®¡ç®—æœºå®ç°æ•°æ®äº¤æ¢ï¼Œè¿›è¡Œé€šè®¯ã€‚

- **ç½‘ç»œç¼–ç¨‹ä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„é—®é¢˜ï¼š**
  - é—®é¢˜1ï¼šå¦‚ä½•å‡†ç¡®åœ°å®šä½ç½‘ç»œä¸Šä¸€å°æˆ–å¤šå°ä¸»æœº
  - é—®é¢˜2ï¼šå¦‚ä½•å®šä½ä¸»æœºä¸Šçš„ç‰¹å®šçš„åº”ç”¨
  - é—®é¢˜3ï¼šæ‰¾åˆ°ä¸»æœºåï¼Œå¦‚ä½•å¯é ã€é«˜æ•ˆåœ°è¿›è¡Œæ•°æ®ä¼ è¾“
## 3 ç½‘ç»œé€šä¿¡è¦ç´ 

### 3.1 å¦‚ä½•å®ç°ç½‘ç»œä¸­çš„ä¸»æœºäº’ç›¸é€šä¿¡

- é€šä¿¡åŒæ–¹åœ°å€
  - IP
  - ç«¯å£å·
- ä¸€å®šçš„è§„åˆ™ï¼šä¸åŒçš„ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œæ‰€æœ‰çš„è¿™ä¸€åˆ‡éƒ½éœ€è¦ä¸€ç§è§„åˆ™ã€‚è€Œæˆ‘ä»¬å°±æŠŠè¿™ç§è§„åˆ™ç§°ä¸ºåè®®ï¼Œå³ç½‘ç»œé€šä¿¡åè®®ã€‚

### 3.2 é€šä¿¡è¦ç´ ä¸€ï¼šIPåœ°å€å’ŒåŸŸå

#### 3.2.1 IPåœ°å€

**IPåœ°å€ï¼šæŒ‡äº’è”ç½‘åè®®åœ°å€ï¼ˆInternet Protocol Addressï¼‰**ï¼Œä¿—ç§°IPã€‚IPåœ°å€ç”¨æ¥ç»™ç½‘ç»œä¸­çš„ä¸€å°è®¡ç®—æœºè®¾å¤‡åšå”¯ä¸€çš„ç¼–å·ã€‚å‡å¦‚æˆ‘ä»¬æŠŠâ€œä¸ªäººç”µè„‘â€æ¯”ä½œâ€œä¸€å°ç”µè¯â€çš„è¯ï¼Œé‚£ä¹ˆâ€œIPåœ°å€â€å°±ç›¸å½“äºâ€œç”µè¯å·ç â€ã€‚

**IPåœ°å€åˆ†ç±»æ–¹å¼ä¸€ï¼š**

- `IPv4`ï¼šæ˜¯ä¸€ä¸ª32ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸è¢«åˆ†ä¸º4ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºæˆ`a.b.c.d` çš„å½¢å¼ï¼Œä»¥ç‚¹åˆ†`åè¿›åˆ¶`è¡¨ç¤ºï¼Œä¾‹å¦‚`192.168.65.100` ã€‚å…¶ä¸­aã€bã€cã€déƒ½æ˜¯0~255ä¹‹é—´çš„åè¿›åˆ¶æ•´æ•°ã€‚
	![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/2197da435be0e6d3f299a825c11c426d.png)

  - è¿™ç§æ–¹å¼æœ€å¤šå¯ä»¥è¡¨ç¤º42äº¿ä¸ªã€‚å…¶ä¸­ï¼Œ30äº¿éƒ½åœ¨åŒ—ç¾ï¼Œäºšæ´²4äº¿ï¼Œä¸­å›½2.9äº¿ã€‚2011å¹´åˆå·²ç»ç”¨å°½ã€‚

  - IPåœ°å€ = ç½‘ç»œåœ°å€ +ä¸»æœºåœ°å€
    - ç½‘ç»œåœ°å€ï¼šæ ‡è¯†è®¡ç®—æœºæˆ–ç½‘ç»œè®¾å¤‡æ‰€åœ¨çš„ç½‘æ®µ
    - ä¸»æœºåœ°å€ï¼šæ ‡è¯†ç‰¹å®šä¸»æœºæˆ–ç½‘ç»œè®¾å¤‡
    ![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/119358e020a903ee587e73248c01ed8b.png)
    å…¶ä¸­ï¼ŒEç±»ç”¨äºç§‘ç ”ã€‚

- `IPv6`ï¼šç”±äºäº’è”ç½‘çš„è“¬å‹ƒå‘å±•ï¼ŒIPåœ°å€çš„éœ€æ±‚é‡æ„ˆæ¥æ„ˆå¤§ï¼Œä½†æ˜¯ç½‘ç»œåœ°å€èµ„æºæœ‰é™ï¼Œä½¿å¾—IPçš„åˆ†é…è¶Šå‘ç´§å¼ ã€‚

  ä¸ºäº†æ‰©å¤§åœ°å€ç©ºé—´ï¼Œæ‹Ÿé€šè¿‡IPv6é‡æ–°å®šä¹‰åœ°å€ç©ºé—´ï¼Œé‡‡ç”¨128ä½åœ°å€é•¿åº¦ï¼Œå…±16ä¸ªå­—èŠ‚ï¼Œå†™æˆ8ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œæ¯ä¸ªæ•´æ•°ç”¨å››ä¸ªåå…­è¿›åˆ¶ä½è¡¨ç¤ºï¼Œæ•°ä¹‹é—´ç”¨å†’å·ï¼ˆï¼šï¼‰åˆ†å¼€ã€‚æ¯”å¦‚ï¼š`ABCD:EF01:2345:6789:ABCD:EF01:2345:6789`ï¼ŒæŒ‰ä¿å®ˆæ–¹æ³•ä¼°ç®—IPv6å®é™…å¯åˆ†é…çš„åœ°å€ï¼Œæ•´ä¸ªåœ°çƒçš„æ¯å¹³æ–¹ç±³é¢ç§¯ä¸Šä»å¯åˆ†é…1000å¤šä¸ªåœ°å€ï¼Œè¿™æ ·å°±è§£å†³äº†ç½‘ç»œåœ°å€èµ„æºæ•°é‡ä¸å¤Ÿçš„é—®é¢˜ã€‚2012å¹´6æœˆ6æ—¥ï¼Œå›½é™…äº’è”ç½‘åä¼šä¸¾è¡Œäº†ä¸–ç•ŒIPv6å¯åŠ¨çºªå¿µæ—¥ï¼Œè¿™ä¸€å¤©ï¼Œå…¨çƒIPv6ç½‘ç»œæ­£å¼å¯åŠ¨ã€‚å¤šå®¶çŸ¥åç½‘ç«™ï¼Œå¦‚Googleã€Facebookå’ŒYahooç­‰ï¼Œäºå½“å¤©å…¨çƒæ ‡å‡†æ—¶é—´0ç‚¹ï¼ˆåŒ—äº¬æ—¶é—´8ç‚¹æ•´ï¼‰å¼€å§‹æ°¸ä¹…æ€§æ”¯æŒIPv6è®¿é—®ã€‚2018å¹´6æœˆï¼Œä¸‰å¤§è¿è¥å•†è”åˆé˜¿é‡Œäº‘å®£å¸ƒï¼Œå°†å…¨é¢å¯¹å¤–æä¾›IPv6æœåŠ¡ï¼Œå¹¶è®¡åˆ’åœ¨2025å¹´å‰åŠ©æ¨ä¸­å›½äº’è”ç½‘çœŸæ­£å®ç°â€œIPv6 Onlyâ€ã€‚
  
  åœ¨IPv6çš„è®¾è®¡è¿‡ç¨‹ä¸­é™¤äº†ä¸€åŠ³æ°¸é€¸åœ°è§£å†³äº†åœ°å€çŸ­ç¼ºé—®é¢˜ä»¥å¤–ï¼Œè¿˜è€ƒè™‘äº†åœ¨IPv4ä¸­è§£å†³ä¸å¥½çš„å…¶å®ƒé—®é¢˜ï¼Œä¸»è¦æœ‰ç«¯åˆ°ç«¯IPè¿æ¥ã€æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰ã€å®‰å…¨æ€§ã€å¤šæ’­ã€ç§»åŠ¨æ€§ã€å³æ’å³ç”¨ç­‰ã€‚

**IPåœ°å€åˆ†ç±»æ–¹å¼äºŒï¼š**

å…¬ç½‘åœ°å€( ä¸‡ç»´ç½‘ä½¿ç”¨ï¼‰å’Œ ç§æœ‰åœ°å€( å±€åŸŸç½‘ä½¿ç”¨ï¼‰ã€‚192.168.å¼€å¤´çš„å°±æ˜¯ç§æœ‰åœ°å€ï¼ŒèŒƒå›´å³ä¸º192.168.0.0--192.168.255.255ï¼Œä¸“é—¨ä¸ºç»„ç»‡æœºæ„å†…éƒ¨ä½¿ç”¨ã€‚

**å¸¸ç”¨å‘½ä»¤ï¼š**

- æŸ¥çœ‹æœ¬æœºIPåœ°å€ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼š

```java
ipconfig
```

- æ£€æŸ¥ç½‘ç»œæ˜¯å¦è¿é€šï¼Œåœ¨æ§åˆ¶å°è¾“å…¥ï¼š

```java
ping ç©ºæ ¼ IPåœ°å€
ping 220.181.57.216
```

**ç‰¹æ®Šçš„IPåœ°å€ï¼š**

- æœ¬åœ°å›ç¯åœ°å€(hostAddress)ï¼š`127.0.0.1`  
- ä¸»æœºå(hostName)ï¼š`localhost`

#### 3.2.2 åŸŸå

Internetä¸Šçš„ä¸»æœºæœ‰ä¸¤ç§æ–¹å¼è¡¨ç¤ºåœ°å€ï¼š

- åŸŸå(hostName)ï¼šwww.atguigu.com
- IP åœ°å€(hostAddress)ï¼š202.108.35.210

**åŸŸåè§£æï¼š** å› ä¸ºIPåœ°å€æ•°å­—ä¸ä¾¿äºè®°å¿†ï¼Œå› æ­¤å‡ºç°äº†åŸŸåã€‚åŸŸåå®¹æ˜“è®°å¿†ï¼Œå½“åœ¨è¿æ¥ç½‘ç»œæ—¶è¾“å…¥ä¸€ä¸ªä¸»æœºçš„åŸŸååï¼ŒåŸŸåæœåŠ¡å™¨(DNSï¼ŒDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿ)è´Ÿè´£å°†åŸŸåè½¬åŒ–æˆIPåœ°å€ï¼Œè¿™æ ·æ‰èƒ½å’Œä¸»æœºå»ºç«‹è¿æ¥ã€‚ 

ç®€å•ç†è§£ï¼š
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/a00898f698b442b1dd0148835f7a7239.png)


è¯¦ç»†ç†è§£ï¼š
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/68a0656ff2f93f11371e46c3c98685fa.png)


1. åœ¨æµè§ˆå™¨ä¸­è¾“å…¥www . qq .com åŸŸåï¼Œæ“ä½œç³»ç»Ÿä¼šå…ˆæ£€æŸ¥è‡ªå·±æœ¬åœ°çš„`hostsæ–‡ä»¶`æ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œå°±å…ˆè°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æã€‚
2. å¦‚æœhostsé‡Œæ²¡æœ‰è¿™ä¸ªåŸŸåçš„æ˜ å°„ï¼Œåˆ™æŸ¥æ‰¾`æœ¬åœ°DNSè§£æå™¨ç¼“å­˜`ï¼Œæ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ï¼Œå®ŒæˆåŸŸåè§£æã€‚
3. å¦‚æœhostsä¸æœ¬åœ°DNSè§£æå™¨ç¼“å­˜éƒ½æ²¡æœ‰ç›¸åº”çš„ç½‘å€æ˜ å°„å…³ç³»ï¼Œé¦–å…ˆä¼šæ‰¾TCP/IPå‚æ•°ä¸­è®¾ç½®çš„é¦–é€‰DNSæœåŠ¡å™¨ï¼Œåœ¨æ­¤æˆ‘ä»¬å«å®ƒ`æœ¬åœ°DNSæœåŠ¡å™¨`ï¼Œæ­¤æœåŠ¡å™¨æ”¶åˆ°æŸ¥è¯¢æ—¶ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼ŒåŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æï¼Œæ­¤è§£æå…·æœ‰æƒå¨æ€§ã€‚
4. å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼Œä¸ç”±æœ¬åœ°DNSæœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²`ç¼“å­˜`äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æï¼Œæ­¤è§£æä¸å…·æœ‰æƒå¨æ€§ã€‚
5. å¦‚æœæœ¬åœ°DNSæœåŠ¡å™¨æœ¬åœ°åŒºåŸŸæ–‡ä»¶ä¸ç¼“å­˜è§£æéƒ½å¤±æ•ˆï¼Œåˆ™æ ¹æ®æœ¬åœ°DNSæœåŠ¡å™¨çš„è®¾ç½®ï¼ˆæ˜¯å¦è®¾ç½®è½¬å‘å™¨ï¼‰è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæœªç”¨è½¬å‘æ¨¡å¼ï¼Œæœ¬åœ°DNSå°±æŠŠè¯·æ±‚å‘è‡³13å°æ ¹DNSï¼Œæ ¹DNSæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åä¼šåˆ¤æ–­è¿™ä¸ªåŸŸå(.com)æ˜¯è°æ¥æˆæƒç®¡ç†ï¼Œå¹¶ä¼šè¿”å›ä¸€ä¸ªè´Ÿè´£è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ä¸€ä¸ªIPã€‚æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°IPä¿¡æ¯åï¼Œå°†ä¼šè”ç³»è´Ÿè´£.comåŸŸçš„è¿™å°æœåŠ¡å™¨ã€‚è¿™å°è´Ÿè´£.comåŸŸçš„æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå¦‚æœè‡ªå·±æ— æ³•è§£æï¼Œå®ƒå°±ä¼šæ‰¾ä¸€ä¸ªç®¡ç†.comåŸŸçš„ä¸‹ä¸€çº§DNSæœåŠ¡å™¨åœ°å€(http://qq.com)ç»™æœ¬åœ°DNSæœåŠ¡å™¨ã€‚å½“æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªåœ°å€åï¼Œå°±ä¼šæ‰¾ï¼ˆhttp://qq.com)åŸŸæœåŠ¡å™¨ï¼Œé‡å¤ä¸Šé¢çš„åŠ¨ä½œï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œç›´è‡³æ‰¾åˆ°www.qq.comä¸»æœºã€‚
6. å¦‚æœç”¨çš„æ˜¯è½¬å‘æ¨¡å¼ï¼Œæ­¤DNSæœåŠ¡å™¨å°±ä¼šæŠŠè¯·æ±‚è½¬å‘è‡³ä¸Šä¸€çº§DNSæœåŠ¡å™¨ï¼Œç”±ä¸Šä¸€çº§æœåŠ¡å™¨è¿›è¡Œè§£æï¼Œä¸Šä¸€çº§æœåŠ¡å™¨å¦‚æœä¸èƒ½è§£æï¼Œæˆ–æ‰¾æ ¹DNSæˆ–æŠŠè½¬è¯·æ±‚è½¬è‡³ä¸Šä¸Šçº§ï¼Œä»¥æ­¤å¾ªç¯ã€‚ä¸ç®¡æ˜¯æœ¬åœ°DNSæœåŠ¡å™¨ç”¨æ˜¯æ˜¯è½¬å‘ï¼Œè¿˜æ˜¯æ ¹æç¤ºï¼Œæœ€åéƒ½æ˜¯æŠŠç»“æœè¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œç”±æ­¤DNSæœåŠ¡å™¨å†è¿”å›ç»™å®¢æˆ·æœºã€‚

### 3.3 é€šä¿¡è¦ç´ äºŒï¼šç«¯å£å·

ç½‘ç»œçš„é€šä¿¡ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸¤ä¸ªè¿›ç¨‹ï¼ˆåº”ç”¨ç¨‹åºï¼‰çš„é€šä¿¡ã€‚æ¯å°è®¡ç®—æœºéƒ½æœ‰å¾ˆå¤šçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆåœ¨ç½‘ç»œé€šä¿¡æ—¶ï¼Œå¦‚ä½•åŒºåˆ†è¿™äº›è¿›ç¨‹å‘¢ï¼Ÿ

å¦‚æœè¯´**IPåœ°å€**å¯ä»¥å”¯ä¸€æ ‡è¯†ç½‘ç»œä¸­çš„è®¾å¤‡ï¼Œé‚£ä¹ˆ**ç«¯å£å·**å°±å¯ä»¥å”¯ä¸€æ ‡è¯†è®¾å¤‡ä¸­çš„è¿›ç¨‹ï¼ˆåº”ç”¨ç¨‹åºï¼‰ã€‚

ä¸åŒçš„è¿›ç¨‹ï¼Œè®¾ç½®ä¸åŒçš„ç«¯å£å·ã€‚

- **ç«¯å£å·ï¼šç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºçš„æ•´æ•°ï¼Œå®ƒçš„å–å€¼èŒƒå›´æ˜¯0~65535**ã€‚
  - å…¬è®¤ç«¯å£ï¼š0~1023ã€‚è¢«é¢„å…ˆå®šä¹‰çš„æœåŠ¡é€šä¿¡å ç”¨ï¼Œå¦‚ï¼šHTTPï¼ˆ80ï¼‰ï¼ŒFTPï¼ˆ21ï¼‰ï¼ŒTelnetï¼ˆ23ï¼‰
  - æ³¨å†Œç«¯å£ï¼š1024~49151ã€‚åˆ†é…ç»™ç”¨æˆ·è¿›ç¨‹æˆ–åº”ç”¨ç¨‹åºã€‚å¦‚ï¼šTomcatï¼ˆ8080ï¼‰ï¼ŒMySQLï¼ˆ3306ï¼‰ï¼ŒOracleï¼ˆ1521ï¼‰ã€‚
  - åŠ¨æ€/ ç§æœ‰ç«¯å£ï¼š49152~65535ã€‚

å¦‚æœç«¯å£å·è¢«å¦å¤–ä¸€ä¸ªæœåŠ¡æˆ–åº”ç”¨æ‰€å ç”¨ï¼Œä¼šå¯¼è‡´å½“å‰ç¨‹åºå¯åŠ¨å¤±è´¥ã€‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/871fada6c58f92eab986b66b5cad95b5.png)

### 3.4 é€šä¿¡è¦ç´ ä¸‰ï¼šç½‘ç»œé€šä¿¡åè®®

é€šè¿‡è®¡ç®—æœºç½‘ç»œå¯ä»¥ä½¿å¤šå°è®¡ç®—æœºå®ç°è¿æ¥ï¼Œä½äºåŒä¸€ä¸ªç½‘ç»œä¸­çš„è®¡ç®—æœºåœ¨è¿›è¡Œè¿æ¥å’Œé€šä¿¡æ—¶éœ€è¦éµå®ˆä¸€å®šçš„è§„åˆ™ï¼Œè¿™å°±å¥½æ¯”åœ¨é“è·¯ä¸­è¡Œé©¶çš„æ±½è½¦ä¸€å®šè¦éµå®ˆäº¤é€šè§„åˆ™ä¸€æ ·ã€‚

- `ç½‘ç»œé€šä¿¡åè®®`ï¼šåœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œè¿™äº›è¿æ¥å’Œé€šä¿¡çš„è§„åˆ™è¢«ç§°ä¸ºç½‘ç»œé€šä¿¡åè®®ï¼Œå®ƒå¯¹æ•°æ®çš„ä¼ è¾“æ ¼å¼ã€ä¼ è¾“é€Ÿç‡ã€ä¼ è¾“æ­¥éª¤ã€å‡ºé”™æ§åˆ¶ç­‰åšäº†ç»Ÿä¸€è§„å®šï¼Œé€šä¿¡åŒæ–¹å¿…é¡»åŒæ—¶éµå®ˆæ‰èƒ½å®Œæˆæ•°æ®äº¤æ¢ã€‚

**æ–°çš„é—®é¢˜ï¼šç½‘ç»œåè®®æ¶‰åŠå†…å®¹å¤ªå¤šã€å¤ªå¤æ‚ã€‚å¦‚ä½•è§£å†³ï¼Ÿ**

è®¡ç®—æœºç½‘ç»œé€šä¿¡æ¶‰åŠå†…å®¹å¾ˆå¤šï¼Œæ¯”å¦‚æŒ‡å®šæºåœ°å€å’Œç›®æ ‡åœ°å€ï¼ŒåŠ å¯†è§£å¯†ï¼Œå‹ç¼©è§£å‹ç¼©ï¼Œå·®é”™æ§åˆ¶ï¼Œæµé‡æ§åˆ¶ï¼Œè·¯ç”±æ§åˆ¶ï¼Œå¦‚ä½•å®ç°å¦‚æ­¤å¤æ‚çš„ç½‘ç»œåè®®å‘¢ï¼Ÿ`é€šä¿¡åè®®åˆ†å±‚æ€æƒ³`ã€‚

åœ¨åˆ¶å®šåè®®æ—¶ï¼ŒæŠŠå¤æ‚æˆä»½åˆ†è§£æˆä¸€äº›ç®€å•çš„æˆä»½ï¼Œå†å°†å®ƒä»¬å¤åˆèµ·æ¥ã€‚æœ€å¸¸ç”¨çš„å¤åˆæ–¹å¼æ˜¯å±‚æ¬¡æ–¹å¼ï¼Œå³`åŒå±‚é—´å¯ä»¥é€šä¿¡ã€ä¸Šä¸€å±‚å¯ä»¥è°ƒç”¨ä¸‹ä¸€å±‚ï¼Œè€Œä¸å†ä¸‹ä¸€å±‚ä¸å‘ç”Ÿå…³ç³»`ã€‚å„å±‚äº’ä¸å½±å“ï¼Œåˆ©äºç³»ç»Ÿçš„å¼€å‘å’Œæ‰©å±•ã€‚

è¿™é‡Œæœ‰ä¸¤å¥—å‚è€ƒæ¨¡å‹

- OSIå‚è€ƒæ¨¡å‹ï¼šæ¨¡å‹è¿‡äºç†æƒ³åŒ–ï¼Œæœªèƒ½åœ¨å› ç‰¹ç½‘ä¸Šè¿›è¡Œå¹¿æ³›æ¨å¹¿
- TCP/IPå‚è€ƒæ¨¡å‹(æˆ–TCP/IPåè®®)ï¼šäº‹å®ä¸Šçš„å›½é™…æ ‡å‡†ã€‚
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/ef7d6aeeb9ed4a8c2ad033fc9a05d196.png)


ä¸Šå›¾ä¸­ï¼ŒOSIå‚è€ƒæ¨¡å‹ï¼šæ¨¡å‹`è¿‡äºç†æƒ³åŒ–`ï¼Œæœªèƒ½åœ¨å› ç‰¹ç½‘ä¸Šè¿›è¡Œå¹¿æ³›æ¨å¹¿ã€‚ TCP/IPå‚è€ƒæ¨¡å‹(æˆ–TCP/IPåè®®)ï¼šäº‹å®ä¸Šçš„`å›½é™…æ ‡å‡†`ã€‚

- **TCP/IPåè®®ï¼š** ä¼ è¾“æ§åˆ¶åè®®/å› ç‰¹ç½‘äº’è”åè®®( Transmission Control Protocol/Internet Protocol)ï¼ŒTCP/IP ä»¥å…¶ä¸¤ä¸ªä¸»è¦åè®®ï¼šä¼ è¾“æ§åˆ¶åè®®(TCP)å’Œç½‘ç»œäº’è”åè®®(IP)è€Œå¾—åï¼Œå®é™…ä¸Šæ˜¯ä¸€ç»„åè®®ï¼ŒåŒ…æ‹¬å¤šä¸ªå…·æœ‰ä¸åŒåŠŸèƒ½ä¸”äº’ä¸ºå…³è”çš„åè®®ã€‚æ˜¯Internetæœ€åŸºæœ¬ã€æœ€å¹¿æ³›çš„åè®®ã€‚
  ![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/bbe6214526b81f65afb842ab3beeedaa.png)

**TCP/IPåè®®ä¸­çš„å››å±‚ä»‹ç»ï¼š**

- `åº”ç”¨å±‚`ï¼šåº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶é€šä¿¡çš„æ´»åŠ¨ã€‚ä¸»è¦åè®®æœ‰ï¼šHTTPåè®®ã€FTPåè®®ã€SNMPï¼ˆç®€å•ç½‘ç»œç®¡ç†åè®®ï¼‰ã€SMTPï¼ˆç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰å’ŒPOP3ï¼ˆPost Office Protocol 3çš„ç®€ç§°,å³é‚®å±€åè®®çš„ç¬¬3ä¸ªç‰ˆï¼‰ç­‰ã€‚
- `ä¼ è¾“å±‚`ï¼šä¸»è¦ä½¿ç½‘ç»œç¨‹åºè¿›è¡Œé€šä¿¡ï¼Œåœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå¯ä»¥é‡‡ç”¨TCPåè®®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨UDPåè®®ã€‚TCPï¼ˆTransmission Control Protocolï¼‰åè®®ï¼Œå³ä¼ è¾“æ§åˆ¶åè®®ï¼Œæ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚UDP(User Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®)ï¼šæ˜¯ä¸€ä¸ªæ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€æä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é çš„ä¿¡æ¯ä¼ é€æœåŠ¡ã€‚
- `ç½‘ç»œå±‚`ï¼šç½‘ç»œå±‚æ˜¯æ•´ä¸ªTCP/IPåè®®çš„æ ¸å¿ƒï¼Œæ”¯æŒç½‘é—´äº’è¿çš„æ•°æ®é€šä¿¡ã€‚å®ƒä¸»è¦ç”¨äºå°†ä¼ è¾“çš„æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå°†åˆ†ç»„æ•°æ®å‘é€åˆ°ç›®æ ‡è®¡ç®—æœºæˆ–è€…ç½‘ç»œã€‚è€ŒIPåè®®æ˜¯ä¸€ç§éå¸¸é‡è¦çš„åè®®ã€‚IPï¼ˆinternet protocalï¼‰åˆç§°ä¸ºäº’è”ç½‘åè®®ã€‚IPçš„è´£ä»»å°±æ˜¯æŠŠæ•°æ®ä»æºä¼ é€åˆ°ç›®çš„åœ°ã€‚å®ƒåœ¨æºåœ°å€å’Œç›®çš„åœ°å€ä¹‹é—´ä¼ é€ä¸€ç§ç§°ä¹‹ä¸ºæ•°æ®åŒ…çš„ä¸œè¥¿ï¼Œå®ƒè¿˜æä¾›å¯¹æ•°æ®å¤§å°çš„é‡æ–°ç»„è£…åŠŸèƒ½ï¼Œä»¥é€‚åº”ä¸åŒç½‘ç»œå¯¹åŒ…å¤§å°çš„è¦æ±‚ã€‚

* `ç‰©ç†+æ•°æ®é“¾è·¯å±‚`ï¼šé“¾è·¯å±‚æ˜¯ç”¨äºå®šä¹‰ç‰©ç†ä¼ è¾“é€šé“ï¼Œé€šå¸¸æ˜¯å¯¹æŸäº›ç½‘ç»œè¿æ¥è®¾å¤‡çš„é©±åŠ¨åè®®ï¼Œä¾‹å¦‚é’ˆå¯¹å…‰çº¤ã€ç½‘çº¿æä¾›çš„é©±åŠ¨ã€‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/be49d9bdcc53672e90dd720fd702e367.png)


## 4 è°ˆä¼ è¾“å±‚åè®®ï¼šTCPä¸UDPåè®®

é€šä¿¡çš„åè®®è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œ`java.net` åŒ…ä¸­åŒ…å«çš„ç±»å’Œæ¥å£ï¼Œå®ƒä»¬æä¾›ä½å±‚æ¬¡çš„é€šä¿¡ç»†èŠ‚ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›ç±»å’Œæ¥å£ï¼Œæ¥ä¸“æ³¨äºç½‘ç»œç¨‹åºå¼€å‘ï¼Œè€Œä¸ç”¨è€ƒè™‘é€šä¿¡çš„ç»†èŠ‚ã€‚

`java.net` åŒ…ä¸­æä¾›äº†ä¸¤ç§å¸¸è§çš„ç½‘ç»œåè®®çš„æ”¯æŒï¼š

- **UDP**ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®(User Datagram Protocol)ã€‚
- **TCP**ï¼šä¼ è¾“æ§åˆ¶åè®® (Transmission Control Protocol)ã€‚

### 4.1 TCPåè®®ä¸UDPåè®®

**TCPåè®®ï¼š**

- TCPåè®®è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹ï¼šå®¢æˆ·ç«¯ã€æœåŠ¡ç«¯ã€‚
- ä½¿ç”¨TCPåè®®å‰ï¼Œé¡»å…ˆ`å»ºç«‹TCPè¿æ¥`ï¼Œå½¢æˆåŸºäºå­—èŠ‚æµçš„ä¼ è¾“æ•°æ®é€šé“
- ä¼ è¾“å‰ï¼Œé‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€æ–¹å¼ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡ï¼Œæ˜¯`å¯é çš„`
  - TCPåè®®ä½¿ç”¨`é‡å‘æœºåˆ¶`ï¼Œå½“ä¸€ä¸ªé€šä¿¡å®ä½“å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™å¦ä¸€ä¸ªé€šä¿¡å®ä½“åï¼Œéœ€è¦æ”¶åˆ°å¦ä¸€ä¸ªé€šä¿¡å®ä½“ç¡®è®¤ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°å¦ä¸€ä¸ªé€šä¿¡å®ä½“ç¡®è®¤ä¿¡æ¯ï¼Œåˆ™ä¼šå†æ¬¡é‡å¤åˆšæ‰å‘é€çš„æ¶ˆæ¯ã€‚
- åœ¨è¿æ¥ä¸­å¯è¿›è¡Œ`å¤§æ•°æ®é‡çš„ä¼ è¾“`
- ä¼ è¾“å®Œæ¯•ï¼Œéœ€`é‡Šæ”¾å·²å»ºç«‹çš„è¿æ¥ï¼Œæ•ˆç‡ä½`

**UDPåè®®ï¼š**

- UDPåè®®è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹ï¼šå‘é€ç«¯ã€æ¥æ”¶ç«¯ã€‚
- å°†æ•°æ®ã€æºã€ç›®çš„å°è£…æˆæ•°æ®åŒ…ï¼ˆä¼ è¾“çš„åŸºæœ¬å•ä½ï¼‰ï¼Œ`ä¸éœ€è¦å»ºç«‹è¿æ¥`
- å‘é€ä¸ç®¡å¯¹æ–¹æ˜¯å¦å‡†å¤‡å¥½ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°ä¹Ÿä¸ç¡®è®¤ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ•…æ˜¯`ä¸å¯é çš„`
- æ¯ä¸ªæ•°æ®æŠ¥çš„å¤§å°é™åˆ¶åœ¨`64K`å†…
- å‘é€æ•°æ®ç»“æŸæ—¶`æ— éœ€é‡Šæ”¾èµ„æºï¼Œå¼€é”€å°ï¼Œé€šä¿¡æ•ˆç‡é«˜`
- é€‚ç”¨åœºæ™¯ï¼šéŸ³é¢‘ã€è§†é¢‘å’Œæ™®é€šæ•°æ®çš„ä¼ è¾“ã€‚ä¾‹å¦‚è§†é¢‘ä¼šè®®

> TCPç”Ÿæ´»æ¡ˆä¾‹ï¼šæ‰“ç”µè¯
>
> UDPç”Ÿæ´»æ¡ˆä¾‹ï¼šå‘é€çŸ­ä¿¡ã€å‘ç”µæŠ¥

### 4.2 ä¸‰æ¬¡æ¡æ‰‹

TCPåè®®ä¸­ï¼Œåœ¨å‘é€æ•°æ®çš„å‡†å¤‡é˜¶æ®µï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ä¸‰æ¬¡äº¤äº’ï¼Œä»¥ä¿è¯è¿æ¥çš„å¯é ã€‚

- ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘èµ·TCPè¿æ¥çš„è¯·æ±‚
- ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨ç«¯å‘é€é’ˆå¯¹å®¢æˆ·ç«¯TCPè¿æ¥è¯·æ±‚çš„ç¡®è®¤
- ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘é€ç¡®è®¤çš„ç¡®è®¤

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/e5f81a72edce4d9b2b893dd5eed3075f.png)



> 1ã€å®¢æˆ·ç«¯ä¼šéšæœºä¸€ä¸ªåˆå§‹åºåˆ—å·seq=xï¼Œè®¾ç½®SYN=1 ï¼Œè¡¨ç¤ºè¿™æ˜¯SYNæ¡æ‰‹æŠ¥æ–‡ã€‚ç„¶åå°±å¯ä»¥æŠŠè¿™ä¸ª SYN æŠ¥æ–‡å‘é€ç»™æœåŠ¡ç«¯äº†ï¼Œè¡¨ç¤ºå‘æœåŠ¡ç«¯å‘èµ·è¿æ¥ï¼Œä¹‹åå®¢æˆ·ç«¯å¤„äº`åŒæ­¥å·²å‘é€`çŠ¶æ€ã€‚
>
> 2ã€æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡åï¼Œä¹Ÿéšæœºä¸€ä¸ªåˆå§‹åºåˆ—å·(seq=y)ï¼Œè®¾ç½®ack=x+1ï¼Œè¡¨ç¤ºæ”¶åˆ°äº†å®¢æˆ·ç«¯çš„xä¹‹å‰çš„æ•°æ®ï¼Œå¸Œæœ›å®¢æˆ·ç«¯ä¸‹æ¬¡å‘é€çš„æ•°æ®ä»x+1å¼€å§‹ã€‚
> è®¾ç½® SYN=1 å’Œ ACK=1ã€‚è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªSYNæ¡æ‰‹å’ŒACKç¡®è®¤åº”ç­”æŠ¥æ–‡ã€‚æœ€åæŠŠè¯¥æŠ¥æ–‡å‘ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æŠ¥æ–‡ä¹Ÿä¸åŒ…å«åº”ç”¨å±‚æ•°æ®ï¼Œä¹‹åæœåŠ¡ç«¯å¤„äº`åŒæ­¥å·²æ¥æ”¶`çŠ¶æ€ã€‚
>
> 3ã€å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯æŠ¥æ–‡åï¼Œè¿˜è¦å‘æœåŠ¡ç«¯å›åº”æœ€åä¸€ä¸ªåº”ç­”æŠ¥æ–‡ï¼Œå°†ACKç½®ä¸º 1 ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåº”ç­”æŠ¥æ–‡
> ack=y+1 ï¼Œè¡¨ç¤ºæ”¶åˆ°äº†æœåŠ¡å™¨çš„yä¹‹å‰çš„æ•°æ®ï¼Œå¸Œæœ›æœåŠ¡å™¨ä¸‹æ¬¡å‘é€çš„æ•°æ®ä»y+1å¼€å§‹ã€‚
> æœ€åæŠŠæŠ¥æ–‡å‘é€ç»™æœåŠ¡ç«¯ï¼Œè¿™æ¬¡æŠ¥æ–‡å¯ä»¥æºå¸¦æ•°æ®ï¼Œä¹‹åå®¢æˆ·ç«¯å¤„äº è¿æ¥å·²å»ºç«‹ çŠ¶æ€ã€‚æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„åº”ç­”æŠ¥æ–‡åï¼Œä¹Ÿè¿›å…¥`è¿æ¥å·²å»ºç«‹`çŠ¶æ€ã€‚

å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿æ¥å»ºç«‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±å¯ä»¥å¼€å§‹è¿›è¡Œæ•°æ®ä¼ è¾“äº†ã€‚ç”±äºè¿™ç§é¢å‘è¿æ¥çš„ç‰¹æ€§ï¼ŒTCPåè®®å¯ä»¥ä¿è¯ä¼ è¾“æ•°æ®çš„å®‰å…¨ï¼Œæ‰€ä»¥åº”ç”¨ååˆ†å¹¿æ³›ï¼Œä¾‹å¦‚ä¸‹è½½æ–‡ä»¶ã€æµè§ˆç½‘é¡µç­‰ã€‚

### 4.3 å››æ¬¡æŒ¥æ‰‹

TCPåè®®ä¸­ï¼Œåœ¨å‘é€æ•°æ®ç»“æŸåï¼Œé‡Šæ”¾è¿æ¥æ—¶éœ€è¦ç»è¿‡å››æ¬¡æŒ¥æ‰‹ã€‚

* ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯æå‡ºç»“æŸè¿æ¥ï¼Œ`è®©æœåŠ¡å™¨åšæœ€åçš„å‡†å¤‡å·¥ä½œ`ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å¤„äºåŠå…³é—­çŠ¶æ€ï¼Œå³è¡¨ç¤ºä¸å†å‘æœåŠ¡å™¨å‘é€æ•°æ®äº†ï¼Œä½†æ˜¯è¿˜å¯ä»¥æ¥å—æ•°æ®ã€‚
* ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯é‡Šæ”¾è¿æ¥çš„è¯·æ±‚åï¼Œ`ä¼šå°†æœ€åçš„æ•°æ®å‘ç»™å®¢æˆ·ç«¯`ã€‚å¹¶å‘ŠçŸ¥ä¸Šå±‚çš„åº”ç”¨è¿›ç¨‹ä¸å†æ¥æ”¶æ•°æ®ã€‚
* ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨å‘é€å®Œæ•°æ®åï¼Œä¼šç»™å®¢æˆ·ç«¯`å‘é€ä¸€ä¸ªé‡Šæ”¾è¿æ¥çš„æŠ¥æ–‡`ã€‚é‚£ä¹ˆå®¢æˆ·ç«¯æ¥æ”¶åå°±çŸ¥é“å¯ä»¥æ­£å¼é‡Šæ”¾è¿æ¥äº†ã€‚
* ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡å™¨æœ€åçš„é‡Šæ”¾è¿æ¥æŠ¥æ–‡åï¼Œè¦`å›å¤ä¸€ä¸ªå½»åº•æ–­å¼€çš„æŠ¥æ–‡`ã€‚è¿™æ ·æœåŠ¡å™¨æ”¶åˆ°åæ‰ä¼šå½»åº•é‡Šæ”¾è¿æ¥ã€‚è¿™é‡Œå®¢æˆ·ç«¯ï¼Œå‘é€å®Œæœ€åçš„æŠ¥æ–‡åï¼Œä¼šç­‰å¾…2MSLï¼Œå› ä¸ºæœ‰å¯èƒ½æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°æœ€åçš„æŠ¥æ–‡ï¼Œé‚£ä¹ˆæœåŠ¡å™¨è¿Ÿè¿Ÿæ²¡æ”¶åˆ°ï¼Œå°±ä¼šå†æ¬¡ç»™å®¢æˆ·ç«¯å‘é€é‡Šæ”¾è¿æ¥çš„æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯åœ¨ç­‰å¾…æ—¶é—´èŒƒå›´å†…æ¥æ”¶åˆ°ï¼Œä¼šé‡æ–°å‘é€æœ€åçš„æŠ¥æ–‡ï¼Œå¹¶é‡æ–°è®¡æ—¶ã€‚å¦‚æœç­‰å¾…2MSLåï¼Œæ²¡æœ‰æ”¶åˆ°ï¼Œé‚£ä¹ˆå½»åº•æ–­å¼€ã€‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/3f82c685a2f165105cfd58144c766bde.png)


> 1ã€å®¢æˆ·ç«¯æ‰“ç®—æ–­å¼€è¿æ¥ï¼Œå‘æœåŠ¡å™¨å‘é€FINæŠ¥æ–‡(FINæ ‡è®°ä½è¢«è®¾ç½®ä¸º1ï¼Œ1è¡¨ç¤ºä¸ºFINï¼Œ0è¡¨ç¤ºä¸æ˜¯)ï¼ŒFINæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·ï¼Œä¹‹åå®¢æˆ·ç«¯è¿›å…¥FIN_WAIT_1çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ(FINæŠ¥æ–‡)ï¼ŒæŒ‡å®šåºåˆ—å·seq = uï¼Œä¸»åŠ¨å…³é—­TCPè¿æ¥ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ã€‚
>
> 2ã€æœåŠ¡å™¨æ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ(FINæŠ¥æ–‡)åï¼Œå°±å‘å®¢æˆ·ç«¯å‘é€ACKåº”ç­”æŠ¥æ–‡ï¼Œä»¥å®¢æˆ·ç«¯çš„FINæŠ¥æ–‡çš„åºåˆ—å· seq+1 ä½œä¸ºACKåº”ç­”æŠ¥æ–‡æ®µçš„ç¡®è®¤åºåˆ—å·ack = seq+1 = u + 1ã€‚æ¥ç€æœåŠ¡å™¨è¿›å…¥CLOSE_WAIT(ç­‰å¾…å…³é—­)çŠ¶æ€ï¼Œæ­¤æ—¶çš„TCPå¤„äºåŠå…³é—­çŠ¶æ€(ä¸‹é¢ä¼šè¯´ä»€ä¹ˆæ˜¯åŠå…³é—­çŠ¶æ€)ï¼Œå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥é‡Šæ”¾ã€‚å®¢æˆ·ç«¯æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨çš„ACKåº”ç­”æŠ¥æ–‡æ®µåï¼Œè¿›å…¥FIN_WAIT_2çŠ¶æ€ã€‚
>
> 3ã€æœåŠ¡å™¨ä¹Ÿæ‰“ç®—æ–­å¼€è¿æ¥ï¼Œå‘å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾(FIN)æŠ¥æ–‡æ®µï¼Œä¹‹åæœåŠ¡å™¨è¿›å…¥LASK_ACK(æœ€åç¡®è®¤)çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„ç¡®è®¤ã€‚æœåŠ¡å™¨çš„è¿æ¥é‡Šæ”¾(FIN)æŠ¥æ–‡æ®µçš„FIN=1ï¼ŒACK=1ï¼Œåºåˆ—å·seq=mï¼Œç¡®è®¤åºåˆ—å·ack=u+1ã€‚
>
> 4ã€å®¢æˆ·ç«¯æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨çš„è¿æ¥é‡Šæ”¾(FIN)æŠ¥æ–‡æ®µåï¼Œä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªACKåº”ç­”æŠ¥æ–‡æ®µï¼Œä»¥è¿æ¥é‡Šæ”¾(FIN)æŠ¥æ–‡æ®µçš„ç¡®è®¤åºå· ack ä½œä¸ºACKåº”ç­”æŠ¥æ–‡æ®µçš„åºåˆ—å· seqï¼Œä»¥è¿æ¥é‡Šæ”¾(FIN)æŠ¥æ–‡æ®µçš„åºåˆ—å· seq+1ä½œä¸ºç¡®è®¤åºå·ackã€‚
>
> ä¹‹åå®¢æˆ·ç«¯è¿›å…¥TIME_WAIT(æ—¶é—´ç­‰å¾…)çŠ¶æ€ï¼ŒæœåŠ¡å™¨æ”¶åˆ°ACKåº”ç­”æŠ¥æ–‡æ®µåï¼ŒæœåŠ¡å™¨å°±è¿›å…¥CLOSE(å…³é—­)çŠ¶æ€ï¼Œåˆ°æ­¤æœåŠ¡å™¨çš„è¿æ¥å·²ç»å®Œæˆå…³é—­ã€‚å®¢æˆ·ç«¯å¤„äºTIME_WAITçŠ¶æ€æ—¶ï¼Œæ­¤æ—¶çš„TCPè¿˜æœªé‡Šæ”¾æ‰ï¼Œéœ€è¦ç­‰å¾…2MSLåï¼Œå®¢æˆ·ç«¯æ‰è¿›å…¥CLOSEçŠ¶æ€ã€‚
>

## 5 ç½‘ç»œç¼–ç¨‹API

### 5.1 InetAddressç±»

InetAddressç±»ä¸»è¦è¡¨ç¤ºIPåœ°å€ï¼Œä¸¤ä¸ªå­ç±»ï¼šInet4Addressã€Inet6Addressã€‚

InetAddress ç±»æ²¡æœ‰æä¾›å…¬å…±çš„æ„é€ å™¨ï¼Œè€Œæ˜¯æä¾› äº† å¦‚ä¸‹å‡ ä¸ª é™æ€æ–¹æ³•æ¥è·å–InetAddress å®ä¾‹

* public static InetAddress getLocalHost()
* public static InetAddress getByName(String host)
* public static InetAddress getByAddress(byte[] addr)

InetAddress æä¾›äº†å¦‚ä¸‹å‡ ä¸ªå¸¸ç”¨çš„æ–¹æ³•

* public String getHostAddress() ï¼šè¿”å› IP åœ°å€å­—ç¬¦ä¸²ï¼ˆä»¥æ–‡æœ¬è¡¨ç°å½¢å¼ï¼‰
* public String getHostName() ï¼šè·å–æ­¤ IP åœ°å€çš„ä¸»æœºå
* public boolean isReachable(int timeout)ï¼šæµ‹è¯•æ˜¯å¦å¯ä»¥è¾¾åˆ°è¯¥åœ°å€

```java
package com.atguigu.ip;

import java.net.InetAddress;
import java.net.UnknownHostException;

import org.junit.Test;

public class TestInetAddress {
    @Test
    public void test01() throws UnknownHostException{
        InetAddress localHost = InetAddress.getLocalHost();
        System.out.println(localHost);
    }

    @Test
    public void test02()throws UnknownHostException{
        InetAddress atguigu = InetAddress.getByName("www.atguigu.com");
        System.out.println(atguigu);
    }

    @Test
    public void test03()throws UnknownHostException{
//		byte[] addr = {112,54,108,98};
        byte[] addr = {(byte)192,(byte)168,24,56};
        InetAddress atguigu = InetAddress.getByAddress(addr);
        System.out.println(atguigu);
    }
}
```

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/f8d6953b02b3d36e0cf78e365d030bd4.png)


### 5.2 Socketç±»

-  `ç½‘ç»œä¸Šå…·æœ‰å”¯ä¸€æ ‡è¯†çš„IPåœ°å€å’Œç«¯å£å·ç»„åˆåœ¨ä¸€èµ·æ„æˆå”¯ä¸€èƒ½è¯†åˆ«çš„æ ‡è¯†ç¬¦å¥—æ¥å­—ï¼ˆSocketï¼‰`ã€‚
-  åˆ©ç”¨å¥—æ¥å­—(Socket)å¼€å‘ç½‘ç»œåº”ç”¨ç¨‹åºæ—©å·²è¢«å¹¿æ³›çš„é‡‡ç”¨ï¼Œä»¥è‡³äºæˆä¸ºäº‹å®ä¸Šçš„æ ‡å‡†ã€‚ç½‘ç»œé€šä¿¡å…¶å®å°±æ˜¯Socketé—´çš„é€šä¿¡ã€‚

- é€šä¿¡çš„ä¸¤ç«¯éƒ½è¦æœ‰Socketï¼Œæ˜¯ä¸¤å°æœºå™¨é—´é€šä¿¡çš„ç«¯ç‚¹ã€‚

- Socketå…è®¸ç¨‹åºæŠŠç½‘ç»œè¿æ¥å½“æˆä¸€ä¸ªæµï¼Œæ•°æ®åœ¨ä¸¤ä¸ªSocketé—´é€šè¿‡IOä¼ è¾“ã€‚

- ä¸€èˆ¬ä¸»åŠ¨å‘èµ·é€šä¿¡çš„åº”ç”¨ç¨‹åºå±å®¢æˆ·ç«¯ï¼Œç­‰å¾…é€šä¿¡è¯·æ±‚çš„ä¸ºæœåŠ¡ç«¯ã€‚

- Socketåˆ†ç±»ï¼š
  - æµå¥—æ¥å­—ï¼ˆstream socketï¼‰ï¼šä½¿ç”¨TCPæä¾›å¯ä¾èµ–çš„å­—èŠ‚æµæœåŠ¡
    - ServerSocketï¼šæ­¤ç±»å®ç°TCPæœåŠ¡å™¨å¥—æ¥å­—ã€‚æœåŠ¡å™¨å¥—æ¥å­—ç­‰å¾…è¯·æ±‚é€šè¿‡ç½‘ç»œä¼ å…¥ã€‚
    - Socketï¼šæ­¤ç±»å®ç°å®¢æˆ·ç«¯å¥—æ¥å­—ï¼ˆä¹Ÿå¯ä»¥å°±å«â€œå¥—æ¥å­—â€ï¼‰ã€‚å¥—æ¥å­—æ˜¯ä¸¤å°æœºå™¨é—´é€šä¿¡çš„ç«¯ç‚¹ã€‚
  - æ•°æ®æŠ¥å¥—æ¥å­—ï¼ˆdatagram socketï¼‰ï¼šä½¿ç”¨UDPæä¾›â€œå°½åŠ›è€Œä¸ºâ€çš„æ•°æ®æŠ¥æœåŠ¡
    - DatagramSocketï¼šæ­¤ç±»è¡¨ç¤ºç”¨æ¥å‘é€å’Œæ¥æ”¶UDPæ•°æ®æŠ¥åŒ…çš„å¥—æ¥å­—ã€‚ 

### 5.3 Socketç›¸å…³ç±»API

#### 5.3.1 ServerSocketç±»

**ServerSocketç±»çš„æ„é€ æ–¹æ³•ï¼š**

* ServerSocket(int port) ï¼šåˆ›å»ºç»‘å®šåˆ°ç‰¹å®šç«¯å£çš„æœåŠ¡å™¨å¥—æ¥å­—ã€‚

**ServerSocketç±»çš„å¸¸ç”¨æ–¹æ³•ï¼š**

* Socket accept()ï¼šä¾¦å¬å¹¶æ¥å—åˆ°æ­¤å¥—æ¥å­—çš„è¿æ¥ã€‚ 
#### 5.3.2 Socketç±»

**Socketç±»çš„å¸¸ç”¨æ„é€ æ–¹æ³•**ï¼š

* public Socket(InetAddress address,int port)ï¼šåˆ›å»ºä¸€ä¸ªæµå¥—æ¥å­—å¹¶å°†å…¶è¿æ¥åˆ°æŒ‡å®š IP åœ°å€çš„æŒ‡å®šç«¯å£å·ã€‚
* public Socket(String host,int port)ï¼šåˆ›å»ºä¸€ä¸ªæµå¥—æ¥å­—å¹¶å°†å…¶è¿æ¥åˆ°æŒ‡å®šä¸»æœºä¸Šçš„æŒ‡å®šç«¯å£å·ã€‚

**Socketç±»çš„å¸¸ç”¨æ–¹æ³•**ï¼š

* public InputStream getInputStream()ï¼šè¿”å›æ­¤å¥—æ¥å­—çš„è¾“å…¥æµï¼Œå¯ä»¥ç”¨äºæ¥æ”¶æ¶ˆæ¯
* public OutputStream getOutputStream()ï¼šè¿”å›æ­¤å¥—æ¥å­—çš„è¾“å‡ºæµï¼Œå¯ä»¥ç”¨äºå‘é€æ¶ˆæ¯
* public InetAddress getInetAddress()ï¼šæ­¤å¥—æ¥å­—è¿æ¥åˆ°çš„è¿œç¨‹ IP åœ°å€ï¼›å¦‚æœå¥—æ¥å­—æ˜¯æœªè¿æ¥çš„ï¼Œåˆ™è¿”å› nullã€‚
* public InetAddress getLocalAddress()ï¼šè·å–å¥—æ¥å­—ç»‘å®šçš„æœ¬åœ°åœ°å€ã€‚
* public int getPort()ï¼šæ­¤å¥—æ¥å­—è¿æ¥åˆ°çš„è¿œç¨‹ç«¯å£å·ï¼›å¦‚æœå°šæœªè¿æ¥å¥—æ¥å­—ï¼Œåˆ™è¿”å› 0ã€‚
* public int getLocalPort()ï¼šè¿”å›æ­¤å¥—æ¥å­—ç»‘å®šåˆ°çš„æœ¬åœ°ç«¯å£ã€‚å¦‚æœå°šæœªç»‘å®šå¥—æ¥å­—ï¼Œåˆ™è¿”å› -1ã€‚
* public void close()ï¼šå…³é—­æ­¤å¥—æ¥å­—ã€‚å¥—æ¥å­—è¢«å…³é—­åï¼Œä¾¿ä¸å¯åœ¨ä»¥åçš„ç½‘ç»œè¿æ¥ä¸­ä½¿ç”¨ï¼ˆå³æ— æ³•é‡æ–°è¿æ¥æˆ–é‡æ–°ç»‘å®šï¼‰ã€‚éœ€è¦åˆ›å»ºæ–°çš„å¥—æ¥å­—å¯¹è±¡ã€‚ å…³é—­æ­¤å¥—æ¥å­—ä¹Ÿå°†ä¼šå…³é—­è¯¥å¥—æ¥å­—çš„ InputStream å’Œ OutputStreamã€‚ 
* public void shutdownInput()ï¼šå¦‚æœåœ¨å¥—æ¥å­—ä¸Šè°ƒç”¨ shutdownInput() åä»å¥—æ¥å­—è¾“å…¥æµè¯»å–å†…å®¹ï¼Œåˆ™æµå°†è¿”å› EOFï¼ˆæ–‡ä»¶ç»“æŸç¬¦ï¼‰ã€‚ å³ä¸èƒ½åœ¨ä»æ­¤å¥—æ¥å­—çš„è¾“å…¥æµä¸­æ¥æ”¶ä»»ä½•æ•°æ®ã€‚
* public void shutdownOutput()ï¼šç¦ç”¨æ­¤å¥—æ¥å­—çš„è¾“å‡ºæµã€‚å¯¹äº TCP å¥—æ¥å­—ï¼Œä»»ä½•ä»¥å‰å†™å…¥çš„æ•°æ®éƒ½å°†è¢«å‘é€ï¼Œå¹¶ä¸”åè·Ÿ TCP çš„æ­£å¸¸è¿æ¥ç»ˆæ­¢åºåˆ—ã€‚ å¦‚æœåœ¨å¥—æ¥å­—ä¸Šè°ƒç”¨ shutdownOutput() åå†™å…¥å¥—æ¥å­—è¾“å‡ºæµï¼Œåˆ™è¯¥æµå°†æŠ›å‡º IOExceptionã€‚ å³ä¸èƒ½é€šè¿‡æ­¤å¥—æ¥å­—çš„è¾“å‡ºæµå‘é€ä»»ä½•æ•°æ®ã€‚

**æ³¨æ„ï¼š** å…ˆåè°ƒç”¨Socketçš„shutdownInput()å’ŒshutdownOutput()æ–¹æ³•ï¼Œä»…ä»…å…³é—­äº†è¾“å…¥æµå’Œè¾“å‡ºæµï¼Œå¹¶ä¸ç­‰äºè°ƒç”¨Socketçš„close()æ–¹æ³•ã€‚åœ¨é€šä¿¡ç»“æŸåï¼Œä»ç„¶è¦è°ƒç”¨Scoketçš„close()æ–¹æ³•ï¼Œå› ä¸ºåªæœ‰è¯¥æ–¹æ³•æ‰ä¼šé‡Šæ”¾Socketå ç”¨çš„èµ„æºï¼Œæ¯”å¦‚å ç”¨çš„æœ¬åœ°ç«¯å£å·ç­‰ã€‚

#### 5.3.3 DatagramSocketç±»

**DatagramSocket ç±»çš„å¸¸ç”¨æ–¹æ³•ï¼š**

* public DatagramSocket(int port)åˆ›å»ºæ•°æ®æŠ¥å¥—æ¥å­—å¹¶å°†å…¶ç»‘å®šåˆ°æœ¬åœ°ä¸»æœºä¸Šçš„æŒ‡å®šç«¯å£ã€‚å¥—æ¥å­—å°†è¢«ç»‘å®šåˆ°é€šé…ç¬¦åœ°å€ï¼ŒIP åœ°å€ç”±å†…æ ¸æ¥é€‰æ‹©ã€‚
* public DatagramSocket(int port,InetAddress laddr)åˆ›å»ºæ•°æ®æŠ¥å¥—æ¥å­—ï¼Œå°†å…¶ç»‘å®šåˆ°æŒ‡å®šçš„æœ¬åœ°åœ°å€ã€‚æœ¬åœ°ç«¯å£å¿…é¡»åœ¨ 0 åˆ° 65535 ä¹‹é—´ï¼ˆåŒ…æ‹¬ä¸¤è€…ï¼‰ã€‚å¦‚æœ IP åœ°å€ä¸º 0.0.0.0ï¼Œå¥—æ¥å­—å°†è¢«ç»‘å®šåˆ°é€šé…ç¬¦åœ°å€ï¼ŒIP åœ°å€ç”±å†…æ ¸é€‰æ‹©ã€‚ 
* public void close()å…³é—­æ­¤æ•°æ®æŠ¥å¥—æ¥å­—ã€‚ 
* public void send(DatagramPacket p)ä»æ­¤å¥—æ¥å­—å‘é€æ•°æ®æŠ¥åŒ…ã€‚DatagramPacket åŒ…å«çš„ä¿¡æ¯æŒ‡ç¤ºï¼šå°†è¦å‘é€çš„æ•°æ®ã€å…¶é•¿åº¦ã€è¿œç¨‹ä¸»æœºçš„ IP åœ°å€å’Œè¿œç¨‹ä¸»æœºçš„ç«¯å£å·ã€‚ 
* public void receive(DatagramPacket p)ä»æ­¤å¥—æ¥å­—æ¥æ”¶æ•°æ®æŠ¥åŒ…ã€‚å½“æ­¤æ–¹æ³•è¿”å›æ—¶ï¼ŒDatagramPacket çš„ç¼“å†²åŒºå¡«å……äº†æ¥æ”¶çš„æ•°æ®ã€‚æ•°æ®æŠ¥åŒ…ä¹ŸåŒ…å«å‘é€æ–¹çš„ IP åœ°å€å’Œå‘é€æ–¹æœºå™¨ä¸Šçš„ç«¯å£å·ã€‚ æ­¤æ–¹æ³•åœ¨æ¥æ”¶åˆ°æ•°æ®æŠ¥å‰ä¸€ç›´é˜»å¡ã€‚æ•°æ®æŠ¥åŒ…å¯¹è±¡çš„ length å­—æ®µåŒ…å«æ‰€æ¥æ”¶ä¿¡æ¯çš„é•¿åº¦ã€‚å¦‚æœä¿¡æ¯æ¯”åŒ…çš„é•¿åº¦é•¿ï¼Œè¯¥ä¿¡æ¯å°†è¢«æˆªçŸ­ã€‚ 
* public InetAddress getLocalAddress()è·å–å¥—æ¥å­—ç»‘å®šçš„æœ¬åœ°åœ°å€ã€‚
* public int getLocalPort()è¿”å›æ­¤å¥—æ¥å­—ç»‘å®šçš„æœ¬åœ°ä¸»æœºä¸Šçš„ç«¯å£å·ã€‚ 
* public InetAddress getInetAddress()è¿”å›æ­¤å¥—æ¥å­—è¿æ¥çš„åœ°å€ã€‚å¦‚æœå¥—æ¥å­—æœªè¿æ¥ï¼Œåˆ™è¿”å› nullã€‚
* public int getPort()è¿”å›æ­¤å¥—æ¥å­—çš„ç«¯å£ã€‚å¦‚æœå¥—æ¥å­—æœªè¿æ¥ï¼Œåˆ™è¿”å› -1ã€‚

#### 5.3.4 DatagramPacketç±»

**DatagramPacketç±»çš„å¸¸ç”¨æ–¹æ³•ï¼š**

* public DatagramPacket(byte[] buf,int length)æ„é€  DatagramPacketï¼Œç”¨æ¥æ¥æ”¶é•¿åº¦ä¸º length çš„æ•°æ®åŒ…ã€‚ length å‚æ•°å¿…é¡»å°äºç­‰äº buf.lengthã€‚
* public DatagramPacket(byte[] buf,int length,InetAddress address,int port)æ„é€ æ•°æ®æŠ¥åŒ…ï¼Œç”¨æ¥å°†é•¿åº¦ä¸º length çš„åŒ…å‘é€åˆ°æŒ‡å®šä¸»æœºä¸Šçš„æŒ‡å®šç«¯å£å·ã€‚length å‚æ•°å¿…é¡»å°äºç­‰äº buf.lengthã€‚
* public InetAddress getAddress()è¿”å›æŸå°æœºå™¨çš„ IP åœ°å€ï¼Œæ­¤æ•°æ®æŠ¥å°†è¦å‘å¾€è¯¥æœºå™¨æˆ–è€…æ˜¯ä»è¯¥æœºå™¨æ¥æ”¶åˆ°çš„ã€‚
* public int getPort()è¿”å›æŸå°è¿œç¨‹ä¸»æœºçš„ç«¯å£å·ï¼Œæ­¤æ•°æ®æŠ¥å°†è¦å‘å¾€è¯¥ä¸»æœºæˆ–è€…æ˜¯ä»è¯¥ä¸»æœºæ¥æ”¶åˆ°çš„ã€‚
* `public byte[] getData()`è¿”å›æ•°æ®ç¼“å†²åŒºã€‚æ¥æ”¶åˆ°çš„æˆ–å°†è¦å‘é€çš„æ•°æ®ä»ç¼“å†²åŒºä¸­çš„åç§»é‡ offset å¤„å¼€å§‹ï¼ŒæŒç»­ length é•¿åº¦ã€‚
* `public int getLength()`è¿”å›å°†è¦å‘é€æˆ–æ¥æ”¶åˆ°çš„æ•°æ®çš„é•¿åº¦ã€‚

## 6 TCPç½‘ç»œç¼–ç¨‹

### 6.1 é€šä¿¡æ¨¡å‹

Javaè¯­è¨€çš„åŸºäºå¥—æ¥å­—TCPç¼–ç¨‹åˆ†ä¸ºæœåŠ¡ç«¯ç¼–ç¨‹å’Œå®¢æˆ·ç«¯ç¼–ç¨‹ï¼Œå…¶é€šä¿¡æ¨¡å‹å¦‚å›¾æ‰€ç¤ºï¼š

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/3af1dc1c8afca8ffac6db89766fa8464.png)

### 6.2 å¼€å‘æ­¥éª¤

**å®¢æˆ·ç«¯ç¨‹åºåŒ…å«ä»¥ä¸‹å››ä¸ªåŸºæœ¬çš„æ­¥éª¤ ï¼š**

* åˆ›å»º Socket ï¼šæ ¹æ®æŒ‡å®šæœåŠ¡ç«¯çš„ IP åœ°å€æˆ–ç«¯å£å·æ„é€  Socket ç±»å¯¹è±¡ã€‚è‹¥æœåŠ¡å™¨ç«¯å“åº”ï¼Œåˆ™å»ºç«‹å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„é€šä¿¡çº¿è·¯ã€‚è‹¥è¿æ¥å¤±è´¥ï¼Œä¼šå‡ºç°å¼‚å¸¸ã€‚
* æ‰“å¼€è¿æ¥åˆ° Socket  çš„è¾“å…¥/ å‡ºæµï¼š ä½¿ç”¨ getInputStream()æ–¹æ³•è·å¾—è¾“å…¥æµï¼Œä½¿ç”¨getOutputStream()æ–¹æ³•è·å¾—è¾“å‡ºæµï¼Œè¿›è¡Œæ•°æ®ä¼ è¾“
* æŒ‰ç…§ä¸€å®šçš„åè®®å¯¹ Socket è¿›è¡Œè¯»/ å†™æ“ä½œï¼šé€šè¿‡è¾“å…¥æµè¯»å–æœåŠ¡å™¨æ”¾å…¥çº¿è·¯çš„ä¿¡æ¯ï¼ˆä½†ä¸èƒ½è¯»å–è‡ªå·±æ”¾å…¥çº¿è·¯çš„ä¿¡æ¯ï¼‰ï¼Œé€šè¿‡è¾“å‡ºæµå°†ä¿¡æ¯å†™å…¥çº¿è·¯ã€‚
* å…³é—­ Socket ï¼šæ–­å¼€å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼Œé‡Šæ”¾çº¿è·¯

**æœåŠ¡å™¨ç«¯ç¨‹åºåŒ…å«ä»¥ä¸‹å››ä¸ªåŸºæœ¬çš„ æ­¥éª¤ï¼š**

* è°ƒç”¨ ServerSocket(int port)  ï¼šåˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç«¯å¥—æ¥å­—ï¼Œå¹¶ç»‘å®šåˆ°æŒ‡å®šç«¯å£ä¸Šã€‚ç”¨äºç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚
* è°ƒç”¨ accept() ï¼šç›‘å¬è¿æ¥è¯·æ±‚ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯·æ±‚è¿æ¥ï¼Œåˆ™æ¥å—è¿æ¥ï¼Œè¿”å›é€šä¿¡å¥—æ¥å­—å¯¹è±¡ã€‚
* è°ƒç”¨  è¯¥Socket ç±»å¯¹è±¡çš„ getOutputStream()  å’Œ getInputStream () ï¼šè·å–è¾“å‡ºæµå’Œè¾“å…¥æµï¼Œå¼€å§‹ç½‘ç»œæ•°æ®çš„å‘é€å’Œæ¥æ”¶ã€‚
* å…³é—­Socket å¯¹è±¡ï¼šå®¢æˆ·ç«¯è®¿é—®ç»“æŸï¼Œå…³é—­é€šä¿¡å¥—æ¥å­—ã€‚

### 6.3 ä¾‹é¢˜ä¸ç»ƒä¹ 

> ä¾‹é¢˜1ï¼šå®¢æˆ·ç«¯å‘é€å†…å®¹ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ä¸Šã€‚
>
> ä¾‹é¢˜2ï¼šå®¢æˆ·ç«¯å‘é€æ–‡ä»¶ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†æ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°ã€‚
>
> ä¾‹é¢˜3ï¼šä»å®¢æˆ·ç«¯å‘é€æ–‡ä»¶ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¿å­˜åˆ°æœ¬åœ°ã€‚å¹¶è¿”å›â€œå‘é€æˆåŠŸâ€ç»™å®¢æˆ·ç«¯ã€‚å¹¶å…³é—­ç›¸åº”çš„è¿æ¥ã€‚
>

ç»ƒä¹ 1ï¼šæœåŠ¡ç«¯è¯»å–å›¾ç‰‡å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°

ç»ƒä¹ 2ï¼šå®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘é€æ–‡æœ¬ï¼ŒæœåŠ¡ç«¯ä¼šå°†æ–‡æœ¬è½¬æˆå¤§å†™åœ¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

**æ¼”ç¤ºå•ä¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å•æ¬¡é€šä¿¡ï¼š**

éœ€æ±‚ï¼šå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œè¿æ¥æˆåŠŸåç»™æœåŠ¡å‘é€â€œlalalaâ€ï¼ŒæœåŠ¡å™¨æ”¶åˆ°æ¶ˆæ¯åï¼Œç»™å®¢æˆ·ç«¯è¿”å›â€œæ¬¢è¿ç™»å½•â€ï¼Œå®¢æˆ·ç«¯æ¥æ”¶æ¶ˆæ¯åï¼Œæ–­å¼€è¿æ¥

**1ã€æœåŠ¡å™¨ç«¯ç¤ºä¾‹ä»£ç **

```java
package com.atguigu.tcp.one;

import java.io.InputStream;
import java.io.OutputStream;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {

    public static void main(String[] args)throws Exception {
        //1ã€å‡†å¤‡ä¸€ä¸ªServerSocketå¯¹è±¡ï¼Œå¹¶ç»‘å®š8888ç«¯å£
        ServerSocket server =  new ServerSocket(8888);
        System.out.println("ç­‰å¾…è¿æ¥....");

        //2ã€åœ¨8888ç«¯å£ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œè¯¥æ–¹æ³•æ˜¯ä¸ªé˜»å¡çš„æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œå°†ä¸€ç›´ç­‰å¾…
        Socket socket = server.accept();
        InetAddress inetAddress = socket.getInetAddress();
        System.out.println(inetAddress.getHostAddress() + "å®¢æˆ·ç«¯è¿æ¥æˆåŠŸï¼ï¼");

        //3ã€è·å–è¾“å…¥æµï¼Œç”¨æ¥æ¥æ”¶è¯¥å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®
        InputStream input = socket.getInputStream();
        //æ¥æ”¶æ•°æ®
        byte[] data = new byte[1024];
        StringBuilder s = new StringBuilder();
        int len;
        while ((len = input.read(data)) != -1) {
            s.append(new String(data, 0, len));
        }
        System.out.println(inetAddress.getHostAddress() + "å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯æ˜¯ï¼š" + s);

        //4ã€è·å–è¾“å‡ºæµï¼Œç”¨æ¥å‘é€æ•°æ®ç»™è¯¥å®¢æˆ·ç«¯
        OutputStream out = socket.getOutputStream();
        //å‘é€æ•°æ®
        out.write("æ¬¢è¿ç™»å½•".getBytes());
        out.flush();

        //5ã€å…³é—­socketï¼Œä¸å†ä¸è¯¥å®¢æˆ·ç«¯é€šä¿¡
        //socketå…³é—­ï¼Œæ„å‘³ç€InputStreamå’ŒOutputStreamä¹Ÿå…³é—­äº†
        socket.close();

        //6ã€å¦‚æœä¸å†æ¥æ”¶ä»»ä½•å®¢æˆ·ç«¯é€šä¿¡ï¼Œå¯ä»¥å…³é—­ServerSocket
        server.close();
    }
}

```

**2ã€å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç **

```java
package com.atguigu.tcp.one;

import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class Client {

    public static void main(String[] args) throws Exception {
        // 1ã€å‡†å¤‡Socketï¼Œè¿æ¥æœåŠ¡å™¨ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·
        Socket socket = new Socket("127.0.0.1", 8888);

        // 2ã€è·å–è¾“å‡ºæµï¼Œç”¨æ¥å‘é€æ•°æ®ç»™æœåŠ¡å™¨
        OutputStream out = socket.getOutputStream();
        // å‘é€æ•°æ®
        out.write("lalala".getBytes());
        //ä¼šåœ¨æµæœ«å°¾å†™å…¥ä¸€ä¸ªâ€œæµçš„æœ«å°¾â€æ ‡è®°ï¼Œå¯¹æ–¹æ‰èƒ½è¯»åˆ°-1ï¼Œå¦åˆ™å¯¹æ–¹çš„è¯»å–æ–¹æ³•ä¼šä¸€è‡´é˜»å¡
        socket.shutdownOutput();

        //3ã€è·å–è¾“å…¥æµï¼Œç”¨æ¥æ¥æ”¶æœåŠ¡å™¨å‘é€ç»™è¯¥å®¢æˆ·ç«¯çš„æ•°æ®
        InputStream input = socket.getInputStream();
        // æ¥æ”¶æ•°æ®
        byte[] data = new byte[1024];
        StringBuilder s = new StringBuilder();
        int len;
        while ((len = input.read(data)) != -1) {
            s.append(new String(data, 0, len));
        }
        System.out.println("æœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯æ˜¯ï¼š" + s);

        //4ã€å…³é—­socketï¼Œä¸å†ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œå³æ–­å¼€ä¸æœåŠ¡å™¨çš„è¿æ¥
        //socketå…³é—­ï¼Œæ„å‘³ç€InputStreamå’ŒOutputStreamä¹Ÿå…³é—­äº†
        socket.close();
    }
}

```



**æ¼”ç¤ºå¤šä¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„å¤šæ¬¡é€šä¿¡ï¼š**

é€šå¸¸æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¸åº”è¯¥åªæ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œè€Œåº”è¯¥ä¸æ–­åœ°æ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚ï¼Œæ‰€ä»¥Javaç¨‹åºé€šå¸¸ä¼šé€šè¿‡å¾ªç¯ï¼Œä¸æ–­åœ°è°ƒç”¨ServerSocketçš„accept()æ–¹æ³•ã€‚

å¦‚æœæœåŠ¡å™¨ç«¯è¦â€œåŒæ—¶â€å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå› æ­¤æœåŠ¡å™¨ç«¯éœ€è¦ä¸º**æ¯ä¸€ä¸ªå®¢æˆ·ç«¯å•ç‹¬åˆ†é…ä¸€ä¸ªçº¿ç¨‹**æ¥å¤„ç†ï¼Œå¦åˆ™æ— æ³•å®ç°â€œåŒæ—¶â€ã€‚

å’±ä»¬ä¹‹å‰å­¦ä¹ IOæµçš„æ—¶å€™ï¼Œæåˆ°è¿‡è£…é¥°è€…è®¾è®¡æ¨¡å¼ï¼Œè¯¥è®¾è®¡ä½¿å¾—ä¸ç®¡åº•å±‚IOæµæ˜¯æ€æ ·çš„èŠ‚ç‚¹æµï¼šæ–‡ä»¶æµä¹Ÿå¥½ï¼Œç½‘ç»œSocketäº§ç”Ÿçš„æµä¹Ÿå¥½ï¼Œç¨‹åºéƒ½å¯ä»¥å°†å…¶åŒ…è£…æˆå¤„ç†æµï¼Œç”šè‡³å¯ä»¥å¤šå±‚åŒ…è£…ï¼Œä»è€Œæä¾›æ›´å¤šæ–¹ä¾¿çš„å¤„ç†ã€‚

æ¡ˆä¾‹éœ€æ±‚ï¼šå¤šä¸ªå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œå¹¶è¿›è¡Œå¤šæ¬¡é€šä¿¡

* æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥æˆåŠŸåï¼Œä»é”®ç›˜è¾“å…¥è‹±æ–‡å•è¯æˆ–ä¸­å›½æˆè¯­ï¼Œå¹¶å‘é€ç»™æœåŠ¡å™¨
* æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¶ˆæ¯åï¼ŒæŠŠè¯è¯­â€œåè½¬â€åè¿”å›ç»™å®¢æˆ·ç«¯
* å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„â€œè¯è¯­â€ï¼Œæ‰“å°æ˜¾ç¤º
* å½“å®¢æˆ·ç«¯è¾“å…¥â€œstopâ€æ—¶æ–­å¼€ä¸æœåŠ¡å™¨çš„è¿æ¥
* å¤šä¸ªå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶ç»™æœåŠ¡å™¨å‘é€â€œè¯è¯­â€ï¼ŒæœåŠ¡å™¨å¯ä»¥â€œåŒæ—¶â€å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚

![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/f1e6755d0d5b08b68849bc0a7a64c45f.png)


**1ã€æœåŠ¡å™¨ç«¯ç¤ºä¾‹ä»£ç **

```java
package com.atguigu.tcp.many;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintStream;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {
    public static void main(String[] args) throws IOException {
        // 1ã€å‡†å¤‡ä¸€ä¸ªServerSocket
        ServerSocket server = new ServerSocket(8888);
        System.out.println("ç­‰å¾…è¿æ¥...");

        int count = 0;
        while(true){
            // 2ã€ç›‘å¬ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥
            Socket socket = server.accept();
            System.out.println("ç¬¬" + ++count + "ä¸ªå®¢æˆ·ç«¯"+socket.getInetAddress().getHostAddress()+"è¿æ¥æˆåŠŸï¼ï¼");

            ClientHandlerThread ct = new ClientHandlerThread(socket);
            ct.start();
        }

        //è¿™é‡Œæ²¡æœ‰å…³é—­serverï¼Œæ°¸è¿œç›‘å¬
    }
    static class ClientHandlerThread extends Thread{
        private Socket socket;
        private String ip;

        public ClientHandlerThread(Socket socket) {
            super();
            this.socket = socket;
            ip = socket.getInetAddress().getHostAddress();
        }

        public void run(){
            try{
                //ï¼ˆ1ï¼‰è·å–è¾“å…¥æµï¼Œç”¨æ¥æ¥æ”¶è¯¥å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®
                BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                //ï¼ˆ2ï¼‰è·å–è¾“å‡ºæµï¼Œç”¨æ¥å‘é€æ•°æ®ç»™è¯¥å®¢æˆ·ç«¯
                PrintStream ps = new PrintStream(socket.getOutputStream());
                String str;
                // ï¼ˆ3ï¼‰æ¥æ”¶æ•°æ®
                while ((str = br.readLine()) != null) {
                    //ï¼ˆ4ï¼‰åè½¬
                    StringBuilder word = new StringBuilder(str);
                    word.reverse();

                    //ï¼ˆ5ï¼‰è¿”å›ç»™å®¢æˆ·ç«¯
                    ps.println(word);
                }
                System.out.println("å®¢æˆ·ç«¯" + ip+"æ­£å¸¸é€€å‡º");
            }catch(Exception  e){
                System.out.println("å®¢æˆ·ç«¯" + ip+"æ„å¤–é€€å‡º");
            }finally{
                try {
                    //ï¼ˆ6ï¼‰æ–­å¼€è¿æ¥
                    socket.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

```

**2ã€å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç **

```java
package com.atguigu.tcp.many;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintStream;
import java.net.Socket;
import java.util.Scanner;

public class Client {
    public static void main(String[] args) throws Exception {
        // 1ã€å‡†å¤‡Socketï¼Œè¿æ¥æœåŠ¡å™¨ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·
        Socket socket = new Socket("127.0.0.1", 8888);

        // 2ã€è·å–è¾“å‡ºæµï¼Œç”¨æ¥å‘é€æ•°æ®ç»™æœåŠ¡å™¨
        OutputStream out = socket.getOutputStream();
        PrintStream ps = new PrintStream(out);

        // 3ã€è·å–è¾“å…¥æµï¼Œç”¨æ¥æ¥æ”¶æœåŠ¡å™¨å‘é€ç»™è¯¥å®¢æˆ·ç«¯çš„æ•°æ®
        InputStream input = socket.getInputStream();
        BufferedReader br;
        if(args!= null && args.length>0) {
            String encoding = args[0];
            br = new BufferedReader(new InputStreamReader(input,encoding));
        }else{
            br = new BufferedReader(new InputStreamReader(input));
        }

        Scanner scanner = new Scanner(System.in);
        while(true){
            System.out.println("è¾“å…¥å‘é€ç»™æœåŠ¡å™¨çš„å•è¯æˆ–æˆè¯­ï¼š");
            String message = scanner.nextLine();
            if(message.equals("stop")){
                socket.shutdownOutput();
                break;
            }

            // 4ã€ å‘é€æ•°æ®
            ps.println(message);
            // æ¥æ”¶æ•°æ®
            String feedback  = br.readLine();
            System.out.println("ä»æœåŠ¡å™¨æ”¶åˆ°çš„åé¦ˆæ˜¯ï¼š" + feedback);
        }

        //5ã€å…³é—­socketï¼Œæ–­å¼€ä¸æœåŠ¡å™¨çš„è¿æ¥
        scanner.close();
        socket.close();
    }
}
```

### 6.4 æ¡ˆä¾‹ï¼šèŠå¤©å®¤

æœåŠ¡ç«¯ï¼š

```java
package com.atguigu.tcp;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;

public class TestChatServer {
	//è¿™ä¸ªé›†åˆç”¨æ¥å­˜å‚¨æ‰€æœ‰åœ¨çº¿çš„å®¢æˆ·ç«¯
	static ArrayList<Socket> online = new  ArrayList<Socket>();
	
	public static void main(String[] args)throws Exception {
		//1ã€å¯åŠ¨æœåŠ¡å™¨ï¼Œç»‘å®šç«¯å£å·
		ServerSocket server = new ServerSocket(8989);
		
		//2ã€æ¥æ”¶nå¤šçš„å®¢æˆ·ç«¯åŒæ—¶è¿æ¥
		while(true){
			Socket accept = server.accept();
			
			online.add(accept);//æŠŠæ–°è¿æ¥çš„å®¢æˆ·ç«¯æ·»åŠ åˆ°onlineåˆ—è¡¨ä¸­
			
			MessageHandler mh = new MessageHandler(accept);
			mh.start();//
		}
	}
	
	static class MessageHandler extends Thread{
		private Socket socket;
		private String ip;
		
		public MessageHandler(Socket socket) {
			super();
			this.socket = socket;
		}

		public void run(){
			try {
				ip = socket.getInetAddress().getHostAddress();
				
				//æ’å…¥ï¼šç»™å…¶ä»–å®¢æˆ·ç«¯è½¬å‘â€œæˆ‘ä¸Šçº¿äº†â€
				sendToOther(ip+"ä¸Šçº¿äº†");
				
				//(1)æ¥æ”¶è¯¥å®¢æˆ·ç«¯çš„å‘é€çš„æ¶ˆæ¯
				InputStream input = socket.getInputStream();
				InputStreamReader reader = new InputStreamReader(input);
				BufferedReader br = new BufferedReader(reader);
				
				String str;
				while((str = br.readLine())!=null){
					//(2)ç»™å…¶ä»–åœ¨çº¿å®¢æˆ·ç«¯è½¬å‘
					sendToOther(ip+":"+str);
				}
				
				sendToOther(ip+"ä¸‹çº¿äº†");
			} catch (IOException e) {
				try {
					sendToOther(ip+"æ‰çº¿äº†");
				} catch (IOException e1) {
					e1.printStackTrace();
				}
			}finally{
				//ä»åœ¨çº¿äººå‘˜ä¸­ç§»é™¤æˆ‘
				online.remove(socket);
			}
		}
		
		//å°è£…ä¸€ä¸ªæ–¹æ³•ï¼šç»™å…¶ä»–å®¢æˆ·ç«¯è½¬å‘xxxæ¶ˆæ¯
		public void sendToOther(String message) throws IOException{
			//éå†æ‰€æœ‰çš„åœ¨çº¿å®¢æˆ·ç«¯ï¼Œä¸€ä¸€è½¬å‘
			for (Socket on : online) {
				OutputStream every = on.getOutputStream();
				//ä¸ºä»€ä¹ˆç”¨PrintStreamï¼Ÿç›®çš„ç”¨å®ƒçš„printlnæ–¹æ³•ï¼ŒæŒ‰è¡Œæ‰“å°
				PrintStream ps = new PrintStream(every);
				
				ps.println(message);
			}
		}
	}
}


```

å®¢æˆ·ç«¯ï¼š

```java
package com.atguigu.tcp;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.net.Socket;
import java.util.Scanner;

public class TestChatClient {
	public static void main(String[] args)throws Exception {
		//1ã€è¿æ¥æœåŠ¡å™¨
		Socket socket = new Socket("127.0.0.1",8989);
		
		//2ã€å¼€å¯ä¸¤ä¸ªçº¿ç¨‹
		//(1)ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£çœ‹åˆ«äººèŠï¼Œå³æ¥æ”¶æœåŠ¡å™¨è½¬å‘çš„æ¶ˆæ¯
		Receive receive = new Receive(socket);
		receive.start();
		
		//(2)ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£å‘é€è‡ªå·±çš„è¯
		Send send = new Send(socket);
		send.start();
		
		send.join();//ç­‰æˆ‘å‘é€çº¿ç¨‹ç»“æŸäº†ï¼Œæ‰ç»“æŸæ•´ä¸ªç¨‹åº
		
		socket.close();
	}
}
class Send extends Thread{
	private Socket socket;
	
	public Send(Socket socket) {
		super();
		this.socket = socket;
	}

	public void run(){
		try {
			OutputStream outputStream = socket.getOutputStream();
			//æŒ‰è¡Œæ‰“å°
			PrintStream ps = new PrintStream(outputStream);
			
			Scanner input = new Scanner(System.in);
			
			//ä»é”®ç›˜ä¸æ–­çš„è¾“å…¥è‡ªå·±çš„è¯ï¼Œç»™æœåŠ¡å™¨å‘é€ï¼Œç”±æœåŠ¡å™¨ç»™å…¶ä»–äººè½¬å‘
			while(true){
				System.out.print("è‡ªå·±çš„è¯ï¼š");
				String str = input.nextLine();
				if("bye".equals(str)){
					break;
				}
				ps.println(str);
			}
			
			input.close();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	
}
class Receive extends Thread{
	private Socket socket;
	
	public Receive(Socket socket) {
		super();
		this.socket = socket;
	}
	
	public void run(){
		try {
			InputStream inputStream = socket.getInputStream();
			Scanner input = new Scanner(inputStream);
			
			while(input.hasNextLine()){
				String line = input.nextLine();
				System.out.println(line);
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
```



### 6.5 ç†è§£å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯

- å®¢æˆ·ç«¯ï¼š
  - è‡ªå®šä¹‰
  - æµè§ˆå™¨(browser --- server)

- æœåŠ¡ç«¯ï¼š
  - è‡ªå®šä¹‰
  - TomcatæœåŠ¡å™¨

## 7 UDPç½‘ç»œç¼–ç¨‹

UDP(User Datagram Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®)ï¼šæ˜¯ä¸€ä¸ªæ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ã€æä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é çš„ä¿¡æ¯ä¼ é€æœåŠ¡ï¼Œç±»ä¼¼äºçŸ­ä¿¡ã€‚

### 7.1 é€šä¿¡æ¨¡å‹

UDPåè®®æ˜¯ä¸€ç§**é¢å‘éè¿æ¥**çš„åè®®ï¼Œé¢å‘éè¿æ¥æŒ‡çš„æ˜¯åœ¨æ­£å¼é€šä¿¡å‰ä¸å¿…ä¸å¯¹æ–¹å…ˆå»ºç«‹è¿æ¥ï¼Œä¸ç®¡å¯¹æ–¹çŠ¶æ€å°±ç›´æ¥å‘é€ï¼Œè‡³äºå¯¹æ–¹æ˜¯å¦å¯ä»¥æ¥æ”¶åˆ°è¿™äº›æ•°æ®å†…å®¹ï¼ŒUDPåè®®æ— æ³•æ§åˆ¶ï¼Œå› æ­¤è¯´ï¼ŒUDPåè®®æ˜¯ä¸€ç§**ä¸å¯é çš„**åè®®ã€‚æ— è¿æ¥çš„å¥½å¤„å°±æ˜¯å¿«ï¼Œçœå†…å­˜ç©ºé—´å’Œæµé‡ï¼Œå› ä¸ºç»´æŠ¤è¿æ¥éœ€è¦åˆ›å»ºå¤§é‡çš„æ•°æ®ç»“æ„ã€‚UDPä¼šå°½æœ€å¤§åŠªåŠ›äº¤ä»˜æ•°æ®ï¼Œä½†ä¸ä¿è¯å¯é äº¤ä»˜ï¼Œæ²¡æœ‰TCPçš„ç¡®è®¤æœºåˆ¶ã€é‡ä¼ æœºåˆ¶ï¼Œå¦‚æœå› ä¸ºç½‘ç»œåŸå› æ²¡æœ‰ä¼ é€åˆ°å¯¹ç«¯ï¼ŒUDPä¹Ÿä¸ä¼šç»™åº”ç”¨å±‚è¿”å›é”™è¯¯ä¿¡æ¯ã€‚

UDPåè®®æ˜¯é¢å‘æ•°æ®æŠ¥æ–‡çš„ä¿¡æ¯ä¼ é€æœåŠ¡ã€‚UDPåœ¨å‘é€ç«¯æ²¡æœ‰ç¼“å†²åŒºï¼Œå¯¹äºåº”ç”¨å±‚äº¤ä»˜ä¸‹æ¥çš„æŠ¥æ–‡åœ¨æ·»åŠ äº†é¦–éƒ¨ä¹‹åå°±ç›´æ¥äº¤ä»˜äºipå±‚ï¼Œä¸ä¼šè¿›è¡Œåˆå¹¶ï¼Œä¹Ÿä¸ä¼šè¿›è¡Œæ‹†åˆ†ï¼Œè€Œæ˜¯ä¸€æ¬¡äº¤ä»˜ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡ã€‚æ¯”å¦‚æˆ‘ä»¬è¦å‘é€100ä¸ªå­—èŠ‚çš„æŠ¥æ–‡ï¼Œæˆ‘ä»¬è°ƒç”¨ä¸€æ¬¡send()æ–¹æ³•å°±ä¼šå‘é€100å­—èŠ‚ï¼Œæ¥æ”¶æ–¹ä¹Ÿéœ€è¦ç”¨receive()æ–¹æ³•ä¸€æ¬¡æ€§æ¥æ”¶100å­—èŠ‚ï¼Œä¸èƒ½ä½¿ç”¨å¾ªç¯æ¯æ¬¡è·å–10ä¸ªå­—èŠ‚ï¼Œè·å–åæ¬¡è¿™æ ·çš„åšæ³•ã€‚

UDPåè®®æ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œæ‰€ä»¥å½“ç½‘ç»œå‡ºç°çš„æ‹¥å¡ä¸ä¼šå¯¼è‡´ä¸»æœºå‘é€æ•°æ®çš„é€Ÿç‡é™ä½ã€‚è™½ç„¶UDPçš„æ¥æ”¶ç«¯æœ‰ç¼“å†²åŒºï¼Œä½†æ˜¯è¿™ä¸ªç¼“å†²åŒºåªè´Ÿè´£æ¥æ”¶ï¼Œå¹¶ä¸ä¼šä¿è¯UDPæŠ¥æ–‡çš„åˆ°è¾¾é¡ºåºæ˜¯å¦å’Œå‘é€çš„é¡ºåºä¸€è‡´ã€‚å› ä¸ºç½‘ç»œä¼ è¾“çš„æ—¶å€™ï¼Œç”±äºç½‘ç»œæ‹¥å¡çš„å­˜åœ¨æ˜¯å¾ˆå¤§çš„å¯èƒ½å¯¼è‡´å…ˆå‘çš„æŠ¥æ–‡æ¯”åå‘çš„æŠ¥æ–‡æ™šåˆ°è¾¾ã€‚å¦‚æœæ­¤æ—¶ç¼“å†²åŒºæ»¡äº†ï¼Œåé¢åˆ°è¾¾çš„æŠ¥æ–‡å°†ç›´æ¥è¢«ä¸¢å¼ƒã€‚è¿™ä¸ªå¯¹å®æ—¶åº”ç”¨æ¥è¯´å¾ˆé‡è¦ï¼Œæ¯”å¦‚ï¼šè§†é¢‘é€šè¯ã€ç›´æ’­ç­‰åº”ç”¨ã€‚

å› æ­¤UDPé€‚ç”¨äºä¸€æ¬¡åªä¼ é€å°‘é‡æ•°æ®ã€å¯¹å¯é æ€§è¦æ±‚ä¸é«˜çš„åº”ç”¨ç¯å¢ƒï¼Œæ•°æ®æŠ¥å¤§å°é™åˆ¶åœ¨64Kä»¥ä¸‹ã€‚
![|380](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2024/04/4727202323854a79f091b3bfcf380936.png)


ç±» DatagramSocket å’Œ DatagramPacket å®ç°äº†åŸºäº UDP åè®®ç½‘ç»œç¨‹åºã€‚

 UDPæ•°æ®æŠ¥é€šè¿‡æ•°æ®æŠ¥å¥—æ¥å­— DatagramSocket å‘é€å’Œæ¥æ”¶ï¼Œç³»ç»Ÿä¸ä¿è¯  UDPæ•°æ®æŠ¥ä¸€å®šèƒ½å¤Ÿå®‰å…¨é€åˆ°ç›®çš„åœ°ï¼Œä¹Ÿä¸èƒ½ç¡®å®šä»€ä¹ˆæ—¶å€™å¯ä»¥æŠµè¾¾ã€‚

 DatagramPacket å¯¹è±¡å°è£…äº†UDPæ•°æ®æŠ¥ï¼Œåœ¨æ•°æ®æŠ¥ä¸­åŒ…å«äº†å‘é€ç«¯çš„IPåœ°å€å’Œç«¯å£å·ä»¥åŠæ¥æ”¶ç«¯çš„IPåœ°å€å’Œç«¯å£å·ã€‚

 UDPåè®®ä¸­æ¯ä¸ªæ•°æ®æŠ¥éƒ½ç»™å‡ºäº†å®Œæ•´çš„åœ°å€ä¿¡æ¯ï¼Œå› æ­¤æ— é¡»å»ºç«‹å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„è¿æ¥ã€‚å¦‚åŒå‘å¿«é€’åŒ…è£¹ä¸€æ ·ã€‚

### 7.2 å¼€å‘æ­¥éª¤

**å‘é€ç«¯ç¨‹åºåŒ…å«ä»¥ä¸‹å››ä¸ªåŸºæœ¬çš„æ­¥éª¤ï¼š**

* åˆ›å»ºDatagramSocket ï¼šé»˜è®¤ä½¿ç”¨ç³»ç»Ÿéšæœºåˆ†é…ç«¯å£å·ã€‚
* åˆ›å»ºDatagramPacketï¼šå°†è¦å‘é€çš„æ•°æ®ç”¨å­—èŠ‚æ•°ç»„è¡¨ç¤ºï¼Œå¹¶æŒ‡å®šè¦å‘é€çš„æ•°æ®é•¿åº¦ï¼Œæ¥æ”¶æ–¹çš„IPåœ°å€å’Œç«¯å£å·ã€‚
* è°ƒç”¨  è¯¥DatagramSocket ç±»å¯¹è±¡çš„ sendæ–¹æ³• ï¼šå‘é€æ•°æ®æŠ¥DatagramPacketå¯¹è±¡ã€‚
* å…³é—­DatagramSocket å¯¹è±¡ï¼šå‘é€ç«¯ç¨‹åºç»“æŸï¼Œå…³é—­é€šä¿¡å¥—æ¥å­—ã€‚

**æ¥æ”¶ç«¯ç¨‹åºåŒ…å«ä»¥ä¸‹å››ä¸ªåŸºæœ¬çš„æ­¥éª¤ ï¼š**

* åˆ›å»ºDatagramSocket ï¼šæŒ‡å®šç›‘å¬çš„ç«¯å£å·ã€‚
* åˆ›å»ºDatagramPacketï¼šæŒ‡å®šæ¥æ”¶æ•°æ®ç”¨çš„å­—èŠ‚æ•°ç»„ï¼Œèµ·åˆ°ä¸´æ—¶æ•°æ®ç¼“å†²åŒºçš„æ•ˆæœï¼Œå¹¶æŒ‡å®šæœ€å¤§å¯ä»¥æ¥æ”¶çš„æ•°æ®é•¿åº¦ã€‚
* è°ƒç”¨  è¯¥DatagramSocket ç±»å¯¹è±¡çš„receiveæ–¹æ³• ï¼šæ¥æ”¶æ•°æ®æŠ¥DatagramPacketå¯¹è±¡ã€‚ã€‚
* å…³é—­DatagramSocket ï¼šæ¥æ”¶ç«¯ç¨‹åºç»“æŸï¼Œå…³é—­é€šä¿¡å¥—æ¥å­—ã€‚

### 7.3 æ¼”ç¤ºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯

åŸºäºUDPåè®®çš„ç½‘ç»œç¼–ç¨‹ä»ç„¶éœ€è¦åœ¨é€šä¿¡å®ä¾‹çš„ä¸¤ç«¯å„å»ºç«‹ä¸€ä¸ªSocketï¼Œä½†è¿™ä¸¤ä¸ªSocketä¹‹é—´å¹¶æ²¡æœ‰è™šæ‹Ÿé“¾è·¯ï¼Œè¿™ä¸¤ä¸ªSocketåªæ˜¯å‘é€ã€æ¥æ”¶æ•°æ®æŠ¥çš„å¯¹è±¡ï¼ŒJavaæä¾›äº†DatagramSocketå¯¹è±¡ä½œä¸ºåŸºäºUDPåè®®çš„Socketï¼Œä½¿ç”¨DatagramPacketä»£è¡¨DatagramSocketå‘é€ã€æ¥æ”¶çš„æ•°æ®æŠ¥ã€‚

#### 7.3.1 ä¸¾ä¾‹1ï¼š

å‘é€ç«¯ï¼š

```java
DatagramSocket ds = null;
try {
    ds = new DatagramSocket();
    byte[] by = "hello,atguigu.com".getBytes();
    DatagramPacket dp = new DatagramPacket(by, 0, by.length,     InetAddress.getByName("127.0.0.1"), 10000);
    ds.send(dp);
} catch (Exception e) {
    e.printStackTrace();
} finally {
    if (ds != null)
        ds.close();
}

```

æ¥æ”¶ç«¯ï¼š

```java
DatagramSocket ds = null;
try {
    ds = new DatagramSocket(10000);
    byte[] by = new byte[1024*64];
    DatagramPacket dp = new DatagramPacket(by, by.length);
    ds.receive(dp);
    String str = new String(dp.getData(), 0, dp.getLength());
    System.out.println(str + "--" + dp.getAddress());
} catch (Exception e) {
    e.printStackTrace();
} finally {
    if (ds != null)
        ds.close();
}

```

#### 7.3.2 ä¸¾ä¾‹2ï¼š

**å‘é€ç«¯ï¼š**

```java
package com.atguigu.udp;

import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.util.ArrayList;

public class Send {

    public static void main(String[] args)throws Exception {
//		1ã€å»ºç«‹å‘é€ç«¯çš„DatagramSocket
        DatagramSocket ds = new DatagramSocket();

        //è¦å‘é€çš„æ•°æ®
        ArrayList<String> all = new ArrayList<String>();
        all.add("å°šç¡…è°·è®©å¤©ä¸‹æ²¡æœ‰éš¾å­¦çš„æŠ€æœ¯ï¼");
        all.add("å­¦é«˜ç«¯å‰æ²¿çš„ITæŠ€æœ¯æ¥å°šç¡…è°·ï¼");
        all.add("å°šç¡…è°·è®©ä½ çš„æ¢¦æƒ³å˜å¾—æ›´å…·ä½“ï¼");
        all.add("å°šç¡…è°·è®©ä½ çš„åŠªåŠ›æ›´æœ‰ä»·å€¼ï¼");

        //æ¥æ”¶æ–¹çš„IPåœ°å€
        InetAddress ip = InetAddress.getByName("127.0.0.1");
        //æ¥æ”¶æ–¹çš„ç›‘å¬ç«¯å£å·
        int port = 9999;
        //å‘é€å¤šä¸ªæ•°æ®æŠ¥
        for (int i = 0; i < all.size(); i++) {
//			2ã€å»ºç«‹æ•°æ®åŒ…DatagramPacket
            byte[] data = all.get(i).getBytes();
            DatagramPacket dp = new DatagramPacket(data, 0, data.length, ip, port);
//			3ã€è°ƒç”¨Socketçš„å‘é€æ–¹æ³•
            ds.send(dp);
        }

//		4ã€å…³é—­Socket
        ds.close();
    }
}
```

**æ¥æ”¶ç«¯ï¼š**

```java
package com.atguigu.udp;

import java.net.DatagramPacket;
import java.net.DatagramSocket;

public class Receive {

    public static void main(String[] args) throws Exception {
//		1ã€å»ºç«‹æ¥æ”¶ç«¯çš„DatagramSocketï¼Œéœ€è¦æŒ‡å®šæœ¬ç«¯çš„ç›‘å¬ç«¯å£å·
        DatagramSocket ds = new DatagramSocket(9999);

        //ä¸€ç›´ç›‘å¬æ•°æ®
        while(true){
            //2ã€å»ºç«‹æ•°æ®åŒ…DatagramPacket
            byte[] buffer = new byte[1024*64];
            DatagramPacket dp = new DatagramPacket(buffer,buffer.length);

            //3ã€è°ƒç”¨Socketçš„æ¥æ”¶æ–¹æ³•
            ds.receive(dp);

            //4ã€æ‹†å°æ•°æ®
            String str = new String(dp.getData(),0,dp.getLength());
            System.out.println(str);
        }

//        ds.close();
    }
}
```

## 8 URLç¼–ç¨‹

### 8.1 URLç±»

- URL(Uniform Resource Locator)ï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œå®ƒè¡¨ç¤º Internet ä¸ŠæŸä¸€èµ„æºçš„åœ°å€ã€‚

- é€šè¿‡ URL æˆ‘ä»¬å¯ä»¥è®¿é—® Internet ä¸Šçš„å„ç§ç½‘ç»œèµ„æºï¼Œæ¯”å¦‚æœ€å¸¸è§çš„ wwwï¼Œftp ç«™ç‚¹ã€‚æµè§ˆå™¨é€šè¿‡è§£æç»™å®šçš„ URL å¯ä»¥åœ¨ç½‘ç»œä¸ŠæŸ¥æ‰¾ç›¸åº”çš„æ–‡ä»¶æˆ–å…¶ä»–èµ„æºã€‚ 

- URLçš„åŸºæœ¬ç»“æ„ç”±5éƒ¨åˆ†ç»„æˆï¼š

```http
<ä¼ è¾“åè®®>://<ä¸»æœºå>:<ç«¯å£å·>/<æ–‡ä»¶å>#ç‰‡æ®µå?å‚æ•°åˆ—è¡¨
```

- ä¾‹å¦‚: http://192.168.1.100:8080/helloworld/index.jsp#a?username=shkstart&password=123
  - ç‰‡æ®µåï¼šå³é”šç‚¹ï¼Œä¾‹å¦‚çœ‹å°è¯´ï¼Œç›´æ¥å®šä½åˆ°ç« èŠ‚
  - å‚æ•°åˆ—è¡¨æ ¼å¼ï¼šå‚æ•°å=å‚æ•°å€¼&å‚æ•°å=å‚æ•°å€¼....

- ä¸ºäº†è¡¨ç¤ºURLï¼Œjava.net ä¸­å®ç°äº†ç±» URLã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ„é€ å™¨æ¥åˆå§‹åŒ–ä¸€ä¸ª URL å¯¹è±¡ï¼š

  - public URL (String spec)ï¼šé€šè¿‡ä¸€ä¸ªè¡¨ç¤ºURLåœ°å€çš„å­—ç¬¦ä¸²å¯ä»¥æ„é€ ä¸€ä¸ªURLå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š

    ```http
    URL url = new URL("http://www. atguigu.com/"); 
    ```

  - public URL(URL context, String spec)ï¼šé€šè¿‡åŸº URL å’Œç›¸å¯¹ URL æ„é€ ä¸€ä¸ª URL å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š

    ```http
    URL downloadUrl = new URL(url, â€œdownload.html")
    ```

    public URL(String protocol, String host, String file); ä¾‹å¦‚ï¼š

    ```http
    URL url = new URL("http", "www.atguigu.com", â€œdownload. html");
    ```

  - public URL(String protocol, String host, int port, String file); ä¾‹å¦‚: 

    ```java
    URL gamelan = new URL("http", "www.atguigu.com", 80, â€œdownload.html");
    ```

- URLç±»çš„æ„é€ å™¨éƒ½å£°æ˜æŠ›å‡ºéè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¿…é¡»è¦å¯¹è¿™ä¸€å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œé€šå¸¸æ˜¯ç”¨ try-catch è¯­å¥è¿›è¡Œæ•è·ã€‚

![image-20220415013546074](images/image-20220415013546074.png)

### 8.2 URLç±»å¸¸ç”¨æ–¹æ³•

ä¸€ä¸ªURLå¯¹è±¡ç”Ÿæˆåï¼Œå…¶å±æ€§æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„ï¼Œä½†å¯ä»¥é€šè¿‡å®ƒç»™å®šçš„æ–¹æ³•æ¥è·å–è¿™äº›å±æ€§ï¼š

- public String getProtocol( )   è·å–è¯¥URLçš„åè®®å

- public String getHost( )      è·å–è¯¥URLçš„ä¸»æœºå

- public String getPort( )      è·å–è¯¥URLçš„ç«¯å£å·

- public String getPath( )      è·å–è¯¥URLçš„æ–‡ä»¶è·¯å¾„

- public String getFile( )       è·å–è¯¥URLçš„æ–‡ä»¶å

- public String getQuery(  )    è·å–è¯¥URLçš„æŸ¥è¯¢å

```java
URL url = new URL("http://localhost:8080/examples/myTest.txt");
System.out.println("getProtocol() :"+url.getProtocol());
System.out.println("getHost() :"+url.getHost());
System.out.println("getPort() :"+url.getPort());
System.out.println("getPath() :"+url.getPath());
System.out.println("getFile() :"+url.getFile());
System.out.println("getQuery() :"+url.getQuery());
```

### 8.3 6.3 é’ˆå¯¹HTTPåè®®çš„URLConnectionç±»

- URLçš„æ–¹æ³• openStream()ï¼šèƒ½ä»ç½‘ç»œä¸Šè¯»å–æ•°æ®
- è‹¥å¸Œæœ›è¾“å‡ºæ•°æ®ï¼Œä¾‹å¦‚å‘æœåŠ¡å™¨ç«¯çš„ CGI ï¼ˆå…¬å…±ç½‘å…³æ¥å£-Common Gateway Interface-çš„ç®€ç§°ï¼Œæ˜¯ç”¨æˆ·æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç«¯çš„åº”ç”¨ç¨‹åºè¿›è¡Œè¿æ¥çš„æ¥å£ï¼‰ç¨‹åºå‘é€ä¸€äº›æ•°æ®ï¼Œåˆ™å¿…é¡»å…ˆä¸URLå»ºç«‹è¿æ¥ï¼Œç„¶åæ‰èƒ½å¯¹å…¶è¿›è¡Œè¯»å†™ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ URLConnection ã€‚
- URLConnectionï¼šè¡¨ç¤ºåˆ°URLæ‰€å¼•ç”¨çš„è¿œç¨‹å¯¹è±¡çš„è¿æ¥ã€‚å½“ä¸ä¸€ä¸ªURLå»ºç«‹è¿æ¥æ—¶ï¼Œé¦–å…ˆè¦åœ¨ä¸€ä¸ª URL å¯¹è±¡ä¸Šé€šè¿‡æ–¹æ³• openConnection() ç”Ÿæˆå¯¹åº”çš„ URLConnection å¯¹è±¡ã€‚å¦‚æœè¿æ¥è¿‡ç¨‹å¤±è´¥ï¼Œå°†äº§ç”ŸIOException. 
  - URL netchinaren = new URL ("http://www.atguigu.com/index.shtml"); 
  - URLConnectonn u = netchinaren.openConnection( ); 

- é€šè¿‡URLConnectionå¯¹è±¡è·å–çš„è¾“å…¥æµå’Œè¾“å‡ºæµï¼Œå³å¯ä»¥ä¸ç°æœ‰çš„CGIç¨‹åºè¿›è¡Œäº¤äº’ã€‚
  - public Object getContent( ) throws IOException

  - public int getContentLength( )
  - public String getContentType( )
  - public long getDate( )
  - public long getLastModified( )
  - **public InputStream getInputStream ( ) throws IOException**
  - public OutputSteram getOutputStream( )throws IOException

### 8.4 å°ç»“

- ä½äºç½‘ç»œä¸­çš„è®¡ç®—æœºå…·æœ‰å”¯ä¸€çš„IPåœ°å€ï¼Œè¿™æ ·ä¸åŒçš„ä¸»æœºå¯ä»¥äº’ç›¸åŒºåˆ†ã€‚

- å®¢æˆ·ç«¯ï¼æœåŠ¡å™¨æ˜¯ä¸€ç§æœ€å¸¸è§çš„ç½‘ç»œåº”ç”¨ç¨‹åºæ¨¡å‹ã€‚æœåŠ¡å™¨æ˜¯ä¸€ä¸ªä¸ºå…¶å®¢æˆ·ç«¯æä¾›æŸç§ç‰¹å®šæœåŠ¡çš„ç¡¬ä»¶æˆ–è½¯ä»¶ã€‚å®¢æˆ·æœºæ˜¯ä¸€ä¸ªç”¨æˆ·åº”ç”¨ç¨‹åºï¼Œç”¨äºè®¿é—®æŸå°æœåŠ¡å™¨æä¾›çš„æœåŠ¡ã€‚ç«¯å£å·æ˜¯å¯¹ä¸€ä¸ªæœåŠ¡çš„è®¿é—®åœºæ‰€ï¼Œå®ƒç”¨äºåŒºåˆ†åŒä¸€ç‰©ç†è®¡ç®—æœºä¸Šçš„å¤šä¸ªæœåŠ¡ã€‚å¥—æ¥å­—ç”¨äºè¿æ¥å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ¯ä¸ªé€šä¿¡ä¼šè¯ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„å¥—æ¥å­—ã€‚TCPåè®®ç”¨äºå®ç°é¢å‘è¿æ¥çš„ä¼šè¯ã€‚

- Java ä¸­æœ‰å…³ç½‘ç»œæ–¹é¢çš„åŠŸèƒ½éƒ½å®šä¹‰åœ¨ java.net ç¨‹åºåŒ…ä¸­ã€‚Java ç”¨ InetAddress å¯¹è±¡è¡¨ç¤º IP åœ°å€ï¼Œè¯¥å¯¹è±¡é‡Œæœ‰ä¸¤ä¸ªå­—æ®µï¼šä¸»æœºå(String) å’Œ IP åœ°å€(int)ã€‚

- ç±» Socket å’Œ ServerSocket å®ç°äº†åŸºäºTCPåè®®çš„å®¢æˆ·ç«¯ï¼æœåŠ¡å™¨ç¨‹åºã€‚Socketæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¸€ä¸ªè¿æ¥ï¼Œè¿æ¥åˆ›å»ºçš„ç»†èŠ‚è¢«éšè—äº†ã€‚è¿™ä¸ªè¿æ¥æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„æ•°æ®ä¼ è¾“é€šé“ï¼Œè¿™æ˜¯å› ä¸º TCP åè®®å¯ä»¥è§£å†³æ•°æ®åœ¨ä¼ é€è¿‡ç¨‹ä¸­çš„ä¸¢å¤±ã€æŸåã€é‡å¤ã€ä¹±åºä»¥åŠç½‘ç»œæ‹¥æŒ¤ç­‰é—®é¢˜ï¼Œå®ƒä¿è¯æ•°æ®å¯é çš„ä¼ é€ã€‚

- ç±» URL å’Œ URLConnection æä¾›äº†æœ€é«˜çº§ç½‘ç»œåº”ç”¨ã€‚URL çš„ç½‘ç»œèµ„æºçš„ä½ç½®æ¥åŒä¸€è¡¨ç¤º Internet ä¸Šå„ç§ç½‘ç»œèµ„æºã€‚é€šè¿‡URLå¯¹è±¡å¯ä»¥åˆ›å»ºå½“å‰åº”ç”¨ç¨‹åºå’Œ URL è¡¨ç¤ºçš„ç½‘ç»œèµ„æºä¹‹é—´çš„è¿æ¥ï¼Œè¿™æ ·å½“å‰ç¨‹åºå°±å¯ä»¥è¯»å–ç½‘ç»œèµ„æºæ•°æ®ï¼Œæˆ–è€…æŠŠè‡ªå·±çš„æ•°æ®ä¼ é€åˆ°ç½‘ç»œä¸Šå»ã€‚