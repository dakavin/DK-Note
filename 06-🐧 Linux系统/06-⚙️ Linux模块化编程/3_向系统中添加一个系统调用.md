# 内核添加自定义服务

```C++
#include <linux/kernel.h>
#include <linux/syscalls.h>
SYSCALL_DEFINE0(helloworld){
    printk("This is helloworld syscall\n");
return 0;
}
```

# 添加系统调用号

在 Linux 源码 kernel/include/uapi/asm-generic/unistd.h 文件中添加系统调用号。

![](https://ncn13z89mqjm.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDJlMDY1OTQzNjRmNTU1ZmU3ZWYyOTNhMWU0MDI4MGZfOWpJWXRkRTF6NHJmUElYNEI1YWFMYXVFTGVFWVhpWFpfVG9rZW46WWxXUGI0NUY1bzViUTF4WHdrQmNFNzF4bkRjXzE3NDk3MTczOTQ6MTc0OTcyMDk5NF9WNA)

# 系统调用测试

```C++
#include <stdio.h>
#include <sys/syscall.h>
#include <fcntl.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <stdlib.h>

#define __NR_helloworld 435

int main(int argc,char **argv){
  
  syscall(__NR_helloworld);
  return 0;

}
```

aarch64-linux-gnu-gcc syscall.c -o syscall