---
文章标题: "[[1_Linux内核源码初识]]"
文章作者: Dakkk
文章概要: |
  介绍Linux内核源码基础知识，包括获取方式、目录结构详解和编译实战操作，为后续驱动开发学习打基础。
tags:
  - Linux内核
  - 内核源码
  - 目录结构
  - 内核编译
  - 驱动开发
  - 操作系统
  - 嵌入式开发
  - 系统编程
相关文章:
  - "[[1_驱动关键技术]]"
  - "[[../08-🏗️ Linux设备模型与设备树(重点)/3_设备树基础/03_图解Kernel Device Tree(设备树)的使用]]"
  - "[[../08-🏗️ Linux设备模型与设备树(重点)/3_设备树基础/05_设备树中时钟描述 (被使用)]]"
  - "[[../08-🏗️ Linux设备模型与设备树(重点)/3_设备树基础/06_📕设备树中断的属性描述 (最常用)]]"
  - "[[09_修改启动logo（Skip）]]"
文章分类: 🐧 Linux系统
文章路径: 06-🐧 Linux系统/06-⚙️ Linux模块化编程/1_Linux内核源码初识.md
文章难度: 初级 💧
目前阶段: ✅ 已完成
重要性: ⭐⭐⭐⭐ 核心能力
创建时间: 2025-06-12 16:33:22
修改时间: 2025-06-12 17:29:56
---

欢迎各位小伙伴踏入Linux驱动开发的世界！今天我们要做的事情很重要，就是认识Linux内核源码，这是我们后续学习驱动开发的基础。简单来说，**内核源码**就是操作系统最核心部分的程序代码，它控制着计算机的硬件资源。

## 1 初识内核源码

### 1.1 什么是Linux内核源码

Linux内核源码的官方网站为 https://www.kernel.org/
这里可以下载到最新的Linux内核源码。进入该网站之后如下图所示：

![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/06/02db3764f32ab4c1751171e4acae83c0.png)

> [!info]+ 重要信息 
> 上图展示了Linux内核官方网站的主页，可以看到不同版本的内核下载链接和相关信息
> - **主线版本（mainline）**：最新的开发版本，包含最新功能但可能不够稳定
> - **稳定版本（stable）**：经过测试的稳定版本，适合一般使用
> - **长期支持版本（longterm）**：会长期维护和更新的版本，适合企业使用

> [!note]+ 重要笔记 
> 这些版本都是由Linus Torvalds（Linux之父）领导的团队维护的。

### 1.2 为什么不直接用官方源码

**虽然官方网站有源码，但我们在实际开发中通常不会直接使用它。原因是什么呢？**

半导体厂商（比如高通、联发科等）和一些内核爱好者会从官网下载相应版本的内核源码，然后对这些源码进行**打补丁**等操作

简单来说，就是在原始代码基础上添加一些特殊的代码，让官网的内核源码可以在他们设计的主控（CPU）上正常运行

> [!tip]+ 重要提示 
> 在开发和学习过程中，我们通常使用半导体厂家提供的源码包，而不是直接从Linux官网下载。

不过，不论是Linux官网的内核源码还是半导体厂家提供的内核源码，它们的基本结构都是相似的，这不影响我们来看它的庐山真面目！

## 2 内核源码目录结构详解

了解了内核源码的来源，接下来我们看看内核源码的组织结构。内核源码就像一个巨大的图书馆，每个目录都有特定的作用。

### 2.1 主要目录结构

|目录名|主要作用|通俗解释|
|---|---|---|
|**arch**|存放不同平台体系相关代码|不同CPU架构（如ARM、x86）的专用代码|
|**block**|存放块设备相关代码|硬盘、U盘等存储设备的控制代码|
|**crypto**|存放加密、压缩、CRC校验等算法相关代码|数据安全和完整性检查的算法|
|**Documentation**|存放相关说明文档|各种使用说明和开发指南|
|**drivers**|存放Linux内核设备驱动程序源码|所有硬件设备的驱动程序|
|**firmware**|存放处理器相关的一些特殊固件|CPU等硬件的底层控制程序|
|**fs**|存放虚拟文件系统代码|文件和目录管理相关代码|
|**include**|存放内核所需、与平台无关的头文件|各种函数和变量的声明文件|
|**init**|Linux系统启动初始化相关的代码|系统开机时最先运行的代码|
|**ipc**|存放进程间通信代码|不同程序之间交流的方式|
|**kernel**|Linux内核的核心代码|进程调度等最核心的功能|
|**lib**|库文件代码|内核中需要用到的各种工具函数|
|**mm**|存放内存管理代码|内存分配和回收的管理代码|
|**net**|存放网络相关代码|网络通信相关的所有代码|
|**samples**|存放提供的一些内核编程范例|学习用的示例代码|
|**scripts**|存放一些脚本文件|编译和构建用的脚本工具|
|**security**|存放系统安全性相关代码|系统安全防护相关代码|
|**sound**|存放声音、声卡相关驱动|音频设备的驱动程序|
|**tools**|一些常用工具|性能分析、测试等辅助工具|
|**usr**|用于生成initramfs的代码|系统启动时的临时文件系统|
|**virt**|提供虚拟机技术支持|KVM等虚拟化技术的支持代码|

> [!example]+ 示例 
> - 你想开发一个USB设备的驱动，你主要会在drivers/usb目录下工作；
> - 你要处理网络相关的问题，就要关注net目录。

### 2.2 重点关注的目录

对于驱动开发者来说，最需要关注的是以下几个目录：
1. **drivers目录**：这里按设备类别分类，包含char（字符设备）、block（块设备）、input（输入设备）、i2c、spi、pci、usb等子目录
2. **include目录**：包含了我们开发驱动时需要用到的各种头文件
3. **Documentation目录**：有很多实用的文档，包括驱动编写指南

> [!warning]+ 警告或注意 
> 内核源码目录结构庞大，初学者容易迷失方向。建议先熟悉上述重点目录，再逐步扩展。

## 3 内核源码编译实战

了解了内核源码的结构，接下来我们来实际操作一下。编译内核源码是学习内核开发的第一步，就像盖房子要先打地基一样。

### 3.1 编译前的准备

在开始编译之前，我们需要先解压源码包。假设你已经获得了一个名为`linux_sdk.tar.gz`的源码包。

### 3.2 具体操作步骤

1. **第一步：解压源码包**
- 首先使用以下命令对内核源码进行解压：
```bash
tar -vxf linux_sdk.tar.gz  
```

> [!tip]+ 重要提示 
> 这个命令中，`-v`表示显示解压过程，`-x`表示解压，`-f`指定文件名。解压完成后会生成一个新的目录。

2. **第二步：进入源码目录**
- 解压完成后，使用以下命令进入内核源码目录：
```bash
cd linux_sdk
```

3. **第三步：编译内核**
- 最后，使用以下命令进行内核源码的编译：
```bash
./build.sh kernel
```

> [!info]+ 重要信息 
> 这个脚本会自动处理编译过程中的各种配置和依赖关系，比手动编译要简单很多。

> [!warning]+ 警告或注意 
> 内核编译是一个耗时的过程，可能需要几十分钟到几个小时，具体时间取决于你的计算机性能。编译过程中请保持电源稳定，避免中断。

### 3.3 编译成功的标志

编译成功后，你会在相应目录下看到生成的内核映像文件，这就是我们最终要在目标设备上运行的内核。

> [!success]+ 成功或完成 完成这三个步骤后，你就成功编译了第一个Linux内核！这是驱动开发路上的重要里程碑。

## 4 总结

通过今天的学习，我们了解了Linux内核源码的基本概念、获取方式、目录结构以及编译方法。这些知识为我们后续的驱动开发打下了坚实的基础。

> [!abstract]+ 摘要或总结
> 
> **关键要点回顾：**
> 
> - Linux内核源码可以从官网获取，但实际开发中多使用厂商提供的版本
> - 内核源码按功能模块组织，drivers目录是驱动开发的重点
> - 编译内核是学习内核开发的第一步，需要按步骤操作
> - 理解内核结构有助于后续的驱动开发工作

下一步，我们将深入学习具体的驱动开发技术。准备好了吗？让我们继续这段精彩的内核探索之旅！