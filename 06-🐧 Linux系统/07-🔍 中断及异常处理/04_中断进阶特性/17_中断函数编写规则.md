## 1 无传参

- **原因**：中断函数是由硬件或内核调用的，其调用不允许传递用户自定义参数。
    
- **解决方案**：
    
    - 使用全局变量或者寄存器与中断函数通信。
        
    - 避免对复杂数据结构的直接操作，可用简单标志变量记录状态。
        

---

## 2 无返回值

- **原因**：中断函数无法被调用者处理返回值。
    
- **解决方案**：
    
    - 如果需要与其他逻辑交互，可以设置标志变量供主程序轮询或其他任务响应。
        

---

## 3 短小精悍

- **原因**：
    
    - 中断处理通常会屏蔽其他中断，如果耗时过长，可能影响系统的实时性。
        
    - 短小的中断函数有助于提高系统响应能力。
        
- **解决方案**：
    
    - **尽量减少代码逻辑**：将复杂的操作放到主程序中，中断中仅记录事件或更新状态。
        
    - **避免使用延时函数**：中断中不能有长时间的延时调用。
        
    - **避免耗时操作**：如复杂运算、文件操作等。
        
    - **尽量避免嵌套中断**：除非必须，避免在中断中开启其他中断。
        

---

## 4 保持一致性和安全性

- **上下文保存与恢复**：
    
    - 中断函数可能破坏当前运行任务的上下文，因此需要确保保存现场（一般由编译器或硬件处理）。
        
- **数据同步**：
    
    - 中断中修改的全局变量，可能与主程序竞争资源，需要用同步机制保护（如 `volatile` 关键字或禁用中断临界区）。
        
    - 如果中断中使用了锁，务必确保锁操作简单快速，避免死锁。
        

---

## 5 避免复杂调用

- **原因**：复杂调用可能引入不可预测的问题。
    
- **解决方案**：
    
    - 避免调用不确定的外部函数。
        
    - 减少栈的使用，避免中断嵌套导致栈溢出。
        

---