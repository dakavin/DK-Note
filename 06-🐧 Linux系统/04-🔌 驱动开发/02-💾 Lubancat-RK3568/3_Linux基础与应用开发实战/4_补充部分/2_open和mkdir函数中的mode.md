
在 Linux 系统编程中，`open` 和 `mkdir` 是常用的文件操作函数，而它们的 `mode` 参数用于指定文件或目录的权限。
## 1 `open` 函数

`open` 函数用于打开一个文件。如果文件不存在并且模式指定了创建文件，`open` 还会创建该文件。其函数原型如下：
```c
int open(const char *pathname, int flags, mode_t mode);
```

- **`pathname`**：要打开的文件路径。
- **`flags`**：文件打开的方式（例如 `O_RDONLY`, `O_WRONLY`, `O_RDWR`）。
- **`mode`**：文件的权限掩码，指定新文件的权限，通常是一个数字。

`mode` 参数仅在创建新文件时有效，并且是一个三位八进制数，表示文件的权限位。这个参数以八进制数表示文件权限，具体的权限如下：
- **用户权限** (`u`): 文件所有者的权限。
- **组权限** (`g`): 与文件所有者同一组的用户权限。
- **其他用户权限** (`o`): 其他用户的权限。

权限的常用值：
- `r` (read): 读权限，值为 4。
- `w` (write): 写权限，值为 2。
- `x` (execute): 执行权限，值为 1。

例如，`0666` 表示所有者、组用户和其他用户都有读写权限，而 `0777` 表示所有用户都可以读、写、执行。

**示例**：
```c
int fd = open("file.txt", O_CREAT | O_WRONLY, 0666);
```

这行代码打开 `file.txt`，如果文件不存在则创建它，并赋予文件所有者、组和其他用户读写权限。

## 2 `mkdir` 函数

`mkdir` 函数用于创建一个新目录，其函数原型如下：
```c
int mkdir(const char *pathname, mode_t mode);
```

- **`pathname`**：要创建的目录路径。
- **`mode`**：目录的权限设置，同样是一个三位八进制数，表示目录的访问权限。

与 `open` 函数的 `mode` 参数类似，`mkdir` 的 `mode` 也是一个八进制的权限掩码，指定新目录的权限。常用权限与 `open` 中的相同，通常使用 `0777` 来给目录赋予完全的权限。

例如，`0777` 表示所有者、组用户和其他用户都具有读、写和执行的权限。

**示例**：
```c
int ret = mkdir("mydir", 0755);
```

这行代码会创建一个名为 `mydir` 的目录，并赋予所有者读写执行权限，组和其他用户只具有读和执行权限。

## 3 权限模式总结
- **`r` (read)**：读权限，值为 4。
- **`w` (write)**：写权限，值为 2。
- **`x` (execute)**：执行权限，值为 1。

八进制表示：
- **`0777`**：所有用户都可以读、写、执行。
- **`0755`**：所有者可以读、写、执行，组和其他用户可以读和执行。
- **`0644`**：所有者可以读写，组和其他用户只能读取。

通过 `mode` 参数，我们可以灵活地控制文件或目录的访问权限。