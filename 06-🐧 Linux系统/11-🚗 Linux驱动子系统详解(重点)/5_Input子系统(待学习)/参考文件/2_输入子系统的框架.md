![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/06/e4eeda7dba678d28d780cea618cd37fd.png)


Input 子系统可以分为事件处理层、设备驱动层、核心层三层，这三层在输入子系统中有着不同的作用和分工。

  

## 1 事件处理层

事件处理层是输入子系统的最上层，可以处理输入设备产生的事件并将其传递给上层应用程序，并在操作系统中创建设备节点，以便应用程序可以通过设备节点与输入设备进行通信。它接收来自核心层的输入事件，并根据事件的类型和属性进行相应的处理。

  

## 2 核心层

核心层的主要功能是作为匹配器位于事件处理层和设备驱动层之间。它起到协调和连接这两个层级的作用，以确保输入设备的事件能够正确地传递给相应的事件处理程序。

以下是核心层在输入子系统中的主要功能：

**（1）事件匹配：** 核心层负责将输入设备产生的原始输入数据与相应的事件处理程序进行匹配。它会解析原始输入数据，并根据预定义的规则和配置信息，确定应该将输入数据传递给哪个事件处理程序进行处理。

**（2）设备管理和控制**： 核心层负责维护输入设备的状态、属性和配置信息，并提供设备的注册、注销和管理功能。它与设备驱动层进行交互，接收来自设备驱动层的输入事件，并将其转化为抽象化的事件表示形式。核心层提供一致的接口，使得上层应用程序可以独立于具体的硬件设备进行操作。

**（3）事件处理和分发**： 核心层负责事件的处理和分发，将输入事件传递给对应的事件处理层。它通过事件队列的机制，接收和缓存来自设备驱动层的输入事件，并按照特定的规则将事件分发给对应的事件处理层或应用程序。这样，事件处理层可以通过核心层提供的接口，获取输入事件并进行相应的处理。

**（4）抽象化接口和事件处理机制**： 核心层为上层应用程序和事件处理层提供了一组抽象化的接口和事件处理机制。它提供了统一的事件表示形式，使得不同类型的输入设备（如键盘、鼠标、触摸屏等）的事件可以被表示和处理。通过核心层的接口，事件处理层可以注册事件监听器、订阅特定类型的事件，并获取输入设备的状态信息。

  

## 3 设备驱动层

设备驱动层是输入子系统的最底层，负责与硬件设备进行通信和交互。它的主要职责是将硬件设备的操作和功能抽象为统一的接口，以便核心层和事件处理层可以与之交互。设备驱动层的代码通常包括硬件的初始化、中断处理、数据传输等操作，以确保输入设备的正常工作。开发者在这一层编写驱动程序，以适配特定的硬件设备。

Linux 源码中已经写好了核心层相关的代码，所以在后续编写输入子系统驱动的时候，核心层的代码是不需要编写的，而事件处理层在 Linux 中也为我们提供了一个模板，除了一些例如固定设备节点的需求外，一般不需要编写事件处理层的代码，而设备驱动层由于要面对不同的硬件，每个硬件的初始化方式又都都不同，所以设备驱动层的代码在编写输入子系统驱动的时候是需要填充的。