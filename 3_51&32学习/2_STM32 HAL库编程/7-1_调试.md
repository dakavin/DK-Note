
## 1 Debug调试

我们常用的开发调试方法是在代码中添加日志，在绝大多数情况下，这都是一种不错的调试定位问题方法。

但遇到一些特殊问题
- 数组访问越界导致程序挂掉，我们希望看到在哪里挂掉，这时候我们需要Debug看堆栈信息
- 查看某个变量或数组的变化，这时候我们可以Debug打断点暂停
- 加日志效率太低了，很多变量加不过来，我们也可以Debug模式实时把需要观察的变量添加到观察串口中

**Keil MDK中的Debug设置如下：**

![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/fd849d13b7629520b72dd1883747109d.png)

## 2 调试方式

**方式一：软件模拟调试**
**方式二：硬件调试**

一般不建议使用软件模拟调试，有误差，比较理想化，实际硬件产生的干扰软件是模拟不到的，也就是说通过软件调试好的程序版本，在实际硬件中有可能根本跑不起来

硬件调试，是实时借助仿真器和芯片进行通讯，读取的都是芯片实际环境的数据，更精确可靠

## 3 硬件调试

把烧录仿真器与板卡连接到电脑，然后电机调试按钮进入仿真调试模式
![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/7d51b05f5dc58000de7af223517a3e77.png)

设置/清除断点
![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/addae54164a2ab5a6b54fae9cb6c4fb5.png)


常用的调试按键
![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/e0e36ae589e14fdfc79439f0825e5429.png)

上图的DEBUG工具条是比较常用的，作为一般的使用者来说，最常用的还是下面加黑的几个

**复位：**
- 等同于硬件上的复位按钮，相当于实现了一次硬复位，代码会从头开始执行

**执行到断点处：**
- 用来快速执行到断点处，有时候并不需要观察每步是如何执行的，而是想快速的执行到程序的某个地方看结果，这个按钮就可以实现这样的功能，前提是在查看的代码位置设置了断点

**停止运行/挂起**
- 该按钮在程序一直执行的时候回变为有效，通过该按钮，就可以使程序停止下来，进入到单步调试状态

**执行进去**
- 实现执行到某个函数里面的功能，在没有函数的情况下，等同于执行过去

**执行过去**
- 在碰到有函数的地方，通过该按钮就可以单步执行过这个函数，而不进入这个函数

**执行出去**
- 进入了函数单步调试的时候，可能不必再执行函数的剩余部分了，通过该按钮就直接一步执行完函数余下的部分，并跳出函数，回到函数被调用的位置

**汇编窗口**
- 通过该按钮，可以查看汇编代码，对分析程序很有用
  ![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/6bd113bc965d2f522eaaf42abe12712c.png)

**堆栈局部变量窗口**
- 显示变量的串口，可以查看各种需要看到的变量值，也是很常用的一个调试窗口
  ![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/ac422e4e40496fd800c5d68096aeacb7.png)
**watch窗口**
- 可以用来查看全局变量
  ![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/6fea68e800aec7662f00c410ef393ee3.png)


**串口打印窗口**
- 类似串口调试助手界面，用来显示从串口打印出来的内容
- 在硬件调试时，无法使用，只能从硬件获取串口信息
  ![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/1933fd72207d99d534402e2da6b916b1.png)
**内存查看窗口**
- 一个内存查看窗口，可以输入要查看的内存地址，然后观察这一片内存的变化情况
  ![image.png|500](https://my-obsidian-image.oss-cn-guangzhou.aliyuncs.com/2025/03/0254658e7082cd55ebd24d7b389a53d2.png)
**性能分析窗口（没有标的那个）**
- 观察各个函数和所占百分百，用于分析函数的性能

**逻辑分析窗口**
- 通过SETUP按钮新建一些IO口，可以观察这些IO口的电平变化情况，以多种形式显示出来，比较直观